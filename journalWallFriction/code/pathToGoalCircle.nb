(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    163170,       3594]
NotebookOptionsPosition[    160395,       3517]
NotebookOutlinePosition[    160749,       3533]
CellTagsIndexPosition[    160706,       3530]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
The full algorithm to find a path to have the algorithm working.\
\>", "Subchapter",
 CellChangeTimes->{{3.717175080379896*^9, 3.717175102006517*^9}, {
  3.71775915172506*^9, 
  3.717759166688477*^9}},ExpressionUUID->"dee739e3-987b-4be3-8627-\
4e5e6776aa9c"],

Cell[CellGroupData[{

Cell["Testing RegionMember function on polygon", "Subsection",
 CellChangeTimes->{{3.7171751235970287`*^9, 
  3.717175151311227*^9}},ExpressionUUID->"4be34e6d-bad5-4da7-9c76-\
8b2549b18ab0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"f", "=", 
         RowBox[{"BSplineFunction", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0.5", ",", "0.05"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1.05", ",", "0.7"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.4", ",", "1.5"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1.15"}], ",", "0.85"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "0.75"}], ",", "0.02"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "0.93"}], ",", 
               RowBox[{"-", "1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.2", ",", 
               RowBox[{"-", "1.3"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1.05", ",", 
               RowBox[{"-", "0.83"}]}], "}"}]}], "}"}], ",", 
           RowBox[{"SplineClosed", "\[Rule]", "True"}]}], "]"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"reg2", "=", 
         RowBox[{"Polygon", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"f", "[", "t", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", ".99", ",", "0.01"}], "}"}]}], "]"}],
           "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rm", "=", 
         RowBox[{"RegionMember", "[", "reg2", "]"}]}], ";"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Graphics", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Point", "[", "p", "]"}], ",", 
            RowBox[{"EdgeForm", "[", 
             RowBox[{"{", 
              RowBox[{"Red", ",", "Thick"}], "}"}], "]"}], ",", "Yellow", ",",
             "reg2"}], "}"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
             RowBox[{"{", "2", "}"}]}], "]"}]}]}], 
         RowBox[{"(*", 
          RowBox[{",", 
           RowBox[{"Point", "[", 
            RowBox[{"RegionNearest", "[", 
             RowBox[{"reg", ",", "p"}], "]"}], "]"}], ",", "Blue"}], "*)"}], 
         "]"}], ",", 
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{"\"\<Region Member: \>\"", ",", 
           RowBox[{"rm", "[", "p", "]"}]}], "}"}], "]"}]}], "}"}], "]"}]}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p", ",", 
        RowBox[{"{", 
         RowBox[{"0.5", ",", "0.5"}], "}"}]}], "}"}], ",", "Locator"}], 
     "}"}]}], "]"}], "\[IndentingNewLine]", "\n"}]], "Input",
 CellChangeTimes->{{3.7171692398046703`*^9, 3.717169256354835*^9}, {
  3.717169510859474*^9, 3.717169512129628*^9}, {3.7172399344451723`*^9, 
  3.717239940891675*^9}},ExpressionUUID->"7a5b9100-e3c8-4bf7-ae61-\
202a04973f30"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`p$$ = {0.5, 0.5}, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`p$$], {0.5, 0.5}}, Automatic}}, Typeset`size$$ = {
    180., {96.134033203125, 101.865966796875}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`p$$ = {0.5, 0.5}}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> (
       With[{$CellContext`f = 
          BSplineFunction[{{0.5, 0.05}, {1.05, 0.7}, {0.4, 1.5}, {-1.15, 
             0.85}, {-0.75, 0.02}, {-0.93, -1}, {0.2, -1.3}, {1.05, -0.83}}, 
            SplineClosed -> True]}, $CellContext`reg2 = Polygon[
            Table[
             $CellContext`f[$CellContext`t], {$CellContext`t, 0, 0.99, 
              0.01}]]; $CellContext`rm = RegionMember[$CellContext`reg2]; 
         Null]; Column[{
          Graphics[{
            Point[$CellContext`p$$], 
            EdgeForm[{Red, Thick}], Yellow, $CellContext`reg2}, PlotRange -> 
           Table[{-2, 2}, {2}]], 
          Row[{"Region Member: ", 
            $CellContext`rm[$CellContext`p$$]}]}]), 
      "Specifications" :> {{{$CellContext`p$$, {0.5, 0.5}}, Automatic, 
         ControlType -> Locator}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{231., {130., 135.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.7171692425661182`*^9, 3.717169512747223*^9, 
  3.717239943762225*^9, 
  3.717240009282525*^9},ExpressionUUID->"303299ca-ccc0-4d41-8e3a-\
2e820a346061"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Testing Nearest Region function on polygon", "Subsection",
 CellChangeTimes->{{3.7171751235970287`*^9, 3.717175138894965*^9}, {
  3.717238693863608*^9, 
  3.7172386944815607`*^9}},ExpressionUUID->"3b539056-2e0c-4dd1-b581-\
db9b5f5d99c3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"p", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pn", "=", 
   RowBox[{"RegionNearest", "[", 
    RowBox[{"reg", ",", "p"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Graphics", "[", 
  RowBox[{"{", 
   RowBox[{"Blue", ",", "reg2", ",", "Red", ",", 
    RowBox[{"PointSize", "[", "Large", "]"}], ",", 
    RowBox[{"Point", "[", "p", "]"}], ",", "Green", ",", 
    RowBox[{"Point", "[", "pn", "]"}], ",", "Black", ",", 
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{"pn", ",", "p"}], "}"}], "]"}]}], "}"}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.717169273708571*^9, 3.7171693223946447`*^9}, {
   3.7171695361707363`*^9, 3.717169588990384*^9}, 
   3.717239930152081*^9},ExpressionUUID->"48f54bda-0d38-4162-a569-\
c91b58422939"],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0, 0, 1], PolygonBox[CompressedData["
1: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
83Hn
     "]]}, 
   {RGBColor[1, 0, 0], PointSize[Large], PointBox[{1, 2}], 
    {RGBColor[0, 1, 0], PointBox[{0.5305978698070911, 1.181201726707792}]}, 
    {GrayLevel[0], 
     LineBox[{{0.5305978698070911, 1.181201726707792}, {1, 2}}]}}}]], "Output",\

 CellChangeTimes->{{3.717169280237157*^9, 3.717169322770419*^9}, {
   3.717169579528656*^9, 3.717169585236918*^9}, 3.7171696279270067`*^9, 
   3.717239948297495*^9},ExpressionUUID->"d9257b84-d4fa-4407-9314-\
80ad5fdfe46b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plotting the actual region (parametric form!)", "Subsection",
 CellChangeTimes->{{3.7171751235970287`*^9, 3.71717517056019*^9}, {
  3.7172387206637077`*^9, 
  3.717238720992443*^9}},ExpressionUUID->"a70ef747-7f54-494f-88c4-\
3358c676f6a3"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"makeRegionList", "[", " ", 
     RowBox[{
     "\[Alpha]_", ",", " ", "\[Theta]_", ",", " ", "ps1_", ",", " ", "ps2_", 
      ",", " ", "c_", ",", " ", "accuracy_"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Psi]a", " ", ",", "pra", ",", "\[Gamma]a", ",", "cola", ",", " ", 
        "regionlist"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "\[Psi]a", " ", "is", "  ", "angle", " ", "to", " ", "the", " ", 
        "collision", " ", "point"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Psi]a", "=", 
        RowBox[{"\[Theta]", "+", 
         RowBox[{"\[Alpha]", "/", "2"}], "+", 
         RowBox[{"\[Pi]", "/", "2"}], "+", 
         RowBox[{"c", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Pi]", "-", "\[Alpha]"}], ")"}], "/", 
           "accuracy"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cola", " ", "=", " ", 
        RowBox[{
         RowBox[{"1", "/", "2"}], 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Psi]a", " ", "]"}], ",", 
           RowBox[{"Sin", "[", "\[Psi]a", " ", "]"}]}], "}"}]}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{"collision", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"pra", "=", " ", 
        RowBox[{"2", " ", 
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"ps1", ".", "cola"}], "-", 
           RowBox[{"ps2", ".", "cola"}]}], "]"}]}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{"perpendicular", " ", "distance"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]a", "=", " ", 
        RowBox[{"ArcCos", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"1", "/", "2"}], "-", "pra"}], 
          RowBox[{"1", "/", "2"}]], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "reachable", " ", "angle", " ", "for", " ", "other", " ", "robot", 
         " ", "after", " ", "first", " ", "robot", " ", "collides"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"regionlist", " ", "=", " ", 
        RowBox[{"Polygon", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"cola", "-", 
            RowBox[{
             RowBox[{"1", "/", "2"}], 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Cos", "[", "a", "]"}], ",", 
               RowBox[{"Sin", "[", "a", "]"}]}], "}"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", 
             RowBox[{"\[Psi]a", " ", "-", "\[Gamma]a"}], " ", ",", 
             RowBox[{"\[Psi]a", " ", "+", "\[Gamma]a"}], ",", 
             RowBox[{"\[Gamma]a", "/", "accuracy"}]}], "}"}]}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "regionlist", "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"findHitPoint", "[", 
     RowBox[{
     "\[Alpha]_", ",", " ", "\[Theta]_", ",", " ", "ps1_", ",", " ", "ps2_", 
      ",", " ", "accuracy_", ",", " ", "nearest_"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "regionlist", ",", " ", "hitIndex", ",", " ", "inReg", ",", "i"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"hitIndex", " ", "=", " ", 
        RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{"i", "\[LessEqual]", "  ", "accuracy"}], ",", " ", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"regionlist", " ", "=", " ", 
           RowBox[{"makeRegionList", "[", " ", 
            RowBox[{
            "\[Alpha]", ",", " ", "\[Theta]", ",", " ", "ps1", ",", " ", 
             "ps2", ",", " ", "i", ",", " ", "accuracy"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"inReg", " ", "=", 
           RowBox[{"RegionMember", "[", "regionlist", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"inReg", "[", 
             RowBox[{"Flatten", "@", "nearest"}], "]"}], ",", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"hitIndex", " ", "\[Equal]", "  ", 
                RowBox[{"-", "1"}]}], ",", 
               RowBox[{"hitIndex", " ", "=", " ", "i"}]}], "]"}], ";", 
             RowBox[{"Return", " ", "hitIndex"}]}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "hitIndex", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"findHitPoint2", "[", 
     RowBox[{
     "\[Alpha]_", ",", " ", "\[Theta]_", ",", " ", "ps1_", ",", " ", "ps2_", 
      ",", " ", "accuracy_", ",", " ", "nearest_"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Psi]a", " ", ",", "pra", ",", "\[Gamma]a", ",", "cola", ",", "i", 
        ",", " ", "hitIndex", ",", "c"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"hitIndex", " ", "=", " ", 
        RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{"i", "\[LessEqual]", "  ", "accuracy"}], ",", " ", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[Psi]a", "=", 
           RowBox[{"\[Theta]", "+", 
            RowBox[{"\[Alpha]", "/", "2"}], "+", 
            RowBox[{"\[Pi]", "/", "2"}], "+", 
            RowBox[{"i", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Pi]", "-", "\[Alpha]"}], ")"}], "/", 
              "accuracy"}]}]}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"cola", " ", "=", " ", 
           RowBox[{
            RowBox[{"1", "/", "2"}], 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Psi]a", " ", "]"}], ",", 
              RowBox[{"Sin", "[", "\[Psi]a", " ", "]"}]}], "}"}]}]}], ";", 
          " ", 
          RowBox[{"(*", 
           RowBox[{"collision", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"pra", "=", " ", 
           RowBox[{"2", " ", 
            RowBox[{"Abs", "[", 
             RowBox[{
              RowBox[{"ps1", ".", "cola"}], "-", 
              RowBox[{"ps2", ".", "cola"}]}], "]"}]}]}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{"perpendicular", " ", "distance"}], "*)"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"c", " ", "=", 
           RowBox[{
            RowBox[{"1", "/", "2"}], " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Psi]a", "]"}], ",", 
              RowBox[{"Sin", "[", "\[Psi]a", "]"}]}], "}"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Gamma]a", "=", " ", 
           RowBox[{"ArcCos", "[", 
            RowBox[{"1", "-", 
             RowBox[{"2", "pra"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<Result:\>\"", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ifInReg", " ", "[", 
                RowBox[{"\[Psi]a", ",", " ", "pra", ",", 
                 RowBox[{"Flatten", "@", "nearest"}]}], " ", "]"}], 
               "\[Equal]", " ", "False"}], ",", " ", 
              RowBox[{"Print", "[", "\"\<HIIII\>\"", "]"}], ",", " ", 
              RowBox[{"Print", "[", "\"\<BYEEEE\>\"", "]"}]}], "]"}], ";"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ifInRegion", " ", "[", 
              RowBox[{"c", ",", " ", "\[Psi]a", ",", " ", 
               RowBox[{"Flatten", "@", "nearest"}], ",", " ", "\[Gamma]a", 
               ",", " ", 
               RowBox[{"1", "/", "2"}]}], "]"}], "\[Equal]", " ", "True"}], 
            ",", " ", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"hitIndex", " ", "\[Equal]", "  ", 
                RowBox[{"-", "1"}]}], ",", 
               RowBox[{"hitIndex", " ", "=", " ", "i"}]}], "]"}], ";", 
             RowBox[{"Return", " ", "[", "hitIndex", "]"}]}]}], "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", " ", "[", "hitIndex", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"makeRegion", "[", 
     RowBox[{
     "\[Alpha]_", ",", " ", "\[Theta]_", ",", " ", "ps1_", ",", " ", "ps2_", 
      ",", " ", "line_"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Psi]a", " ", ",", "pra", ",", "\[Gamma]a", ",", "cola", ",", " ", 
        "regionlist"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Psi]a", "=", 
        RowBox[{
         RowBox[{"2", "\[Pi]"}], " ", "-", " ", 
         RowBox[{"2", "\[Alpha]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cola", " ", "=", " ", 
        RowBox[{
         RowBox[{"1", "/", "2"}], 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Psi]a", " ", "]"}], ",", 
           RowBox[{"Sin", "[", "\[Psi]a", " ", "]"}]}], "}"}]}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{"collision", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"pra", "=", " ", 
        RowBox[{"2", " ", 
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"ps1", ".", "cola"}], "-", 
           RowBox[{"ps2", ".", "cola"}]}], "]"}]}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{"perpendicular", " ", "distance"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]a", "=", " ", 
        RowBox[{"ArcCos", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"1", "/", "2"}], "-", "pra"}], 
          RowBox[{"1", "/", "2"}]], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "reachable", " ", "angle", " ", "for", " ", "other", " ", "robot", 
         " ", "after", " ", "first", " ", "robot", " ", "collides"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"regionlist", " ", "=", " ", 
        RowBox[{"Polygon", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"cola", "-", 
            RowBox[{
             RowBox[{"1", "/", "2"}], 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Cos", "[", "a", "]"}], ",", 
               RowBox[{"Sin", "[", "a", "]"}]}], "}"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", 
             RowBox[{"\[Psi]a", " ", "-", "\[Gamma]a"}], " ", ",", 
             RowBox[{"\[Psi]a", " ", "+", "\[Gamma]a"}], ",", 
             RowBox[{"\[Gamma]a", "/", "20"}]}], "}"}]}], "]"}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "regionlist", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"ifInReg", " ", "[", 
      RowBox[{"\[Psi]a_", ",", " ", "pra_", ",", "p_"}], " ", "]"}], ":=", 
     " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "determine", " ", "if", " ", "point", " ", "p", " ", "is", " ", 
        "located", " ", "inside", " ", "the", " ", "chord", " ", "of", " ", 
        "a", " ", "circle", " ", "centered", " ", 
        RowBox[{"at", " ", "'"}], 
        RowBox[{"c", "'"}]}], ",", " ", 
       RowBox[{"with", " ", "radius", " ", 
        RowBox[{"1", "/", "2"}]}], ",", " ", 
       RowBox[{
        RowBox[{
        "with", " ", "norm", " ", "at", " ", "angle", " ", "\[Psi]a", " ", 
         "from", " ", "x"}], "-", "axis"}], ",", " ", 
       RowBox[{"and", " ", "of", " ", "depth", " ", "pra"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Gamma]a", ",", " ", "c", ",", " ", "n"}], "}"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"n", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Psi]a", "]"}], ",", 
           RowBox[{"Sin", "[", "\[Psi]a", "]"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"c", " ", "=", 
         RowBox[{"n", "/", "2"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Gamma]a", "=", " ", 
         RowBox[{"ArcCos", "[", 
          RowBox[{"1", "-", 
           RowBox[{"2", "pra"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Norm", "[", 
            RowBox[{"p", "-", "c"}], "]"}], "\[LessEqual]", " ", 
           RowBox[{"1", "/", "2"}]}], ",", "  ", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"TEST", " ", "1"}], ":", " ", 
            RowBox[{
            "is", " ", "p", " ", "inside", " ", "circle", " ", "of", " ", 
             "raidus", " ", 
             RowBox[{"1", "/", "2"}], " ", "centered", " ", "at", " ", 
             RowBox[{"c", "?"}]}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"TEST", " ", "2"}], ",", " ", 
             RowBox[{
             "is", " ", "the", " ", "point", " ", "in", " ", "the", " ", 
              RowBox[{"chord", ".", "  ", "We"}], " ", "see", " ", "if", " ", 
              "it", " ", "is", " ", "in", " ", "the", " ", "halfplane", " ", 
              "in", " ", 
              RowBox[{"direction", " ", "'"}], 
              RowBox[{"n", "'"}], " ", "defined", " ", "by", " ", "point", 
              " ", "n"}]}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Dot", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"p", "-", "c"}], ")"}], ",", "n"}], " ", "]"}], " ", 
              "-", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"1", "/", "2"}], " ", "-", " ", "pra"}], ")"}]}], 
             "\[GreaterEqual]", " ", "0"}], ",", " ", 
            RowBox[{"Return", "[", "True", "]"}], ",", " ", 
            RowBox[{"Return", "[", "False", "]"}]}], "]"}], ",", 
          RowBox[{"Return", "[", "False", "]"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ifInRegion", "[", 
     RowBox[{
     "c_", ",", " ", "\[Psi]a_", ",", " ", "p_", ",", " ", "\[Gamma]a_", ",", 
      " ", "r_"}], "]"}], "  ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"d", ",", " ", "dc", ",", "  ", "A", ",", " ", "B"}], "}"}], 
      ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "C", " ", "is", " ", "the", " ", "center", " ", "of", " ", "the", " ", 
         RowBox[{"circle", ".", " ", "\[Psi]a"}], " ", "is", " ", "the", " ", 
         "angle", " ", "between", " ", "the", " ", "x", " ", "axis", " ", 
         "and", " ", "center", " ", "to", " ", "center", " ", "of", " ", 
         "the", " ", "chord", 
         RowBox[{
          RowBox[{"(", "D", ")"}], ".", " ", "\[IndentingNewLine]", 
          "\[Gamma]a"}], " ", "is", " ", "the", " ", "angle", " ", "between", 
         " ", "the", " ", "end", " ", "of", " ", "chord", 
         RowBox[{"(", "BCD", ")"}]}], ",", " ", 
        RowBox[{
        "A", " ", "is", " ", "one", " ", "end", " ", "point", " ", "of", " ", 
         "the", " ", "chord"}], ",", " ", 
        RowBox[{
        "B", " ", "is", " ", "the", " ", "other", " ", "end", " ", "point", 
         " ", "of", " ", "the", " ", "chord"}], ",", " ", 
        RowBox[{
        "d", " ", "and", " ", "dc", " ", "determines", " ", "if", " ", "the", 
         " ", "point", " ", "is", " ", "in", " ", "the", " ", "region", " ", 
         "or", " ", "not"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "-", 
              RowBox[{
              "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             ")"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "-", 
              RowBox[{
              "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             ")"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "p", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              "-", 
              RowBox[{
              "c", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
             ")"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "p", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              "-", 
              RowBox[{
              "c", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
             ")"}]}]}], ">", " ", 
          RowBox[{"r", "*", "r"}]}], ",", " ", 
         RowBox[{"Return", " ", "[", "False", "]"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"B", " ", "=", " ", 
        RowBox[{"c", " ", "+", " ", 
         RowBox[{"r", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Psi]a", "-", " ", "\[Gamma]a"}], "]"}], ",", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Psi]a", "-", " ", "\[Gamma]a"}], "]"}]}], "}"}]}]}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"A", " ", "=", " ", 
        RowBox[{"c", " ", "+", " ", 
         RowBox[{"r", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Psi]a", "+", " ", "\[Gamma]a"}], "]"}], ",", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Psi]a", "+", " ", "\[Gamma]a"}], "]"}]}], "}"}]}]}]}],
        " ", ";", "\[IndentingNewLine]", 
       RowBox[{"d", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
            "p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "\[Minus]", 
            RowBox[{
            "A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
            "B", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "\[Minus]", 
            RowBox[{
            "A", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
           ")"}]}], "\[Minus]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
            "p", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "\[Minus]", 
            RowBox[{
            "A", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
           ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
            "B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "\[Minus]", 
            RowBox[{
            "A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           ")"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dc", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "\[Minus]", 
            RowBox[{
            "A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
            "B", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "\[Minus]", 
            RowBox[{
            "A", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
           ")"}]}], "\[Minus]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
            "c", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "\[Minus]", 
            RowBox[{
            "A", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
           ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
            "B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "\[Minus]", 
            RowBox[{
            "A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           ")"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", " ", 
        RowBox[{
         RowBox[{"\[Gamma]a", "\[LessEqual]", "  ", 
          RowBox[{"\[Pi]", "/", "2"}]}], ",", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"d", "*", "dc"}], " ", "\[LessEqual]", "0"}], " ", ",", 
           " ", 
           RowBox[{"Return", " ", "[", "True", "]"}], ",", " ", 
           RowBox[{"Return", "[", "False", "]"}]}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"d", "*", "dc"}], " ", ">", "0"}], " ", ",", " ", 
           RowBox[{"Return", " ", "[", "True", "]"}], ",", " ", 
           RowBox[{"Return", "[", "False", "]"}]}], "]"}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.717772772192747*^9, 3.717772773911172*^9}, {
   3.7177728816745043`*^9, 3.717772899198235*^9}, {3.717773239681828*^9, 
   3.717773239812923*^9}, {3.7177899915930243`*^9, 3.7177899917748547`*^9}, {
   3.7177904862181787`*^9, 3.71779049348083*^9}, 3.717834292964789*^9, {
   3.717834393072319*^9, 3.717834416088849*^9}, {3.717834451155746*^9, 
   3.71783446197757*^9}, {3.717834497609233*^9, 3.717834511849818*^9}, {
   3.71783475171355*^9, 3.717834825863261*^9}, {3.717847712056369*^9, 
   3.717847741931171*^9}, {3.718030156572353*^9, 3.718030187027685*^9}, {
   3.718030234545259*^9, 3.718030398615531*^9}, {3.718030593797307*^9, 
   3.718030596129284*^9}, {3.718031074773374*^9, 3.718031122915777*^9}, {
   3.718031200180974*^9, 3.718031225850152*^9}, {3.7180312935031776`*^9, 
   3.718031363524624*^9}, {3.718386045927877*^9, 3.718386047272704*^9}, {
   3.718386099011256*^9, 3.718386149521929*^9}, {3.718657112278577*^9, 
   3.7186571131439657`*^9}, {3.718657162509116*^9, 3.7186572416673*^9}, 
   3.718657402602623*^9, {3.7186574897143583`*^9, 3.7186575267855453`*^9}, 
   3.718657557295154*^9, {3.718657616809146*^9, 3.718657617475192*^9}, {
   3.718657684426326*^9, 3.71865769374199*^9}, {3.7186577622890387`*^9, 
   3.718657762989135*^9}, 
   3.718657796771697*^9},ExpressionUUID->"1d65b189-0cc0-4a49-a5e6-\
7c338fc1589d"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.717850891621118*^9, {3.717850963979663*^9, 3.717850969423439*^9}, {
   3.717851391869338*^9, 3.717851450701948*^9}, 3.717851492314125*^9, {
   3.717851557502533*^9, 3.717851607105343*^9}, {3.717851639465871*^9, 
   3.717851747716351*^9}, {3.717851821143732*^9, 3.7178519001940107`*^9}, {
   3.7178520178672113`*^9, 3.717852192459258*^9}, {3.717852223943933*^9, 
   3.717852566838257*^9}, {3.717852654360958*^9, 3.717852750538241*^9}, 
   3.7178527821600647`*^9, {3.717852817582592*^9, 3.717852843276967*^9}, {
   3.718030931868991*^9, 3.718030937520685*^9}, {3.718030971394804*^9, 
   3.718030995921224*^9}, 3.718031029733623*^9, {3.718031103275469*^9, 
   3.718031119645453*^9}},ExpressionUUID->"b8b61b9f-295c-4b81-9767-\
2ff999870c58"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"ArcCos", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"1", "/", "2"}], "-", "pra"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"1", "/", "2"}], ")"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7178528088311577`*^9, 
  3.717852811647789*^9}},ExpressionUUID->"60daef29-134a-4158-a341-\
c2afd469ad2e"],

Cell[BoxData[
 RowBox[{"ArcCos", "[", 
  RowBox[{"1", "-", 
   RowBox[{"2", " ", "pra"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.717852812235388*^9},ExpressionUUID->"e5d056e9-a60a-47d4-88d7-\
a46328192bfd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"clipCircle", "[", 
      RowBox[{"p_", ",", "\[Epsilon]_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Norm", "[", "p", "]"}], ">", 
        RowBox[{
         RowBox[{"1", "/", "2"}], "-", "\[Epsilon]"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"1", "/", "2"}], "-", "\[Epsilon]"}], ")"}], 
        RowBox[{"p", "/", 
         RowBox[{"Norm", "[", "p", "]"}]}]}], ",", "p"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "keeps", " ", "robots", " ", "inside", " ", "of", " ", "circle", " ", 
      "of", " ", "radius", " ", 
      RowBox[{"1", "/", "2"}]}], "-", "\[Epsilon]"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]", " ", "=", " ", 
     RowBox[{"1", "/", "1000"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"reg", ";"}], "\[IndentingNewLine]", 
   RowBox[{"inReg", ";"}], "\[IndentingNewLine]", 
   RowBox[{"nearest", ";"}], "\[IndentingNewLine]", 
   RowBox[{"Manipulate", "[", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"thickness", " ", "=", " ", "0.005"}], ",", 
         "\[IndentingNewLine]", "d", " ", 
         RowBox[{"(*", 
          RowBox[{"distance", " ", "between", " ", "robots"}], "*)"}], ",", 
         "\[IndentingNewLine]", "\[Theta]", 
         RowBox[{"(*", 
          RowBox[{
          "angle", " ", "between", " ", "the", " ", "two", " ", "particles"}],
           "*)"}], ",", "\[IndentingNewLine]", "\[Alpha]", 
         RowBox[{"(*", 
          RowBox[{
          "anglular", " ", "arc", " ", "unreachable", " ", "by", " ", 
           "robots"}], "*)"}], ",", "\[IndentingNewLine]", 
         RowBox[{"r", " ", "=", " ", 
          RowBox[{"1", "/", "40"}]}], " ", 
         RowBox[{"(*", 
          RowBox[{
          "radius", " ", "of", " ", "start", " ", "and", " ", "end", " ", 
           "markers"}], "*)"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"perpendicular", " ", 
           RowBox[{"distance", ":", " ", 
            RowBox[{
            "maximum", " ", "height", " ", "of", " ", "chord", " ", "to", " ",
              "boundary"}]}]}], " ", "*)"}], " ", "pr", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"reachable", " ", "angle"}], "*)"}], " ", "\[Gamma]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"angle", " ", "to", " ", "collision"}], "*)"}], " ", 
         "\[Psi]", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"left", " ", "robot"}], "*)"}], " ", "ps1", ",", "pe1", ",",
          "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"right", " ", "robot"}], "*)"}], " ", "ps2", ",", "pe2", 
         ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"collision", " ", "point"}], "*)"}], "pcol1", ",", 
         "\[IndentingNewLine]", "\[CapitalDelta]g", " ", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"c1", "=", "Blue"}], ",", 
         RowBox[{"c2", " ", "=", "Magenta"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"s1", "=", 
         RowBox[{"clipCircle", "[", 
          RowBox[{"s1", ",", "\[Epsilon]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"e1", "=", 
         RowBox[{"clipCircle", "[", 
          RowBox[{"e1", ",", "\[Epsilon]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"s2", "=", 
         RowBox[{"clipCircle", "[", 
          RowBox[{"s2", ",", "\[Epsilon]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"e2", "=", 
         RowBox[{"clipCircle", "[", 
          RowBox[{"e2", ",", "\[Epsilon]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[CapitalDelta]g", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"pe2", "-", "pe1"}], "}"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ps1", " ", ",", "pe1", ",", "ps2", ",", "pe2"}], "}"}], 
         " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"s1", ",", "e1", ",", "s2", ",", "e2"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Norm", "[", "col1", "]"}], "\[NotEqual]", " ", 
           RowBox[{"1", "/", "2"}]}], ",", 
          RowBox[{"col1", " ", "=", 
           FractionBox["col1", 
            RowBox[{"2", " ", 
             RowBox[{"Norm", "[", "col1", "]"}]}]]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ps1", " ", ",", "ps2", ",", "pcol1"}], "}"}], " ", "=", 
         " ", 
         RowBox[{"{", 
          RowBox[{"s1", ",", "s2", ",", "col1"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"d", " ", "=", " ", 
         RowBox[{"Norm", "[", 
          RowBox[{"ps1", "-", "ps2"}], "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{"distance", " ", "between", " ", "robots"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"\[Theta]", " ", "=", " ", 
         RowBox[{"ArcTan", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "ps1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "-", 
            RowBox[{
            "ps2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           ",", 
           RowBox[{
            RowBox[{
            "ps1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "-", 
            RowBox[{
            "ps2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}],
           "]"}]}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{
         "angle", " ", "between", " ", "the", " ", "two", " ", "particles"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"\[Alpha]", " ", "=", " ", 
         RowBox[{"2", " ", 
          RowBox[{"ArcSin", "[", "d", "]"}]}]}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{
         "anglular", " ", "arc", " ", "unreachable", " ", "by", " ", 
          "robots"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"\[Psi]", " ", "=", 
         RowBox[{"ArcTan", "[", 
          RowBox[{
           RowBox[{
           "col1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           ",", 
           RowBox[{
           "col1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
          "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{"angle", " ", "to", " ", "collision"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"pr", " ", "=", " ", 
         RowBox[{"2", " ", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"ps1", ".", "col1"}], "-", 
            RowBox[{"ps2", ".", "col1"}]}], "]"}]}]}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{"perpendicular", " ", 
          RowBox[{"distance", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"\[Gamma]", " ", "=", " ", 
         RowBox[{"ArcCos", "[", 
          FractionBox[
           RowBox[{
            RowBox[{"1", "/", "2"}], "-", "pr"}], 
           RowBox[{"1", "/", "2"}]], "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
         "reachable", " ", "angle", " ", "for", " ", "other", " ", "robot", 
          " ", "after", " ", "first", " ", "robot", " ", "collides"}], "*)"}],
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Graphics", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", "workspace", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Darker", "[", "Red", "]"}], ",", " ", 
              RowBox[{"Disk", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", 
                RowBox[{"1.025", "/", "2"}]}], "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Lighter", "[", 
               RowBox[{"Gray", ",", "0.8"}], "]"}], ",", " ", 
              RowBox[{"Disk", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", 
                RowBox[{"1", "/", "2"}]}], "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"White", ",", " ", 
              RowBox[{"Disk", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", 
                RowBox[{
                 RowBox[{"1", "/", "2"}], "-", "\[Epsilon]"}]}], "]"}]}], 
             "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Lighter", "[", 
               RowBox[{"Gray", ",", "0.8"}], "]"}], ",", " ", 
              RowBox[{"Disk", "[", 
               RowBox[{"ps2", ",", "\[Epsilon]"}], "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PointSize", "[", "0.01", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Arrowheads", "[", ".03", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"(*", 
              RowBox[{"wall", " ", "collision", " ", "points"}], "*)"}], 
             RowBox[{
              RowBox[{"Thickness", "[", 
               RowBox[{"3", " ", "thickness"}], "]"}], ",", "c2", ",", 
              RowBox[{"Circle", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", 
                RowBox[{"1", "/", "2"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Theta]", "+", 
                   RowBox[{"\[Alpha]", "/", "2"}], "+", 
                   RowBox[{"\[Pi]", "/", "2"}]}], ",", 
                  RowBox[{"\[Theta]", "-", 
                   RowBox[{"\[Alpha]", "/", "2"}], "-", 
                   RowBox[{"\[Pi]", "/", "2"}], "+", 
                   RowBox[{"2", "\[Pi]"}]}]}], "}"}]}], "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"(*", 
              RowBox[{"wall", " ", "collision", " ", "points"}], "*)"}], 
             RowBox[{
              RowBox[{"Thickness", "[", 
               RowBox[{"3", " ", "thickness"}], "]"}], ",", "c1", ",", 
              RowBox[{"Circle", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", 
                RowBox[{"1", "/", "2"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Theta]", "-", 
                   RowBox[{"\[Alpha]", "/", "2"}], "+", 
                   RowBox[{"\[Pi]", "/", "2"}]}], ",", 
                  RowBox[{"\[Theta]", "+", 
                   RowBox[{"\[Alpha]", "/", "2"}], "-", 
                   RowBox[{"\[Pi]", "/", "2"}]}]}], "}"}]}], "]"}]}], "}"}], 
            ",", "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
            RowBox[{"{", 
             RowBox[{"(*", 
              RowBox[{
              "reachable", " ", "regions", " ", "when", " ", "robot", " ", 
               "2", " ", "hits", " ", 
               RowBox[{"first", ":", " ", 
                RowBox[{
                "try", " ", "many", " ", "collision", " ", "points"}]}]}], 
              "*)"}], "\[IndentingNewLine]", 
             RowBox[{"Module", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "\[Psi]a", " ", ",", "pra", ",", "\[Gamma]a", ",", "cola"}], 
                "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Table", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Psi]a", "=", 
                   RowBox[{"\[Theta]", "+", 
                    RowBox[{"\[Alpha]", "/", "2"}], "+", 
                    RowBox[{"\[Pi]", "/", "2"}], "+", 
                    RowBox[{"c", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[Pi]", "-", "\[Alpha]"}], ")"}], "/", 
                    "20"}]}]}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"cola", " ", "=", " ", 
                   RowBox[{
                    RowBox[{"1", "/", "2"}], 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "\[Psi]a", " ", "]"}], ",", 
                    RowBox[{"Sin", "[", "\[Psi]a", " ", "]"}]}], "}"}]}]}], 
                  ";", 
                  RowBox[{"(*", 
                   RowBox[{
                   "collision", " ", "point", " ", "for", " ", "robot", " ", 
                    RowBox[{"2", " ", "--"}], " ", "where", " ", "it", " ", 
                    "hits", " ", "the", " ", "circular", " ", "boundary"}], 
                   "*)"}], "\[IndentingNewLine]", 
                  RowBox[{"pra", "=", " ", 
                   RowBox[{"2", " ", 
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"ps1", ".", "cola"}], "-", 
                    RowBox[{"ps2", ".", "cola"}]}], "]"}]}]}], ";", " ", 
                  RowBox[{"(*", 
                   RowBox[{"perpendicular", " ", 
                    RowBox[{"distance", ":", " ", 
                    RowBox[{
                    "maximum", " ", "height", " ", "of", " ", "chord", " ", 
                    "to", " ", "boundary"}]}]}], " ", "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{"\[Gamma]a", "=", " ", 
                   RowBox[{"ArcCos", "[", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"1", "/", "2"}], "-", "pra"}], 
                    RowBox[{"1", "/", "2"}]], "]"}]}], ";", 
                  RowBox[{"(*", 
                   RowBox[{
                   "reachable", " ", "angle", " ", "for", " ", "other", " ", 
                    "robot", " ", "after", " ", "first", " ", "robot", " ", 
                    "collides"}], "*)"}], "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Hue", "[", 
                    FractionBox["\[Psi]a", 
                    RowBox[{"2", "\[Pi]"}]], "]"}], ",", 
                    RowBox[{"Point", "[", "cola", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"(*", 
                    RowBox[{
                    "draw", " ", "the", " ", "chord", " ", "of", " ", 
                    "reachable", " ", "locations", " ", "by", " ", "robot", 
                    " ", "1", " ", "after", " ", "robot", " ", "2", " ", 
                    "hits", " ", "cola"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Opacity", "[", "0.05", "]"}], ",", 
                    RowBox[{"Polygon", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "2"}], 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "a", "]"}], ",", 
                    RowBox[{"Sin", "[", "a", "]"}]}], "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", 
                    RowBox[{"\[Psi]a", " ", "-", "\[Gamma]a"}], " ", ",", 
                    RowBox[{"\[Psi]a", " ", "+", "\[Gamma]a"}], ",", 
                    RowBox[{"\[Gamma]a", "/", "20"}]}], "  ", 
                    RowBox[{"(*", 
                    RowBox[{
                    "approximate", " ", "a", " ", "chord", " ", "of", " ", 
                    "a", " ", "circle", " ", "by", " ", "taking", " ", "many",
                     " ", "points"}], "*)"}], "}"}]}], "]"}], "]"}]}], "}"}], 
                    ","}], "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "2"}], 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Psi]a", " ", "-", "\[Gamma]a"}], "]"}], ",", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Psi]a", "-", "\[Gamma]a"}], "]"}]}], "}"}]}], 
                    ",", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Psi]a", " ", "+", "\[Gamma]a"}], "]"}], ",", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Psi]a", "+", "\[Gamma]a"}], "]"}]}], "}"}]}]}],
                     "}"}], "]"}], "*)"}], "}"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"c", ",", "0", ",", "hits"}], " ", "}"}]}], "]"}]}],
               "]"}], "\[IndentingNewLine]", "}"}], ",", 
            "\[IndentingNewLine]", " ", 
            RowBox[{"{", 
             RowBox[{"(*", 
              RowBox[{
              "reachable", " ", "regions", " ", "when", " ", "robot", " ", 
               "1", " ", "hits", " ", "first"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"Module", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "\[Psi]a", " ", ",", "pra", ",", "\[Gamma]a", ",", "cola", 
                 ",", "c"}], "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Table", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Psi]a", "=", 
                   RowBox[{"\[Theta]", "+", 
                    RowBox[{"\[Alpha]", "/", "2"}], "-", 
                    RowBox[{"\[Pi]", "/", "2"}], "+", 
                    RowBox[{"c", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[Pi]", "-", "\[Alpha]"}], ")"}], "/", 
                    "20"}]}]}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"cola", " ", "=", " ", 
                   RowBox[{
                    RowBox[{"1", "/", "2"}], 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "\[Psi]a", " ", "]"}], ",", 
                    RowBox[{"Sin", "[", "\[Psi]a", " ", "]"}]}], "}"}]}]}], 
                  ";", "\[IndentingNewLine]", 
                  RowBox[{"pra", "=", " ", 
                   RowBox[{"2", " ", 
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"ps1", ".", "cola"}], "-", 
                    RowBox[{"ps2", ".", "cola"}]}], "]"}]}]}], ";", " ", 
                  RowBox[{"(*", 
                   RowBox[{"perpendicular", " ", "distance"}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{"\[Gamma]a", "=", " ", 
                   RowBox[{"ArcCos", "[", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"1", "/", "2"}], "-", "pra"}], 
                    RowBox[{"1", "/", "2"}]], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Hue", "[", 
                    FractionBox["\[Psi]a", 
                    RowBox[{"2", "\[Pi]"}]], "]"}], ",", 
                    RowBox[{"Point", "[", "cola", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Opacity", "[", "0.05", "]"}], ",", 
                    RowBox[{"EdgeForm", "[", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Hue", "[", 
                    FractionBox["\[Psi]a", 
                    RowBox[{"2", "\[Pi]"}]], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Polygon", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "2"}], 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "a", "]"}], ",", 
                    RowBox[{"Sin", "[", "a", "]"}]}], "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", 
                    RowBox[{"\[Psi]a", " ", "-", "\[Gamma]a"}], " ", ",", 
                    RowBox[{"\[Psi]a", " ", "+", "\[Gamma]a"}], ",", 
                    RowBox[{"\[Gamma]a", "/", "20"}]}], "}"}]}], "]"}], 
                    "]"}]}], "}"}], ","}], "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    "draw", " ", "the", " ", "chord", " ", "in", " ", "a", 
                    " ", "solid", " ", 
                    RowBox[{"(", 
                    RowBox[{"non", "-", "transparent"}], ")"}], " ", "line"}],
                     "*)"}], "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "2"}], 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Psi]a", " ", "-", "\[Gamma]a"}], "]"}], ",", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Psi]a", "-", "\[Gamma]a"}], "]"}]}], "}"}]}], 
                    ",", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Psi]a", " ", "+", "\[Gamma]a"}], "]"}], ",", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Psi]a", "+", "\[Gamma]a"}], "]"}]}], "}"}]}]}],
                     "}"}], "]"}], "*)"}], "}"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"c", ",", "0", ",", "hits"}], "}"}]}], "]"}]}], 
              "]"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"starting", " ", "poses"}], ",", " ", 
              RowBox[{
              "dashed", " ", "line", " ", "from", " ", "start", " ", "to", 
               " ", "end"}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"c1", ",", 
              RowBox[{"Thickness", "[", "thickness", "]"}], ",", 
              RowBox[{"{", " ", 
               RowBox[{
                RowBox[{"Opacity", "[", ".3", "]"}], ",", "Dashed", ",", 
                RowBox[{"Arrow", "[", 
                 RowBox[{"{", 
                  RowBox[{"ps1", ",", "pe1"}], "}"}], "]"}]}], "}"}], ",", 
              RowBox[{"Point", "@", "ps1"}], ",", 
              RowBox[{"EdgeForm", "[", 
               RowBox[{"Directive", "[", 
                RowBox[{"c1", ",", 
                 RowBox[{"Thickness", "[", "thickness", "]"}]}], "]"}], "]"}],
               ",", 
              RowBox[{"FaceForm", "[", "None", "]"}], ",", 
              RowBox[{"Rectangle", "[", 
               RowBox[{
                RowBox[{"ps1", "-", 
                 RowBox[{
                  RowBox[{"2", "/", "3"}], "r", " ", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "1"}], "}"}]}]}], ",", 
                RowBox[{"ps1", "+", 
                 RowBox[{
                  RowBox[{"2", "/", "3"}], "r", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "1"}], "}"}]}]}]}], "]"}], ",", 
              RowBox[{"Circle", "[", 
               RowBox[{"pe1", ",", "r"}], "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"c2", ",", 
              RowBox[{"Thickness", "[", "thickness", "]"}], ",", 
              RowBox[{"{", " ", 
               RowBox[{
                RowBox[{"Opacity", "[", ".3", "]"}], ",", "Dashed", ",", 
                RowBox[{"Arrow", "[", 
                 RowBox[{"{", 
                  RowBox[{"ps2", ",", "pe2"}], "}"}], "]"}]}], "}"}], ",", 
              RowBox[{"Point", "@", "ps2"}], ",", 
              RowBox[{"EdgeForm", "[", 
               RowBox[{"Directive", "[", 
                RowBox[{"c2", ",", 
                 RowBox[{"Thickness", "[", "thickness", "]"}]}], "]"}], "]"}],
               ",", 
              RowBox[{"FaceForm", "[", "None", "]"}], ",", 
              RowBox[{"Rectangle", "[", 
               RowBox[{
                RowBox[{"ps2", "-", 
                 RowBox[{
                  RowBox[{"2", "/", "3"}], "r", " ", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "1"}], "}"}]}]}], ",", 
                RowBox[{"ps2", "+", 
                 RowBox[{
                  RowBox[{"2", "/", "3"}], "r", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "1"}], "}"}]}]}]}], "]"}], ",", " ", 
              RowBox[{"Circle", "[", 
               RowBox[{"pe2", ",", "r"}], "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"Inset", "[", 
             RowBox[{
              RowBox[{"Module", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "\[Psi]a", " ", ",", "pra", ",", "\[Gamma]a", ",", "cola", 
                  ",", "\[Gamma]a2", ",", "  ", "polyline1", ",", " ", 
                  "polyline2", ",", " ", "polyline3", ",", " ", "polyline4", 
                  ",", " ", "hitIndex", ",", " ", "regionlist", ",", 
                  "finalpoly", ",", " ", "line", ",", " ", "sol", ",", " ", 
                  "x", ",", " ", "y", ",", " ", "line2"}], "}"}], ",", 
                RowBox[{
                 RowBox[{"cola", " ", "=", " ", 
                  RowBox[{
                   RowBox[{"1", "/", "2"}], 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "\[Psi]a", " ", "]"}], ",", 
                    RowBox[{"Sin", "[", "\[Psi]a", " ", "]"}]}], "}"}]}]}], 
                 ";", " ", 
                 RowBox[{"(*", 
                  RowBox[{"collision", " ", "point"}], "*)"}], 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"pra", "=", " ", 
                  RowBox[{"2", " ", 
                   RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"ps1", ".", "cola"}], "-", 
                    RowBox[{"ps2", ".", "cola"}]}], "]"}]}]}], ";", " ", 
                 RowBox[{"(*", 
                  RowBox[{"perpendicular", " ", "distance"}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"\[Gamma]a", "=", " ", 
                  RowBox[{"ArcCos", "[", 
                   FractionBox[
                    RowBox[{
                    RowBox[{"1", "/", "2"}], "-", "pra"}], 
                    RowBox[{"1", "/", "2"}]], "]"}]}], ";", 
                 RowBox[{"(*", 
                  RowBox[{
                  "reachable", " ", "angle", " ", "for", " ", "other", " ", 
                   "robot", " ", "after", " ", "first", " ", "robot", " ", 
                   "collides"}], "*)"}], "\[IndentingNewLine]", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ParametricPlot", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"cola", "-", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "a", "]"}], ",", 
                    RowBox[{"Sin", "[", "a", "]"}]}], "}"}]}]}], "}"}], ",", 
                   " ", 
                   RowBox[{"{", 
                    RowBox[{"\[Psi]a", ",", 
                    RowBox[{"\[Theta]", "+", 
                    RowBox[{"\[Alpha]", "/", "2"}], "+", 
                    RowBox[{"\[Pi]", "/", "2"}]}], ",", 
                    RowBox[{"\[Theta]", "-", 
                    RowBox[{"\[Alpha]", "/", "2"}], "+", 
                    RowBox[{
                    RowBox[{"3", "/", "2"}], "\[Pi]"}]}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", 
                    RowBox[{"\[Psi]a", " ", "-", "\[Gamma]a"}], " ", ",", 
                    RowBox[{"\[Psi]a", " ", "+", "\[Gamma]a"}]}], "}"}], ",", 
                   
                   RowBox[{"PlotRange", "\[Rule]", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
                   RowBox[{"FrameLabel", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\[CapitalDelta]x\>\"", ",", 
                    "\"\<\[CapitalDelta] y\>\""}], "}"}]}], ",", 
                   RowBox[{"LabelStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Black", ",", "Bold", ",", "Large"}], "]"}]}], 
                   ",", 
                   RowBox[{"ImageSize", "\[Rule]", "400"}], ",", " ", 
                   RowBox[{"Epilog", "\[Rule]", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Circle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"1", "-", 
                    RowBox[{"2", "\[Epsilon]"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"THIS", " ", "IS", " ", "HORRIBLY", " ", 
                    RowBox[{"COMPLICATED", ".", "  ", "SURELY"}], " ", "IT", 
                    " ", 
                    RowBox[{"SIMPLIFIES", ".", "  ", "PLEASE"}], " ", 
                    "SIMPLIFY", " ", "IT"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"\[Gamma]a2", "=", " ", 
                    RowBox[{
                    RowBox[{"ArcCos", "[", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"1", "/", "2"}], "-", "pra"}], 
                    RowBox[{"1", "/", "2"}]], "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"\[Psi]a", "\[Rule]", " ", 
                    RowBox[{"\[Theta]", "+", 
                    RowBox[{"\[Alpha]", "/", "2"}], "+", 
                    RowBox[{"\[Pi]", "/", "2"}]}]}], "}"}]}]}], ";", 
                    "Thick"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{"\[Gamma]a2", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"polyline1", " ", "=", " ", 
                    RowBox[{"Table", "[", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "2"}], 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Theta]", "+", 
                    RowBox[{"\[Alpha]", "/", "2"}], "+", 
                    RowBox[{"\[Pi]", "/", "2"}]}], " ", "]"}], ",", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]", "+", 
                    RowBox[{"\[Alpha]", "/", "2"}], "+", 
                    RowBox[{"\[Pi]", "/", "2"}]}], " ", "]"}]}], "}"}]}], "-", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"a2", "+", "\[Theta]", "+", 
                    RowBox[{"\[Alpha]", "/", "2"}], "+", 
                    RowBox[{"\[Pi]", "/", "2"}]}], "]"}], ",", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"a2", "+", "\[Theta]", "+", 
                    RowBox[{"\[Alpha]", "/", "2"}], "+", 
                    RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}], "}"}]}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"a2", ",", "0", ",", 
                    RowBox[{"+", "\[Gamma]a2"}], ",", 
                    RowBox[{"\[Gamma]a2", "/", "5"}]}], "}"}]}], "]"}]}], ";",
                     " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"\[Gamma]a2", "=", " ", 
                    RowBox[{
                    RowBox[{"ArcCos", "[", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"1", "/", "2"}], "-", "pra"}], 
                    RowBox[{"1", "/", "2"}]], "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"\[Psi]a", "\[Rule]", " ", 
                    RowBox[{"\[Theta]", "-", 
                    RowBox[{"\[Alpha]", "/", "2"}], "+", 
                    RowBox[{"3", 
                    RowBox[{"\[Pi]", "/", "2"}]}]}]}], "}"}]}]}], ";", 
                    "Thick"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{"\[Gamma]a2", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"polyline2", " ", "=", " ", 
                    RowBox[{"Table", "[", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "2"}], 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Theta]", "-", 
                    RowBox[{"\[Alpha]", "/", "2"}], "+", 
                    RowBox[{"3", 
                    RowBox[{"\[Pi]", "/", "2"}]}]}], " ", "]"}], ",", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]", "-", 
                    RowBox[{"\[Alpha]", "/", "2"}], "+", 
                    RowBox[{"3", 
                    RowBox[{"\[Pi]", "/", "2"}]}]}], " ", "]"}]}], "}"}]}], 
                    "-", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"a2", "+", "\[Theta]", "-", 
                    RowBox[{"\[Alpha]", "/", "2"}], "+", 
                    RowBox[{"3", 
                    RowBox[{"\[Pi]", "/", "2"}]}]}], "]"}], ",", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"a2", "+", "\[Theta]", "-", 
                    RowBox[{"\[Alpha]", "/", "2"}], "+", 
                    RowBox[{"3", 
                    RowBox[{"\[Pi]", "/", "2"}]}]}], "]"}]}], "}"}]}]}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"a2", ",", 
                    RowBox[{"-", "\[Gamma]a2"}], ",", "0", ",", 
                    RowBox[{"\[Gamma]a2", "/", "5"}]}], "}"}]}], "]"}]}], ";",
                     " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"polyline3", "=", " ", 
                    RowBox[{"Table", "[", "  ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "2"}], 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "\[Psi]a", " ", "]"}], ",", 
                    RowBox[{"Sin", "[", "\[Psi]a", " ", "]"}]}], "}"}]}], "-", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Psi]a", " ", "-", "\[Gamma]a"}], "]"}], ",", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Psi]a", " ", "-", "\[Gamma]a"}], "]"}]}], 
                    "}"}]}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\[Psi]a", ",", 
                    RowBox[{"\[Theta]", "+", 
                    RowBox[{"\[Alpha]", "/", "2"}], "+", 
                    RowBox[{"\[Pi]", "/", "2"}]}], ",", 
                    RowBox[{"\[Theta]", "-", 
                    RowBox[{"\[Alpha]", "/", "2"}], "+", 
                    RowBox[{
                    RowBox[{"3", "/", "2"}], "\[Pi]"}]}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[Pi]", "-", "\[Alpha]"}], ")"}], "/", "20"}]}], 
                    "}"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
                    RowBox[{"polyline4", " ", "=", " ", 
                    RowBox[{"Table", "[", "  ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "2"}], 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "\[Psi]a", " ", "]"}], ",", 
                    RowBox[{"Sin", "[", "\[Psi]a", " ", "]"}]}], "}"}]}], "-", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Psi]a", " ", "+", "\[Gamma]a"}], "]"}], ",", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Psi]a", " ", "+", "\[Gamma]a"}], "]"}]}], 
                    "}"}]}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\[Psi]a", ",", 
                    RowBox[{"\[Theta]", "+", 
                    RowBox[{"\[Alpha]", "/", "2"}], "+", 
                    RowBox[{"\[Pi]", "/", "2"}]}], ",", 
                    RowBox[{"\[Theta]", "-", 
                    RowBox[{"\[Alpha]", "/", "2"}], "+", 
                    RowBox[{
                    RowBox[{"3", "/", "2"}], "\[Pi]"}]}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[Pi]", "-", "\[Alpha]"}], ")"}], "/", "20"}]}], 
                    "}"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
                    RowBox[{"finalpoly", " ", "=", " ", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    "polyline2", ",", "polyline1", ",", " ", "polyline4", ",",
                     " ", "polyline3"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    
                    RowBox[{"reg", " ", "=", " ", 
                    RowBox[{"Polygon", "[", "finalpoly", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"inReg", " ", "=", 
                    RowBox[{"RegionMember", "[", "reg", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"nearest", " ", "=", " ", 
                    RowBox[{"RegionNearest", "[", 
                    RowBox[{"reg", ",", "\[CapitalDelta]g"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"hitIndex", " ", "=", " ", 
                    RowBox[{"findHitPoint2", "[", 
                    RowBox[{
                    "\[Alpha]", ",", " ", "\[Theta]", ",", " ", "ps1", ",", 
                    " ", "ps2", ",", " ", "100", ",", " ", 
                    RowBox[{"Flatten", "@", "nearest"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"hitIndex", " ", "\[NotEqual]", " ", 
                    RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"regionlist", " ", "=", " ", 
                    RowBox[{"makeRegionList", "[", " ", 
                    RowBox[{
                    "\[Alpha]", ",", " ", "\[Theta]", ",", " ", "ps1", ",", 
                    " ", "ps2", ",", " ", "hitIndex", ",", " ", "100"}], 
                    "]"}]}], ";"}], "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"line", " ", "=", " ", 
                    RowBox[{"InfiniteLine", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Flatten", "@", "nearest"}], ",", " ", 
                    RowBox[{"ps2", "-", "ps1"}]}], "}"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"sol", "=", 
                    RowBox[{"Solve", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "\[Element]", "line"}], "&&", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "\[Element]", 
                    RowBox[{"Line", "@", 
                    RowBox[{"Append", "[", 
                    RowBox[{"finalpoly", ",", 
                    RowBox[{"finalpoly", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"intersect", " ", "=", " ", 
                    RowBox[{"Point", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "/.", "sol"}], "]"}]}]}], 
                    "*)"}], ",", 
                    RowBox[{
                    RowBox[{"regionlist", " ", "=", " ", 
                    RowBox[{"makeRegionList", "[", " ", 
                    RowBox[{
                    "\[Alpha]", ",", " ", "\[Theta]", ",", " ", "ps1", ",", 
                    " ", "ps2", ",", " ", "1", ",", " ", "100"}], "]"}]}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"line2", " ", "=", " ", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"First", "@", "intersect"}], ",", " ", 
                    RowBox[{"Last", "@", "intersect"}]}], "}"}], "]"}]}], ";",
                     "\[IndentingNewLine]", 
                    RowBox[{"regionlist", " ", "=", " ", 
                    RowBox[{"makeRegion", "[", 
                    RowBox[{
                    "\[Alpha]", ",", " ", "\[Theta]", ",", " ", "ps1", ",", 
                    " ", "ps2", ",", " ", "line2"}], "]"}]}], ";"}], "*)"}], 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", "Blue"}], 
                    ",", 
                    RowBox[{"EdgeForm", "[", 
                    RowBox[{"{", 
                    RowBox[{"Red", ",", "Thick"}], "}"}], "]"}], ",", "reg", 
                    ",", "\[IndentingNewLine]", "Green", ",", " ", 
                    RowBox[{"PointSize", "[", "0.05", "]"}], ",", "intersect",
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Black", ",", " ", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"First", "@", "intersect"}], ",", " ", 
                    RowBox[{"Last", "@", "intersect"}]}], "}"}], "]"}], ","}],
                     "*)"}], "\[IndentingNewLine]", "Pink", ",", 
                    RowBox[{"Line", "[", "polyline1", "]"}], ",", 
                    "\[IndentingNewLine]", "Black", ",", " ", 
                    RowBox[{"Line", "[", "polyline2", "]"}], ",", 
                    "\[IndentingNewLine]", "Green", " ", ",", " ", 
                    RowBox[{"Line", "[", "polyline3", "]"}], ",", 
                    "\[IndentingNewLine]", "Brown", ",", " ", 
                    RowBox[{"Line", "[", "polyline4", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"goal", " ", "deltas"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Red", ",", " ", 
                    RowBox[{"Disk", "[", 
                    RowBox[{
                    RowBox[{"pe2", "-", "pe1"}], ",", 
                    RowBox[{"2", "r"}]}], "]"}], ","}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"Red", ",", 
                    RowBox[{"Opacity", "[", "0.1", "]"}], ",", 
                    RowBox[{"EdgeForm", "[", 
                    RowBox[{"Directive", "[", "Red", "]"}], "]"}], ",", 
                    "regionlist"}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"inReg", "[", 
                    RowBox[{"Flatten", "@", "\[CapitalDelta]g"}], "]"}], ",", 
                    "Red", ",", " ", "Purple"}], "]"}], ",", " ", 
                    RowBox[{"Disk", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "@", "\[CapitalDelta]g"}], ",", "r"}], 
                    "]"}]}], "}"}], ",", " ", "Green", ",", " ", 
                    RowBox[{"Disk", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "@", "nearest"}], ",", " ", "r"}], 
                    "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"hitIndex", ",", "Black", ",", 
                    RowBox[{"FontSize", "\[Rule]", "24"}], ",", 
                    RowBox[{"FontFamily", "\[Rule]", " ", "\"\<Times\>\""}]}],
                     "]"}], ",", 
                    RowBox[{"pe2", "-", "pe1", "-", 
                    RowBox[{"{", 
                    RowBox[{".1", ",", ".1"}], "}"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"current", " ", "deltas"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"Darker", "[", "Green", "]"}], ",", 
                    RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"ps2", "-", "ps1", "-", 
                    RowBox[{
                    RowBox[{"4", "/", "3"}], "r", " ", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}]}], ",", 
                    RowBox[{"ps2", "-", "ps1", "+", 
                    RowBox[{
                    RowBox[{"4", "/", "3"}], "r", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}]}]}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{
                    "StringForm", "[", "\"\<\[CapitalDelta]r\>\"", "]"}], ",", 
                    RowBox[{"FontSize", "\[Rule]", "24"}], ",", "Black", ",", 
                    
                    RowBox[{"FontFamily", "\[Rule]", " ", "\"\<Times\>\""}]}],
                     "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "ps2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{"ps1", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "+", " ", "0.1"}], ",", 
                    RowBox[{
                    RowBox[{
                    "ps2", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "ps1", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "+", "0.1"}]}], "}"}]}], 
                    "]"}]}], "}"}]}]}], "]"}]}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"1.2", ",", "0"}], "}"}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "0.55"}], ",", "1.75"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", ".55"}], ",", ".55"}], "}"}]}], "}"}]}]}], 
         "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", "\n", 
     "\[IndentingNewLine]", 
     RowBox[{"Row", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Control", "@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"progress", ",", "1", ",", "\"\<progress\>\""}], "}"}], 
           ",", "0", ",", "1", ",", 
           RowBox[{"1", "/", "420"}], ",", "Slider", ",", 
           RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"Control", "@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[Epsilon]", ",", 
             RowBox[{"1", "/", "1000"}], ",", "\"\<\[Epsilon]\>\""}], "}"}], 
           ",", 
           RowBox[{"1", "/", "1000"}], ",", 
           RowBox[{"1", "/", "5"}], ",", 
           RowBox[{"1", "/", "1000"}], ",", "Slider", ",", 
           RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}]}]}], 
       "}"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Control", "@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"hits", ",", "0", ",", "\"\<hits\>\""}], "}"}], ",", "0", 
        ",", "21", ",", "1", ",", "Slider", ",", 
        RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"s1", ",", 
         RowBox[{"{", 
          RowBox[{"0.0", ",", "0.0"}], "}"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}], ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "+", " ", "\[Epsilon]"}], 
       ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "/", "2"}], ",", 
          RowBox[{"1", "/", "2"}]}], "}"}], "-", " ", "\[Epsilon]"}], ",", 
       "Locator", ",", 
       RowBox[{"Appearance", "\[Rule]", "None"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"s2", ",", 
         RowBox[{"{", 
          RowBox[{"0.2", ",", "0.4"}], "}"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}], ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "+", " ", "\[Epsilon]"}], 
       ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "/", "2"}], ",", 
          RowBox[{"1", "/", "2"}]}], "}"}], "-", " ", "\[Epsilon]"}], ",", 
       "Locator", ",", 
       RowBox[{"Appearance", "\[Rule]", "None"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"col1", ",", 
         RowBox[{"{", 
          RowBox[{"0.2", ",", "0.4"}], "}"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}], ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "+", " ", "\[Epsilon]"}], 
       ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "/", "2"}], ",", 
          RowBox[{"1", "/", "2"}]}], "}"}], "-", " ", "\[Epsilon]"}], ",", 
       "Locator", ",", 
       RowBox[{"Appearance", "\[Rule]", "None"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"e1", ",", 
         RowBox[{"{", 
          RowBox[{"0.05", ",", "0.35"}], "}"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}], ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "+", " ", "\[Epsilon]"}], 
       ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "/", "2"}], ",", 
          RowBox[{"1", "/", "2"}]}], "}"}], "-", " ", "\[Epsilon]"}], ",", 
       "Locator", ",", 
       RowBox[{"Appearance", "\[Rule]", "None"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"e2", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "0.33"}], ",", "0.26"}], "}"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}], ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "+", " ", "\[Epsilon]"}], 
       ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "/", "2"}], ",", 
          RowBox[{"1", "/", "2"}]}], "}"}], "-", " ", "\[Epsilon]"}], ",", 
       "Locator", ",", 
       RowBox[{"Appearance", "\[Rule]", "None"}]}], "}"}], 
     "\[IndentingNewLine]", ",", " ", 
     RowBox[{"SaveDefinitions", "\[Rule]", "True"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.698944174559434*^9, 3.6989441907358837`*^9}, {
   3.6989442809717617`*^9, 3.698944496415599*^9}, {3.698944529929453*^9, 
   3.698944610721612*^9}, {3.698944686277822*^9, 3.69894470576884*^9}, {
   3.698945965814918*^9, 3.6989460271961937`*^9}, {3.698946074816063*^9, 
   3.6989462141926537`*^9}, {3.69894823049291*^9, 3.698948257996673*^9}, {
   3.698948325608406*^9, 3.6989483998813753`*^9}, {3.698948546314445*^9, 
   3.69894858861898*^9}, {3.698948720851254*^9, 3.698948728102981*^9}, {
   3.6989487925542192`*^9, 3.6989488512419024`*^9}, {3.6989488852436857`*^9, 
   3.69894891311932*^9}, {3.698949019044239*^9, 3.698949030932324*^9}, 
   3.698949062031089*^9, {3.698949414105178*^9, 3.6989494343921003`*^9}, {
   3.6989498900182867`*^9, 3.698949958655814*^9}, {3.698950013130381*^9, 
   3.6989500928271847`*^9}, {3.698950439067584*^9, 3.69895073621592*^9}, {
   3.698950787150281*^9, 3.698950863087556*^9}, {3.698950929849052*^9, 
   3.6989509874941273`*^9}, {3.698951045699718*^9, 3.698951125863633*^9}, {
   3.6989511625912437`*^9, 3.6989511691113663`*^9}, {3.698951223651932*^9, 
   3.6989514253896303`*^9}, {3.698951468720992*^9, 3.698951488231035*^9}, 
   3.6989515864429703`*^9, {3.698951832531808*^9, 3.698952002013851*^9}, {
   3.698952037780158*^9, 3.698952050082082*^9}, {3.698952417057447*^9, 
   3.698952570757739*^9}, {3.698952601003948*^9, 3.698952640813424*^9}, {
   3.698952671095797*^9, 3.698952673589806*^9}, {3.698952733253889*^9, 
   3.698952836616603*^9}, {3.698952923643304*^9, 3.698953038609028*^9}, {
   3.698953068629509*^9, 3.69895321465403*^9}, {3.6989533133203*^9, 
   3.698953338232934*^9}, {3.698953440277871*^9, 3.6989534804055634`*^9}, {
   3.69895353612074*^9, 3.698953543665351*^9}, {3.698953593938774*^9, 
   3.698953609634533*^9}, {3.6989537279335337`*^9, 3.698953812500412*^9}, {
   3.6989538622522373`*^9, 3.6989538839371357`*^9}, {3.698953947299528*^9, 
   3.698953947658996*^9}, {3.698954047205681*^9, 3.698954047361875*^9}, {
   3.698954142225285*^9, 3.698954176024609*^9}, {3.698954386780394*^9, 
   3.69895438727421*^9}, {3.698954606784835*^9, 3.6989549566920977`*^9}, {
   3.69895504131214*^9, 3.698955050287921*^9}, {3.698955095110283*^9, 
   3.698955124117581*^9}, {3.698955176878779*^9, 3.6989552221794157`*^9}, {
   3.698955253212556*^9, 3.6989552888424187`*^9}, {3.698955340277622*^9, 
   3.6989553886454153`*^9}, {3.698955420528508*^9, 3.698955430447402*^9}, {
   3.698955461354691*^9, 3.6989555594288282`*^9}, {3.698955594706032*^9, 
   3.6989556679872093`*^9}, {3.698955752846835*^9, 3.698955756087669*^9}, {
   3.698955807143999*^9, 3.69895580969608*^9}, {3.6989559213475924`*^9, 
   3.698955974171088*^9}, {3.6989560930281487`*^9, 3.69895609517171*^9}, {
   3.6989562191332293`*^9, 3.6989562217960873`*^9}, {3.698956287879776*^9, 
   3.698956333396223*^9}, {3.698970495596939*^9, 3.69897050136185*^9}, {
   3.699114915592531*^9, 3.6991149925358133`*^9}, {3.69911504380138*^9, 
   3.6991152621938457`*^9}, {3.699115325909927*^9, 3.699115381379539*^9}, {
   3.699115424925087*^9, 3.699115455630239*^9}, {3.6991154915678577`*^9, 
   3.699115588569085*^9}, {3.699115699634282*^9, 3.6991157037120867`*^9}, {
   3.699115764817103*^9, 3.699115765829226*^9}, {3.699115828491849*^9, 
   3.6991158437847967`*^9}, {3.6991158795725193`*^9, 3.699115913356966*^9}, {
   3.699115966495035*^9, 3.699116014154049*^9}, {3.699116068186981*^9, 
   3.69911608117867*^9}, {3.699116191247075*^9, 3.699116456549986*^9}, {
   3.6991164879153233`*^9, 3.6991164902651463`*^9}, {3.699116524055457*^9, 
   3.6991165647476463`*^9}, {3.699116595916317*^9, 3.699116615531323*^9}, {
   3.699116656996221*^9, 3.699116764861665*^9}, {3.699116817303952*^9, 
   3.699116838364173*^9}, {3.6991169303058653`*^9, 3.699117054142318*^9}, {
   3.699117375567142*^9, 3.699117456508601*^9}, {3.699118106829368*^9, 
   3.699118111445084*^9}, {3.699628732418992*^9, 3.699628755197493*^9}, {
   3.699628799247253*^9, 3.6996288129645443`*^9}, {3.6996289564312763`*^9, 
   3.6996289866558523`*^9}, {3.699629075647243*^9, 3.699629096323113*^9}, {
   3.699629129524568*^9, 3.699629203092348*^9}, {3.6996292418106413`*^9, 
   3.6996294752449408`*^9}, {3.699629542455394*^9, 3.699629560832448*^9}, {
   3.699629631531713*^9, 3.69962967397091*^9}, {3.699629707156686*^9, 
   3.699629743987363*^9}, {3.699629842901697*^9, 3.6996298773268013`*^9}, 
   3.699629921813963*^9, 3.699706049605403*^9, 3.699726696865468*^9, 
   3.6997268799383907`*^9, {3.699726913475586*^9, 3.6997269785776854`*^9}, {
   3.69972702811528*^9, 3.69972707326733*^9}, {3.6997876164573298`*^9, 
   3.699787641386263*^9}, {3.699787808410965*^9, 3.699787875849979*^9}, 
   3.700817382737306*^9, {3.7008174251192627`*^9, 3.700817462857253*^9}, {
   3.700817516884343*^9, 3.7008176627876062`*^9}, {3.700817746520689*^9, 
   3.7008177606207037`*^9}, {3.700817936376403*^9, 3.700817960850574*^9}, {
   3.700817991932789*^9, 3.700817996572372*^9}, {3.700825387569471*^9, 
   3.700825447044921*^9}, {3.7008289477553368`*^9, 3.7008290078240423`*^9}, {
   3.700829038937896*^9, 3.700829042871684*^9}, {3.700829086571094*^9, 
   3.700829112701723*^9}, {3.7008294507070932`*^9, 3.7008294618431396`*^9}, {
   3.7008295926463223`*^9, 3.700829630429097*^9}, {3.700829662286859*^9, 
   3.70082967603006*^9}, {3.70083612821001*^9, 3.700836154033156*^9}, 
   3.700836197029335*^9, {3.700844693051549*^9, 3.700844702925128*^9}, {
   3.701091452525364*^9, 3.701091522412004*^9}, {3.701091565519989*^9, 
   3.701091573505559*^9}, {3.701091609995368*^9, 3.7010916186861467`*^9}, {
   3.701094293684786*^9, 3.701094348309719*^9}, {3.7010945047768393`*^9, 
   3.701094596905943*^9}, {3.7010946719437017`*^9, 3.70109483433547*^9}, {
   3.701095049517899*^9, 3.7010950684055*^9}, {3.714750929548376*^9, 
   3.7147509357432756`*^9}, {3.7147510069863987`*^9, 3.714751060843659*^9}, {
   3.715374308689711*^9, 3.71537431800965*^9}, {3.7153743511892643`*^9, 
   3.7153743949734507`*^9}, {3.7153744596501827`*^9, 3.715374502161789*^9}, {
   3.715374561383057*^9, 3.7153746318858147`*^9}, {3.71537466715377*^9, 
   3.715374689817922*^9}, {3.715374782918276*^9, 3.715374803383377*^9}, 
   3.71537500524821*^9, {3.7171698130955963`*^9, 3.717169834126439*^9}, {
   3.71716995245986*^9, 3.717169970990191*^9}, {3.717170422949587*^9, 
   3.717170444240191*^9}, {3.717170474571537*^9, 3.7171705472781677`*^9}, {
   3.717170611068248*^9, 3.717170686882209*^9}, {3.7171707361081038`*^9, 
   3.717170766437142*^9}, 3.717170864385519*^9, {3.7171709194889307`*^9, 
   3.717170934481505*^9}, {3.71717097574905*^9, 3.717170981788973*^9}, {
   3.717171026805295*^9, 3.71717103742616*^9}, {3.717171097058766*^9, 
   3.717171131978606*^9}, {3.7171711900534678`*^9, 3.717171196171118*^9}, {
   3.717171229484173*^9, 3.717171257809224*^9}, {3.7171712896037903`*^9, 
   3.7171713436607637`*^9}, {3.717171376511806*^9, 3.717171378046783*^9}, {
   3.71717144958908*^9, 3.717171481153287*^9}, {3.717172014062426*^9, 
   3.717172019688767*^9}, {3.71717227187351*^9, 3.717172277179582*^9}, {
   3.717173075084057*^9, 3.7171730885021763`*^9}, {3.7171731191601686`*^9, 
   3.717173174922722*^9}, {3.717173247166503*^9, 3.717173301375719*^9}, {
   3.717173333344677*^9, 3.717173413362414*^9}, {3.717173467027319*^9, 
   3.71717349356166*^9}, {3.7171736028952293`*^9, 3.717173645016449*^9}, {
   3.7171737007220383`*^9, 3.717173714953978*^9}, {3.717173745327804*^9, 
   3.717173749047737*^9}, {3.717173917596365*^9, 3.7171740008393497`*^9}, {
   3.7171740379065332`*^9, 3.717174058800684*^9}, {3.717174105851313*^9, 
   3.717174106534182*^9}, {3.717174232103774*^9, 3.717174246656299*^9}, {
   3.7171742876712427`*^9, 3.717174300577607*^9}, {3.717174341336091*^9, 
   3.717174411123617*^9}, {3.717174649307929*^9, 3.7171746758165827`*^9}, 
   3.7171747078857803`*^9, {3.717174747319161*^9, 3.717174837639206*^9}, {
   3.717174879850542*^9, 3.717174935991197*^9}, {3.717175050303553*^9, 
   3.717175074151037*^9}, {3.717238797765175*^9, 3.717238947239689*^9}, {
   3.717239058297627*^9, 3.717239062204144*^9}, {3.717239105677804*^9, 
   3.7172392040143023`*^9}, {3.7172392503603153`*^9, 
   3.7172392971720533`*^9}, {3.717239332191513*^9, 3.717239334648862*^9}, {
   3.717239618437024*^9, 3.717239802363914*^9}, 3.717239910474491*^9, {
   3.7172399650931377`*^9, 3.71724008278509*^9}, 3.717240114450899*^9, {
   3.717240154071919*^9, 3.717240242989717*^9}, {3.717240274275433*^9, 
   3.7172402920666437`*^9}, {3.7172403379430304`*^9, 
   3.7172403386085987`*^9}, {3.717240428220214*^9, 3.717240439608753*^9}, {
   3.717240471497954*^9, 3.717240535181827*^9}, {3.717240569230569*^9, 
   3.717240572643458*^9}, {3.7172406083179703`*^9, 3.7172406779993887`*^9}, {
   3.717240725714561*^9, 3.717240732053282*^9}, {3.717240838380468*^9, 
   3.717240887601801*^9}, {3.7172409651724157`*^9, 3.7172410838903923`*^9}, {
   3.717241215936*^9, 3.717241292024556*^9}, {3.717241490972537*^9, 
   3.717241541474883*^9}, {3.717241581382407*^9, 3.7172415848908443`*^9}, {
   3.71724164247084*^9, 3.717241678654859*^9}, {3.717241708731358*^9, 
   3.7172418464603767`*^9}, 3.717241962917816*^9, {3.717241993162552*^9, 
   3.717241995961694*^9}, {3.717242044415387*^9, 3.717242052761702*^9}, 
   3.7172421683595448`*^9, {3.717242316574232*^9, 3.717242363238467*^9}, {
   3.717242408224442*^9, 3.717242410342473*^9}, {3.7172424561147757`*^9, 
   3.7172424802664337`*^9}, {3.717242551157589*^9, 3.717242568010674*^9}, {
   3.717242651353999*^9, 3.717242692731945*^9}, {3.717242747067374*^9, 
   3.71724277185365*^9}, {3.717242821410803*^9, 3.7172428456444483`*^9}, {
   3.717242986195076*^9, 3.717242990398892*^9}, {3.717243337280611*^9, 
   3.717243391595819*^9}, {3.717243618576165*^9, 3.7172436314961843`*^9}, {
   3.717243740800523*^9, 3.717243802110312*^9}, {3.7172438769674997`*^9, 
   3.717243877777134*^9}, {3.717243990937351*^9, 3.717244023602972*^9}, {
   3.717244477368367*^9, 3.7172444993328943`*^9}, {3.71775919666953*^9, 
   3.717759197599621*^9}, {3.717759250966998*^9, 3.71775925182127*^9}, 
   3.717772735585865*^9, {3.717772802359743*^9, 3.7177728665586777`*^9}, {
   3.7177729276019497`*^9, 3.717772979872128*^9}, {3.717773281781322*^9, 
   3.717773290110587*^9}, 3.717776599488337*^9, 3.7177766389865713`*^9, 
   3.717776683746913*^9, 3.71777671608035*^9, {3.7177770016686153`*^9, 
   3.7177770047769203`*^9}, {3.7177770651516237`*^9, 
   3.7177770737967463`*^9}, {3.717777275539356*^9, 3.7177772786923122`*^9}, {
   3.71777878802756*^9, 3.71777878833881*^9}, {3.717781997430002*^9, 
   3.7177820540388947`*^9}, {3.7177820945332937`*^9, 
   3.7177821174881353`*^9}, {3.717782173178059*^9, 3.7177822763129053`*^9}, 
   3.7177823812982903`*^9, {3.717782490218994*^9, 3.717782511436152*^9}, {
   3.717782578594302*^9, 3.717782599495734*^9}, {3.717782640781269*^9, 
   3.717782694049489*^9}, {3.717782863286845*^9, 3.717782936298118*^9}, 
   3.71778299361508*^9, {3.717783073823558*^9, 3.717783115093583*^9}, {
   3.717783233748042*^9, 3.71778323530718*^9}, {3.7177832749097023`*^9, 
   3.717783417152197*^9}, {3.717783962731311*^9, 3.717784060063703*^9}, {
   3.717784090474104*^9, 3.717784100960215*^9}, {3.717784135432291*^9, 
   3.717784168822606*^9}, {3.717834847177713*^9, 3.717834985134857*^9}, {
   3.7178351411570997`*^9, 3.717835150327791*^9}, {3.7178352368959084`*^9, 
   3.717835313023653*^9}, 3.718030417916959*^9, 3.718398763963492*^9, 
   3.718398815038025*^9, {3.71839884996979*^9, 3.7183988950496483`*^9}, 
   3.718398971214508*^9, 3.718399045190263*^9, {3.718399087931655*^9, 
   3.718399154011565*^9}, 3.718399552006385*^9, {3.718399958429922*^9, 
   3.718399995263526*^9}, 3.71865726322686*^9, {3.7186573289880867`*^9, 
   3.71865734211012*^9}, {3.718657430334571*^9, 3.718657461168915*^9}, {
   3.7186578787239437`*^9, 
   3.718657879878365*^9}},ExpressionUUID->"23e33bca-9fb5-45a3-9b79-\
e10dcfa556d1"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`col1$$ = {0.22360679774997894`, 
    0.44721359549995787`}, $CellContext`e1$$ = {-0.312, -0.35}, \
$CellContext`e2$$ = {-0.3315, 0.30200000000000005`}, $CellContext`hits$$ = 
    0, $CellContext`progress$$ = 1, $CellContext`s1$$ = {0., 
    0.}, $CellContext`s2$$ = {0.2, 0.4}, $CellContext`\[Epsilon]$$ = Rational[
    1, 1000], Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`progress$$], 1, "progress"}, 0, 1, 
      Rational[1, 420]}, {{
       Hold[$CellContext`\[Epsilon]$$], 
       Rational[1, 1000], "\[Epsilon]"}, 
      Rational[1, 1000], 
      Rational[1, 5], 
      Rational[1, 1000]}, {
      Hold[
       Row[{
         Manipulate`Place[1], 
         Manipulate`Place[2]}]], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`hits$$], 0, "hits"}, 0, 21, 1}, {{
       Hold[$CellContext`s1$$], {0., 0.}}, 
      Dynamic[{(-1)/2, (-1)/2} + $CellContext`\[Epsilon]$$], 
      Dynamic[{1/2, 1/2} - $CellContext`\[Epsilon]$$]}, {{
       Hold[$CellContext`s2$$], {0.2, 0.4}}, 
      Dynamic[{(-1)/2, (-1)/2} + $CellContext`\[Epsilon]$$], 
      Dynamic[{1/2, 1/2} - $CellContext`\[Epsilon]$$]}, {{
       Hold[$CellContext`col1$$], {0.2, 0.4}}, 
      Dynamic[{(-1)/2, (-1)/2} + $CellContext`\[Epsilon]$$], 
      Dynamic[{1/2, 1/2} - $CellContext`\[Epsilon]$$]}, {{
       Hold[$CellContext`e1$$], {0.05, 0.35}}, 
      Dynamic[{(-1)/2, (-1)/2} + $CellContext`\[Epsilon]$$], 
      Dynamic[{1/2, 1/2} - $CellContext`\[Epsilon]$$]}, {{
       Hold[$CellContext`e2$$], {-0.33, 0.26}}, 
      Dynamic[{(-1)/2, (-1)/2} + $CellContext`\[Epsilon]$$], 
      Dynamic[{1/2, 1/2} - $CellContext`\[Epsilon]$$]}}, Typeset`size$$ = {
    800., {189., 194.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = False, $CellContext`progress$66178$$ = 
    0, $CellContext`\[Epsilon]$66179$$ = 0, $CellContext`hits$66180$$ = 
    0, $CellContext`s1$66181$$ = 0, $CellContext`s2$66182$$ = 
    0, $CellContext`col1$66183$$ = 0, $CellContext`e1$66184$$ = 
    0, $CellContext`e2$66185$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`col1$$ = {0.2, 0.4}, $CellContext`e1$$ = {
         0.05, 0.35}, $CellContext`e2$$ = {-0.33, 0.26}, $CellContext`hits$$ = 
        0, $CellContext`progress$$ = 
        1, $CellContext`s1$$ = {0., 0.}, $CellContext`s2$$ = {0.2, 
         0.4}, $CellContext`\[Epsilon]$$ = Rational[1, 1000]}, 
      "ControllerVariables" :> {
        Hold[$CellContext`progress$$, $CellContext`progress$66178$$, 0], 
        Hold[$CellContext`\[Epsilon]$$, $CellContext`\[Epsilon]$66179$$, 0], 
        Hold[$CellContext`hits$$, $CellContext`hits$66180$$, 0], 
        Hold[$CellContext`s1$$, $CellContext`s1$66181$$, 0], 
        Hold[$CellContext`s2$$, $CellContext`s2$66182$$, 0], 
        Hold[$CellContext`col1$$, $CellContext`col1$66183$$, 0], 
        Hold[$CellContext`e1$$, $CellContext`e1$66184$$, 0], 
        Hold[$CellContext`e2$$, $CellContext`e2$66185$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`thickness$ = 
         0.005, $CellContext`d$, $CellContext`\[Theta]$, \
$CellContext`\[Alpha]$, $CellContext`r$ = 
         1/40, $CellContext`pr$, $CellContext`\[Gamma]$, \
$CellContext`\[Psi]$, $CellContext`ps1$, $CellContext`pe1$, \
$CellContext`ps2$, $CellContext`pe2$, $CellContext`pcol1$, $CellContext`\
\[CapitalDelta]g$, $CellContext`c1$ = Blue, $CellContext`c2$ = 
         Magenta}, $CellContext`s1$$ = \
$CellContext`clipCircle[$CellContext`s1$$, $CellContext`\[Epsilon]$$]; \
$CellContext`e1$$ = $CellContext`clipCircle[$CellContext`e1$$, $CellContext`\
\[Epsilon]$$]; $CellContext`s2$$ = $CellContext`clipCircle[$CellContext`s2$$, \
$CellContext`\[Epsilon]$$]; $CellContext`e2$$ = \
$CellContext`clipCircle[$CellContext`e2$$, $CellContext`\[Epsilon]$$]; \
$CellContext`\[CapitalDelta]g$ = {$CellContext`pe2$ - $CellContext`pe1$}; \
{$CellContext`ps1$, $CellContext`pe1$, $CellContext`ps2$, $CellContext`pe2$} = \
{$CellContext`s1$$, $CellContext`e1$$, $CellContext`s2$$, $CellContext`e2$$}; 
        If[Norm[$CellContext`col1$$] != 
          1/2, $CellContext`col1$$ = $CellContext`col1$$/(2 
           Norm[$CellContext`col1$$])]; {$CellContext`ps1$, \
$CellContext`ps2$, $CellContext`pcol1$} = {$CellContext`s1$$, \
$CellContext`s2$$, $CellContext`col1$$}; $CellContext`d$ = 
         Norm[$CellContext`ps1$ - $CellContext`ps2$]; $CellContext`\[Theta]$ = 
         ArcTan[Part[$CellContext`ps1$, 1] - Part[$CellContext`ps2$, 1], 
           Part[$CellContext`ps1$, 2] - 
           Part[$CellContext`ps2$, 2]]; $CellContext`\[Alpha]$ = 
         2 ArcSin[$CellContext`d$]; $CellContext`\[Psi]$ = ArcTan[
           Part[$CellContext`col1$$, 1], 
           Part[$CellContext`col1$$, 2]]; $CellContext`pr$ = 
         2 Abs[Dot[$CellContext`ps1$, $CellContext`col1$$] - 
            Dot[$CellContext`ps2$, $CellContext`col1$$]]; $CellContext`\
\[Gamma]$ = ArcCos[(1/2 - $CellContext`pr$)/(1/2)]; Graphics[{{
            Darker[Red], 
            Disk[{0, 0}, 1.025/2]}, {
            Lighter[Gray, 0.8], 
            Disk[{0, 0}, 1/2]}, {White, 
            Disk[{0, 0}, 1/2 - $CellContext`\[Epsilon]$$]}, {
            Lighter[Gray, 0.8], 
            Disk[$CellContext`ps2$, $CellContext`\[Epsilon]$$]}, 
           PointSize[0.01], 
           Arrowheads[0.03], {
            Thickness[3 $CellContext`thickness$], $CellContext`c2$, 
            
            Circle[{0, 0}, 1/
             2, {$CellContext`\[Theta]$ + $CellContext`\[Alpha]$/2 + 
              Pi/2, $CellContext`\[Theta]$ - $CellContext`\[Alpha]$/2 - Pi/2 + 
              2 Pi}]}, {
            Thickness[3 $CellContext`thickness$], $CellContext`c1$, 
            
            Circle[{0, 0}, 1/
             2, {$CellContext`\[Theta]$ - $CellContext`\[Alpha]$/2 + 
              Pi/2, $CellContext`\[Theta]$ + $CellContext`\[Alpha]$/2 - Pi/
              2}]}, {
            
            Module[{$CellContext`\[Psi]a$, $CellContext`pra$, $CellContext`\
\[Gamma]a$, $CellContext`cola$}, 
             
             Table[$CellContext`\[Psi]a$ = $CellContext`\[Theta]$ + \
$CellContext`\[Alpha]$/2 + 
                Pi/2 + $CellContext`c ((Pi - $CellContext`\[Alpha]$)/
                  20); $CellContext`cola$ = (1/2) {
                  Cos[$CellContext`\[Psi]a$], 
                  Sin[$CellContext`\[Psi]a$]}; $CellContext`pra$ = 
               2 Abs[Dot[$CellContext`ps1$, $CellContext`cola$] - 
                  Dot[$CellContext`ps2$, $CellContext`cola$]]; $CellContext`\
\[Gamma]a$ = ArcCos[(1/2 - $CellContext`pra$)/(1/2)]; {
                Hue[$CellContext`\[Psi]a$/(2 Pi)], 
                Point[$CellContext`cola$], {
                 Opacity[0.05], 
                 Polygon[
                  Table[(1/2) {
                    Cos[$CellContext`a], 
                    
                    Sin[$CellContext`a]}, {$CellContext`a, \
$CellContext`\[Psi]a$ - $CellContext`\[Gamma]a$, $CellContext`\[Psi]a$ + \
$CellContext`\[Gamma]a$, $CellContext`\[Gamma]a$/20}]]}, 
                Null}, {$CellContext`c, 0, $CellContext`hits$$}]]}, {
            
            Module[{$CellContext`\[Psi]a$, $CellContext`pra$, $CellContext`\
\[Gamma]a$, $CellContext`cola$, $CellContext`c$}, 
             
             Table[$CellContext`\[Psi]a$ = $CellContext`\[Theta]$ + \
$CellContext`\[Alpha]$/2 - Pi/
                2 + $CellContext`c$ ((Pi - $CellContext`\[Alpha]$)/
                  20); $CellContext`cola$ = (1/2) {
                  Cos[$CellContext`\[Psi]a$], 
                  Sin[$CellContext`\[Psi]a$]}; $CellContext`pra$ = 
               2 Abs[Dot[$CellContext`ps1$, $CellContext`cola$] - 
                  
                  Dot[$CellContext`ps2$, $CellContext`cola$]]; $CellContext`\
\[Gamma]a$ = ArcCos[(1/2 - $CellContext`pra$)/(1/2)]; {
                Hue[$CellContext`\[Psi]a$/(2 Pi)], 
                Point[$CellContext`cola$], {
                 Opacity[0.05], 
                 EdgeForm[
                  Directive[
                   Hue[$CellContext`\[Psi]a$/(2 Pi)]]], 
                 Polygon[
                  Table[(1/2) {
                    Cos[$CellContext`a], 
                    
                    Sin[$CellContext`a]}, {$CellContext`a, \
$CellContext`\[Psi]a$ - $CellContext`\[Gamma]a$, $CellContext`\[Psi]a$ + \
$CellContext`\[Gamma]a$, $CellContext`\[Gamma]a$/20}]]}, 
                Null}, {$CellContext`c$, 
               0, $CellContext`hits$$}]]}, {$CellContext`c1$, 
            Thickness[$CellContext`thickness$], {
             Opacity[0.3], Dashed, 
             Arrow[{$CellContext`ps1$, $CellContext`pe1$}]}, 
            Point[$CellContext`ps1$], 
            EdgeForm[
             Directive[$CellContext`c1$, 
              Thickness[$CellContext`thickness$]]], 
            FaceForm[None], 
            
            Rectangle[$CellContext`ps1$ - (2/3) $CellContext`r$ {1, 
              1}, $CellContext`ps1$ + (2/3) $CellContext`r$ {1, 1}], 
            Circle[$CellContext`pe1$, $CellContext`r$]}, {$CellContext`c2$, 
            Thickness[$CellContext`thickness$], {
             Opacity[0.3], Dashed, 
             Arrow[{$CellContext`ps2$, $CellContext`pe2$}]}, 
            Point[$CellContext`ps2$], 
            EdgeForm[
             Directive[$CellContext`c2$, 
              Thickness[$CellContext`thickness$]]], 
            FaceForm[None], 
            
            Rectangle[$CellContext`ps2$ - (2/3) $CellContext`r$ {1, 
              1}, $CellContext`ps2$ + (2/3) $CellContext`r$ {1, 1}], 
            Circle[$CellContext`pe2$, $CellContext`r$]}, 
           Inset[
            
            Module[{$CellContext`\[Psi]a$, $CellContext`pra$, $CellContext`\
\[Gamma]a$, $CellContext`cola$, $CellContext`\[Gamma]a2$, \
$CellContext`polyline1$, $CellContext`polyline2$, $CellContext`polyline3$, \
$CellContext`polyline4$, $CellContext`hitIndex$, $CellContext`regionlist$, \
$CellContext`finalpoly$, $CellContext`line$, $CellContext`sol$, \
$CellContext`x$, $CellContext`y$, $CellContext`line2$}, $CellContext`cola$ = (
                1/2) {
                 Cos[$CellContext`\[Psi]a$], 
                 Sin[$CellContext`\[Psi]a$]}; $CellContext`pra$ = 
              2 Abs[Dot[$CellContext`ps1$, $CellContext`cola$] - 
                 Dot[$CellContext`ps2$, $CellContext`cola$]]; $CellContext`\
\[Gamma]a$ = ArcCos[(1/2 - $CellContext`pra$)/(1/2)]; 
             ParametricPlot[{$CellContext`cola$ - (1/2) {
                  Cos[$CellContext`a], 
                  
                  Sin[$CellContext`a]}}, {$CellContext`\[Psi]a$, \
$CellContext`\[Theta]$ + $CellContext`\[Alpha]$/2 + 
                Pi/2, $CellContext`\[Theta]$ - $CellContext`\[Alpha]$/
                2 + (3/2) 
                 Pi}, {$CellContext`a, $CellContext`\[Psi]a$ - $CellContext`\
\[Gamma]a$, $CellContext`\[Psi]a$ + $CellContext`\[Gamma]a$}, 
               PlotRange -> {{-1, 1}, {-1, 1}}, 
               FrameLabel -> {"\[CapitalDelta]x", "\[CapitalDelta] y"}, 
               LabelStyle -> Directive[Black, Bold, Large], ImageSize -> 400, 
               Epilog -> {
                 
                 Circle[{0, 0}, 1 - 
                  2 $CellContext`\[Epsilon]$$], $CellContext`\[Gamma]a2$ = 
                  ReplaceAll[
                    
                    ArcCos[(1/2 - $CellContext`pra$)/(1/
                    2)], {$CellContext`\[Psi]a$ -> $CellContext`\[Theta]$ + \
$CellContext`\[Alpha]$/2 + Pi/2}]; Thick, 
                 
                 Text[$CellContext`\[Gamma]a2$, {0, 
                  0}], $CellContext`polyline1$ = Table[(1/2) {
                    
                    Cos[$CellContext`\[Theta]$ + $CellContext`\[Alpha]$/2 + 
                    Pi/2], 
                    
                    Sin[$CellContext`\[Theta]$ + $CellContext`\[Alpha]$/2 + 
                    Pi/2]} - (1/2) {
                    
                    Cos[$CellContext`a2 + $CellContext`\[Theta]$ + \
$CellContext`\[Alpha]$/2 + Pi/2], 
                    
                    Sin[$CellContext`a2 + $CellContext`\[Theta]$ + \
$CellContext`\[Alpha]$/2 + Pi/2]}, {$CellContext`a2, 0, 
                    Plus[$CellContext`\[Gamma]a2$], $CellContext`\[Gamma]a2$/
                    5}]; $CellContext`\[Gamma]a2$ = ReplaceAll[
                    
                    ArcCos[(1/2 - $CellContext`pra$)/(1/
                    2)], {$CellContext`\[Psi]a$ -> $CellContext`\[Theta]$ - \
$CellContext`\[Alpha]$/2 + 3 (Pi/2)}]; Thick, 
                 
                 Text[$CellContext`\[Gamma]a2$, {0, 
                  0}], $CellContext`polyline2$ = Table[(1/2) {
                    
                    Cos[$CellContext`\[Theta]$ - $CellContext`\[Alpha]$/2 + 
                    3 (Pi/2)], 
                    
                    Sin[$CellContext`\[Theta]$ - $CellContext`\[Alpha]$/2 + 
                    3 (Pi/2)]} - (1/2) {
                    
                    Cos[$CellContext`a2 + $CellContext`\[Theta]$ - \
$CellContext`\[Alpha]$/2 + 3 (Pi/2)], 
                    
                    Sin[$CellContext`a2 + $CellContext`\[Theta]$ - \
$CellContext`\[Alpha]$/2 + 
                    3 (Pi/2)]}, {$CellContext`a2, -$CellContext`\[Gamma]a2$, 
                    0, $CellContext`\[Gamma]a2$/5}]; $CellContext`polyline3$ = 
                  Table[(1/2) {
                    Cos[$CellContext`\[Psi]a$], 
                    Sin[$CellContext`\[Psi]a$]} - (1/2) {
                    Cos[$CellContext`\[Psi]a$ - $CellContext`\[Gamma]a$], 
                    
                    Sin[$CellContext`\[Psi]a$ - $CellContext`\[Gamma]a$]}, \
{$CellContext`\[Psi]a$, $CellContext`\[Theta]$ + $CellContext`\[Alpha]$/2 + 
                    Pi/2, $CellContext`\[Theta]$ - $CellContext`\[Alpha]$/
                    2 + (3/2) Pi, (Pi - $CellContext`\[Alpha]$)/
                    20}]; $CellContext`polyline4$ = Table[(1/2) {
                    Cos[$CellContext`\[Psi]a$], 
                    Sin[$CellContext`\[Psi]a$]} - (1/2) {
                    Cos[$CellContext`\[Psi]a$ + $CellContext`\[Gamma]a$], 
                    
                    Sin[$CellContext`\[Psi]a$ + $CellContext`\[Gamma]a$]}, \
{$CellContext`\[Psi]a$, $CellContext`\[Theta]$ + $CellContext`\[Alpha]$/2 + 
                    Pi/2, $CellContext`\[Theta]$ - $CellContext`\[Alpha]$/
                    2 + (3/2) Pi, (Pi - $CellContext`\[Alpha]$)/
                    20}]; $CellContext`finalpoly$ = 
                  
                  Join[$CellContext`polyline2$, $CellContext`polyline1$, \
$CellContext`polyline4$, $CellContext`polyline3$]; $CellContext`reg = 
                  Polygon[$CellContext`finalpoly$]; $CellContext`inReg = 
                  RegionMember[$CellContext`reg]; $CellContext`nearest = 
                  RegionNearest[$CellContext`reg, \
$CellContext`\[CapitalDelta]g$]; $CellContext`hitIndex$ = \
$CellContext`findHitPoint2[$CellContext`\[Alpha]$, $CellContext`\[Theta]$, \
$CellContext`ps1$, $CellContext`ps2$, 100, 
                    Flatten[$CellContext`nearest]]; 
                 If[$CellContext`hitIndex$ != -1, $CellContext`regionlist$ = \
$CellContext`makeRegionList[$CellContext`\[Alpha]$, $CellContext`\[Theta]$, \
$CellContext`ps1$, $CellContext`ps2$, $CellContext`hitIndex$, 100]; 
                   Null, $CellContext`regionlist$ = \
$CellContext`makeRegionList[$CellContext`\[Alpha]$, $CellContext`\[Theta]$, \
$CellContext`ps1$, $CellContext`ps2$, 1, 100]; Null]; Blue, 
                 EdgeForm[{Red, Thick}], $CellContext`reg, Green, 
                 PointSize[0.05], $CellContext`intersect, Pink, 
                 Line[$CellContext`polyline1$], Black, 
                 Line[$CellContext`polyline2$], Green, 
                 Line[$CellContext`polyline3$], Brown, 
                 Line[$CellContext`polyline4$], {Red, 
                  Opacity[0.1], 
                  EdgeForm[
                   Directive[Red]], $CellContext`regionlist$}, {
                  If[
                   $CellContext`inReg[
                    Flatten[$CellContext`\[CapitalDelta]g$]], Red, Purple], 
                  Disk[
                   Flatten[$CellContext`\[CapitalDelta]g$], $CellContext`r$]},
                  Green, 
                 Disk[
                  Flatten[$CellContext`nearest], $CellContext`r$], 
                 Text[
                  
                  Style[$CellContext`hitIndex$, Black, FontSize -> 24, 
                   FontFamily -> 
                   "Times"], $CellContext`pe2$ - $CellContext`pe1$ - {0.1, 
                  0.1}], 
                 Darker[Green], 
                 
                 Rectangle[$CellContext`ps2$ - $CellContext`ps1$ - (4/
                   3) $CellContext`r$ {1, 
                   1}, $CellContext`ps2$ - $CellContext`ps1$ + (4/
                    3) $CellContext`r$ {1, 1}], 
                 Text[
                  Style[
                   StringForm["\[CapitalDelta]r"], FontSize -> 24, Black, 
                   FontFamily -> "Times"], {
                  Part[$CellContext`ps2$, 1] - Part[$CellContext`ps1$, 1] + 
                   0.1, Part[$CellContext`ps2$, 2] - 
                   Part[$CellContext`ps1$, 2] + 0.1}]}]], {1.2, 0}]}, 
          ImageSize -> 800, PlotRange -> {{-0.55, 1.75}, {-0.55, 0.55}}]], 
      "Specifications" :> {{{$CellContext`progress$$, 1, "progress"}, 0, 1, 
         Rational[1, 420], ControlType -> Slider, Appearance -> "Labeled", 
         ControlPlacement -> 1}, {{$CellContext`\[Epsilon]$$, 
          Rational[1, 1000], "\[Epsilon]"}, 
         Rational[1, 1000], 
         Rational[1, 5], 
         Rational[1, 1000], ControlType -> Slider, Appearance -> "Labeled", 
         ControlPlacement -> 2}, 
        Row[{
          Manipulate`Place[1], 
          Manipulate`Place[2]}], {{$CellContext`hits$$, 0, "hits"}, 0, 21, 1, 
         ControlType -> Slider, Appearance -> 
         "Labeled"}, {{$CellContext`s1$$, {0., 0.}}, 
         Dynamic[{(-1)/2, (-1)/2} + $CellContext`\[Epsilon]$$], 
         Dynamic[{1/2, 1/2} - $CellContext`\[Epsilon]$$], ControlType -> 
         Locator, Appearance -> None}, {{$CellContext`s2$$, {0.2, 0.4}}, 
         Dynamic[{(-1)/2, (-1)/2} + $CellContext`\[Epsilon]$$], 
         Dynamic[{1/2, 1/2} - $CellContext`\[Epsilon]$$], ControlType -> 
         Locator, Appearance -> None}, {{$CellContext`col1$$, {0.2, 0.4}}, 
         Dynamic[{(-1)/2, (-1)/2} + $CellContext`\[Epsilon]$$], 
         Dynamic[{1/2, 1/2} - $CellContext`\[Epsilon]$$], ControlType -> 
         Locator, Appearance -> None}, {{$CellContext`e1$$, {0.05, 0.35}}, 
         Dynamic[{(-1)/2, (-1)/2} + $CellContext`\[Epsilon]$$], 
         Dynamic[{1/2, 1/2} - $CellContext`\[Epsilon]$$], ControlType -> 
         Locator, Appearance -> None}, {{$CellContext`e2$$, {-0.33, 0.26}}, 
         Dynamic[{(-1)/2, (-1)/2} + $CellContext`\[Epsilon]$$], 
         Dynamic[{1/2, 1/2} - $CellContext`\[Epsilon]$$], ControlType -> 
         Locator, Appearance -> None}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{851., {252., 258.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`d[1] = 1, $CellContext`d[2] = 
       1, $CellContext`d[3] = 0.5, $CellContext`d[4] = 1/2, $CellContext`d[5] = 
       4, $CellContext`d[6] = 2/3, $CellContext`r = 
       1/40, $CellContext`\[Gamma][{
          Pattern[$CellContext`a, 
           Blank[]], 
          Pattern[$CellContext`b, 
           Blank[]]}][
         Pattern[$CellContext`p, 
          Blank[]]] := 
       Dot[$CellContext`a - $CellContext`p, $CellContext`a - $CellContext`b]/
        Dot[$CellContext`a - $CellContext`b, $CellContext`a - \
$CellContext`b], $CellContext`a[1] = 0, $CellContext`a[2] = 
       0, $CellContext`a[3] = 0, $CellContext`a[4] = 0, $CellContext`a[5] = 
       0, $CellContext`a[6] = 
       0, $CellContext`p = {1, 2}, $CellContext`clipCircle[
         Pattern[$CellContext`p, 
          Blank[]], 
         Pattern[$CellContext`\[Epsilon], 
          Blank[]]] := 
       If[Norm[$CellContext`p] > 
         1/2 - $CellContext`\[Epsilon], (
          1/2 - $CellContext`\[Epsilon]) ($CellContext`p/
          Norm[$CellContext`p]), $CellContext`p], $CellContext`\[Epsilon]$$ = 
       1/1000, $CellContext`\[Psi]a = 0, $CellContext`\[Gamma]a = 
       Pi/4, $CellContext`c = 1, $CellContext`\[Gamma]a2 = {
         ArcCos[
         2 (1/2 - 2 Abs[0.05 $CellContext`ps1 - 0.05 $CellContext`ps2])], 
         0.}, $CellContext`regionlist = Polygon[CompressedData["
1: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
/9NB+A+V2qoB
         "]], 
       Attributes[PlotRange] = {ReadProtected}, $CellContext`reg = 
       Polygon[CompressedData["
1:eJyFk1lMUwkYhStWlLgMLjE6owJRYkWMxAYVRX+UEaMilgJWTVUkFTcClZRa
tUJLojLCUDUuLAoYqUGxCqUubP60QOuCKUVbuly4ve3VcRAVdBQmSKrGp3Ee
PMnJyXk4L19yApLSuLu9GAzG4q/+lkF8he4ji0DRlFtrqSMaDGEdPi/mWTAv
xRoRPXQfNbp4n6T97Tju7iEZZ2YtnszI6sua34oN8lZ+M6nBlP6k7d7srzty
+WM0ViDjJ0r8IyaFq5DDa865ZVuK7qFkPT/KsPcKvGemKuoWGXBMxQHp7zE1
QDYnaDa+bMc2ZmphuKkJ0kJi5F0lZiwq/KZH8D1t/+uqkoXtFmkH0HeYCaTC
hsUh5aIWTyf0/pZJlQRaMTuI9+vFX7qAnrFiGSvXjAP2xBODdU647S6z7Pxk
whzRAiV93AXiJb5nR0c+wa1p3docwg29q5aK8s9oUTzcSL2ppeF+lq96V7gK
Q5kWfZrfC5BZ3nQWlxfAFEPBw7uTX0DvQkkPZ38djBIGjJVdoWHQr/FvT4Me
DpJ7RsZb3CDdJ7hRn2wEgb6+I1rrgojghuTqzGeQnaHOHpNOwYWDZRsKVRZ4
rvxAVr0joUYb5Y9sG/TcvDB7t44A1dp3Io+PA5SDE3c0iG3Qmn4xri+YgH5/
hfelORZQzHq7k1dMgM5NxM2nOiBsyJQjiyfgRBx33dljRoCqzhnszQ649F9+
8ANPoP/aFrrA+hDm5Zp35XkIsNdMjmTf1MOkpuEq5ngn5IebWkaym6H/NiMs
XUjBK1ntPOG4RpCWalYmXnVBSpTBXymrhko7pzr/shucb5NT0z0KEEoj3W0J
NEw7Q4VO3XwNp8qsBXIdDZKBga5R5fX4WFJ8BOw0TBioiGYc0+Nnluuj5BwN
tjzuv21cI16ODSrd2uOGV5kdWoHXc4zw8VU/6HQBt24EL3OmFQVkDy+cT4G/
UF325xMHng40H2UNdkOSd32VmOjGIpOf87PcDl6xr6f3n3Zi+3XfT7EZZlhV
qbIFhFE4fY1jUsaQETgFi0r7EijkB6ym5ypb4J/o4XUGhxO3BK7JDbKqYdOp
uLlPT5HYFCxgVcrl+OOfvgDBs8dM
         "]], $CellContext`inReg = 
       RegionMemberFunction[
         MeshRegion[CompressedData["
1:eJxdkGtMUwcYhjusKJkXVGK8A1FiRYyEhkyU7cMxMSpiKWDVVEVScVMClZTa
uQoticoEqRovXBQwUoNiFUpFufnRAq0CSyna0suB09MeN0VU8AYGSafxlz7J
m+fX8+cNTMng7vdiMBhhn/fFwXyF7j2LQJHf7Y3UUQ2Gsv68IOZZsCDNGhU7
fh81ukSflIM9OK3+iIyzuAFPZuUM56zswGZ5B7+N1GDaSMpub/bnjlzXicYq
ZHxH8t9xaVyFHF5wzq/dUXIPJZv5MYbfr8IbZrqiMcyAU6sOSX+LqwOyLUmz
9d8e7GamF0eaWiEjNE7eX2bGkuIvPIKvtqGqbHWPRdoL9F1mEqmwYWlopajd
0wdDC7OpsiAr5gbzFlya2Q/0op/XsvLNOGpPPjHW6IQ77grL3g8mzBOtUtLH
XSD+yffclOgu3JkxoM0j3DC0fo2o8KwWxRMt1MsGGu7n+Kr3RaownGnRZ/g/
BZnlZV9pZRH4GYoe1s95CkOrJYOcg40wWRj4o+wqDWP+Lc89zXo4TB6YlGhx
g/QPwc2mVCMI9E29sVoXRIU0p9ZmP4bcLHXu1EwKLh6u2FKsssAT5Vuy5jUJ
ddqYAGTbYPDWxaX7dQSoNr4WeXwcoBybtadZbIOOzEsJwyEEjAQovC8vs4Bi
yau9vFICdG4iYSXVCxHjpjxZIgEnEribzh0zAtT0LWJvd8Dlb/8D+r9d4aus
D2FFvnlfgYcAe92caPYtPcxunahhTndCYaSpfRK7DUbuMCIyhRQ8kzWsEE5r
AWm55pfkay5IizEEKGW1UG3n1BZecYPzVWp6pkcBQmm0uzuJhnlnqfC526/j
XJm1SK6jQTI62j+5sgk7JaVHwU7DjNGqWMYxPX5iud5LztNgK+B+7OYa8Up8
cPnOQTc8y+7VCryeYJSPr/pBnwu4jT/wshdbUUAO8iL5FAQI1RWnuxx4Jsj8
F2tsAFK8m2rExACWmPydn+R28Ip/MX/kjBN7bvh+iM8yw/pqlS0wgsL5Gxyz
s8aNwCkKKx9OopAf+Cu9XNkO72InNhkcTtwRtCE/2KqGbacSlv9zisTWEAGr
Wi7H/wF15atS
          "], {
           
           Polygon[{{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 
            17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 
            33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 
            49, 50}}]}], 2, 
         Region`Mesh`CanonicalDistance[True]], $CellContext`nearest = {{
        0.22049999999999997`, 
        0.04599999999999993}}, $CellContext`findHitPoint2[
         Pattern[$CellContext`\[Alpha], 
          Blank[]], 
         Pattern[$CellContext`\[Theta], 
          Blank[]], 
         Pattern[$CellContext`ps1, 
          Blank[]], 
         Pattern[$CellContext`ps2, 
          Blank[]], 
         Pattern[$CellContext`accuracy, 
          Blank[]], 
         Pattern[$CellContext`nearest, 
          Blank[]]] := 
       Module[{$CellContext`\[Psi]a, $CellContext`pra, \
$CellContext`\[Gamma]a, $CellContext`cola, $CellContext`i, \
$CellContext`hitIndex, $CellContext`c}, $CellContext`hitIndex = -1; 
         For[$CellContext`i = 1, $CellContext`i <= $CellContext`accuracy, 
           
           Increment[$CellContext`i], $CellContext`\[Psi]a = $CellContext`\
\[Theta] + $CellContext`\[Alpha]/2 + 
             Pi/2 + $CellContext`i ((
                Pi - $CellContext`\[Alpha])/$CellContext`accuracy); \
$CellContext`cola = (1/2) {
               Cos[$CellContext`\[Psi]a], 
               Sin[$CellContext`\[Psi]a]}; $CellContext`pra = 
            2 Abs[Dot[$CellContext`ps1, $CellContext`cola] - 
               Dot[$CellContext`ps2, $CellContext`cola]]; 
           Null; $CellContext`c = (1/2) {
               Cos[$CellContext`\[Psi]a], 
               Sin[$CellContext`\[Psi]a]}; $CellContext`\[Gamma]a = 
            ArcCos[1 - 2 $CellContext`pra]; 
           If[$CellContext`ifInRegion[$CellContext`c, $CellContext`\[Psi]a, 
               Flatten[$CellContext`nearest], $CellContext`\[Gamma]a, 1/2] == 
             True, If[$CellContext`hitIndex == -1, $CellContext`hitIndex = \
$CellContext`i]; Return[$CellContext`hitIndex]]; Null]; 
         Return[$CellContext`hitIndex]; Null], $CellContext`i = 
       101, $CellContext`ifInRegion[
         Pattern[$CellContext`c, 
          Blank[]], 
         Pattern[$CellContext`\[Psi]a, 
          Blank[]], 
         Pattern[$CellContext`p, 
          Blank[]], 
         Pattern[$CellContext`\[Gamma]a, 
          Blank[]], 
         Pattern[$CellContext`r, 
          Blank[]]] := 
       Module[{$CellContext`d, $CellContext`dc, $CellContext`A, \
$CellContext`B}, 
         If[(Part[$CellContext`p, 1] - Part[$CellContext`c, 1]) (
              Part[$CellContext`p, 1] - Part[$CellContext`c, 1]) + (
              Part[$CellContext`p, 2] - Part[$CellContext`c, 2]) (
              Part[$CellContext`p, 2] - 
              Part[$CellContext`c, 2]) > $CellContext`r $CellContext`r, 
           Return[False]]; $CellContext`B = $CellContext`c + $CellContext`r {
              Cos[$CellContext`\[Psi]a - $CellContext`\[Gamma]a], 
              
              Sin[$CellContext`\[Psi]a - $CellContext`\[Gamma]a]}; \
$CellContext`A = $CellContext`c + $CellContext`r {
              Cos[$CellContext`\[Psi]a + $CellContext`\[Gamma]a], 
              
              Sin[$CellContext`\[Psi]a + $CellContext`\[Gamma]a]}; \
$CellContext`d = (Part[$CellContext`p, 1] - Part[$CellContext`A, 1]) (
             Part[$CellContext`B, 2] - Part[$CellContext`A, 2]) - (
            Part[$CellContext`p, 2] - Part[$CellContext`A, 2]) (
            Part[$CellContext`B, 1] - 
            Part[$CellContext`A, 1]); $CellContext`dc = (
             Part[$CellContext`c, 1] - Part[$CellContext`A, 1]) (
             Part[$CellContext`B, 2] - Part[$CellContext`A, 2]) - (
            Part[$CellContext`c, 2] - Part[$CellContext`A, 2]) (
            Part[$CellContext`B, 1] - Part[$CellContext`A, 1]); 
         If[$CellContext`\[Gamma]a <= Pi/2, 
           If[$CellContext`d $CellContext`dc <= 0, 
            Return[True], 
            Return[False]], 
           If[$CellContext`d $CellContext`dc > 0, 
            Return[True], 
            Return[False]]]; Null], $CellContext`A = {
        1 + Sqrt[5/8 + Sqrt[5]/8]/40, 
         1 + (1 - Sqrt[5])/160}, $CellContext`B = {
        1 - Sqrt[5/8 + Sqrt[5]/8]/40, 
         1 + (1 - Sqrt[5])/160}, $CellContext`makeRegionList[
         Pattern[$CellContext`\[Alpha], 
          Blank[]], 
         Pattern[$CellContext`\[Theta], 
          Blank[]], 
         Pattern[$CellContext`ps1, 
          Blank[]], 
         Pattern[$CellContext`ps2, 
          Blank[]], 
         Pattern[$CellContext`c, 
          Blank[]], 
         Pattern[$CellContext`accuracy, 
          Blank[]]] := 
       Module[{$CellContext`\[Psi]a, $CellContext`pra, \
$CellContext`\[Gamma]a, $CellContext`cola, $CellContext`regionlist}, \
$CellContext`\[Psi]a = $CellContext`\[Theta] + $CellContext`\[Alpha]/2 + 
           Pi/2 + $CellContext`c ((
              Pi - $CellContext`\[Alpha])/$CellContext`accuracy); \
$CellContext`cola = (1/2) {
             Cos[$CellContext`\[Psi]a], 
             Sin[$CellContext`\[Psi]a]}; $CellContext`pra = 
          2 Abs[Dot[$CellContext`ps1, $CellContext`cola] - 
             Dot[$CellContext`ps2, $CellContext`cola]]; \
$CellContext`\[Gamma]a = 
          ArcCos[(1/2 - $CellContext`pra)/(1/2)]; $CellContext`regionlist = 
          Polygon[
            Table[$CellContext`cola - (1/2) {
               Cos[$CellContext`a], 
               
               Sin[$CellContext`a]}, {$CellContext`a, $CellContext`\[Psi]a - \
$CellContext`\[Gamma]a, $CellContext`\[Psi]a + $CellContext`\[Gamma]a, \
$CellContext`\[Gamma]a/$CellContext`accuracy}]]; 
         Return[$CellContext`regionlist]], $CellContext`makeRegionList[
         Pattern[$CellContext`\[Alpha], 
          Blank[]], 
         Pattern[$CellContext`\[Theta], 
          Blank[]], 
         Pattern[$CellContext`ps1, 
          Blank[]], 
         Pattern[$CellContext`ps2, 
          Blank[]], 
         Pattern[$CellContext`c, 
          Blank[]]] := 
       Module[{$CellContext`\[Psi]a, $CellContext`pra, \
$CellContext`\[Gamma]a, $CellContext`cola, $CellContext`regionlist}, \
$CellContext`\[Psi]a = $CellContext`\[Theta] + $CellContext`\[Alpha]/2 + 
           Pi/2 + $CellContext`c ((Pi - $CellContext`\[Alpha])/
             20); $CellContext`cola = (1/2) {
             Cos[$CellContext`\[Psi]a], 
             Sin[$CellContext`\[Psi]a]}; $CellContext`pra = 
          2 Abs[Dot[$CellContext`ps1, $CellContext`cola] - 
             Dot[$CellContext`ps2, $CellContext`cola]]; \
$CellContext`\[Gamma]a = 
          ArcCos[(1/2 - $CellContext`pra)/(1/2)]; $CellContext`regionlist = 
          Polygon[
            Table[$CellContext`cola - (1/2) {
               Cos[$CellContext`a], 
               
               Sin[$CellContext`a]}, {$CellContext`a, $CellContext`\[Psi]a - \
$CellContext`\[Gamma]a, $CellContext`\[Psi]a + $CellContext`\[Gamma]a, \
$CellContext`\[Gamma]a/20}]]; 
         Return[$CellContext`regionlist]], $CellContext`intersect = 
       Point[{{0.102355375195508, 0.5899700871682724}, {
         0.5395030682143737, -0.26051180586454}, {0.2, 0.4}}]}; 
     Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.717835315622341*^9, 3.7180304213948812`*^9, 3.718030558339979*^9, 
   3.7180306340127974`*^9, 3.71803094288039*^9, 3.718031004332045*^9, 
   3.71803103751473*^9, 3.718031143390727*^9, 3.718031230070969*^9, {
   3.718031309329061*^9, 3.7180313365189753`*^9}, 3.7180313672318296`*^9, 
   3.718386155129839*^9, 3.718397976047805*^9, {3.718398743174008*^9, 
   3.7183987649713507`*^9}, {3.7183988708779373`*^9, 3.71839889571533*^9}, 
   3.718398973711171*^9, 3.718399047935087*^9, {3.7183991337766113`*^9, 
   3.718399156120056*^9}, 3.718399996630479*^9, 3.718657264708465*^9, {
   3.7186573315407257`*^9, 3.718657344269348*^9}, {3.718657433598277*^9, 
   3.71865746187779*^9}, 3.71865753764263*^9, 3.7186575724058723`*^9, 
   3.718657627925788*^9, 3.718657703116867*^9, {3.7186578560670156`*^9, 
   3.718657880695869*^9}},ExpressionUUID->"57a309d4-3f4a-4796-89e8-\
beebde7f6057"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"h", "  ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], "}"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Flatten", "@", "h"}]}], "Input",
 CellChangeTimes->{{3.717242704721953*^9, 
  3.7172427407009583`*^9}},ExpressionUUID->"ca12364e-480c-4205-aea2-\
644b34dc7053"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{{3.717242715052553*^9, 
  3.717242741085555*^9}},ExpressionUUID->"8f4aa0e8-ca00-45a3-b8fa-\
78628d91c75c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Graphics", "[", 
  RowBox[{"{", 
   RowBox[{"Blue", ",", 
    RowBox[{"EdgeForm", "\[Rule]", "Red"}], ",", "reg2"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.717169976360812*^9, 3.7171699766002493`*^9}, {
   3.717170886273231*^9, 3.717170889865099*^9}, {3.717170954203519*^9, 
   3.717170963899231*^9}, 
   3.717171339421647*^9},ExpressionUUID->"0aeabfdb-41e7-43fb-81ee-\
83a3172246da"],

Cell[BoxData[
 GraphicsBox[
  {RGBColor[0, 0, 1], 
   StyleBox[PolygonBox[CompressedData["
1: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
83Hn
     "]],
    EdgeForm -> RGBColor[1, 0, 0]]}]], "Output",
 CellChangeTimes->{
  3.717169977054968*^9, {3.717170751674698*^9, 3.717170771546159*^9}, {
   3.7171708789021463`*^9, 3.717170894735797*^9}, {3.717170938592194*^9, 
   3.717170987146105*^9}, 3.717171137264721*^9, {3.7171712088173313`*^9, 
   3.717171238378153*^9}, {3.717171331798518*^9, 3.717171346901807*^9}, 
   3.717171491968823*^9, 3.717172025725156*^9, 3.717172285469697*^9, 
   3.717240344443157*^9},ExpressionUUID->"794ee3ff-3070-4136-a4d3-\
bf0bd2068100"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Inset", "[", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Psi]a", " ", ",", "pra", ",", "\[Gamma]a", ",", "cola", ",", 
       "\[Alpha]", " ", ",", 
       RowBox[{"r", " ", "=", " ", 
        RowBox[{"1", "/", "40"}]}], " ", 
       RowBox[{"(*", 
        RowBox[{
        "radius", " ", "of", " ", "start", " ", "and", " ", "end", " ", 
         "markers"}], "*)"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d", " ", "=", " ", 
         RowBox[{"Norm", "[", 
          RowBox[{"ps1", "-", "ps2"}], "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{"distance", " ", "between", " ", "robots"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"\[Theta]", " ", "=", " ", 
         RowBox[{"ArcTan", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "ps1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "-", 
            RowBox[{
            "ps2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           ",", 
           RowBox[{
            RowBox[{
            "ps1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "-", 
            RowBox[{
            "ps2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}],
           "]"}]}], ";"}]}], " ", 
      RowBox[{"(*", 
       RowBox[{
       "angle", " ", "between", " ", "the", " ", "two", " ", "particles"}], 
       "*)"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Alpha]", " ", "=", " ", 
       RowBox[{"2", " ", 
        RowBox[{"ArcSin", "[", "d", "]"}]}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{
       "anglular", " ", "arc", " ", "unreachable", " ", "by", " ", "robots"}],
        "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"cola", " ", "=", " ", 
       RowBox[{
        RowBox[{"1", "/", "2"}], 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Psi]a", " ", "]"}], ",", 
          RowBox[{"Sin", "[", "\[Psi]a", " ", "]"}]}], "}"}]}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"collision", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"pra", "=", " ", 
       RowBox[{"2", " ", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"ps1", ".", "cola"}], "-", 
          RowBox[{"ps2", ".", "cola"}]}], "]"}]}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"perpendicular", " ", "distance"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]a", "=", " ", 
       RowBox[{"ArcCos", "[", 
        FractionBox[
         RowBox[{
          RowBox[{"1", "/", "2"}], "-", "pra"}], 
         RowBox[{"1", "/", "2"}]], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "reachable", " ", "angle", " ", "for", " ", "other", " ", "robot", " ",
         "after", " ", "first", " ", "robot", " ", "collides"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"reg", "=", 
       RowBox[{"Polygon", "[", 
        RowBox[{"Join", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Psi]a", "=", 
            RowBox[{"\[Theta]", "+", 
             RowBox[{"\[Alpha]", "/", "2"}], "+", 
             RowBox[{"\[Pi]", "/", "2"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"cola", "-", 
               RowBox[{
                RowBox[{"1", "/", "2"}], 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Cos", "[", "a", "]"}], ",", 
                  RowBox[{"Sin", "[", "a", "]"}]}], "}"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"a", ",", 
               RowBox[{"\[Psi]a", " ", "-", "\[Gamma]a"}], " ", ",", 
               RowBox[{"\[Psi]a", " ", "+", "\[Gamma]a"}]}], "}"}]}], "]"}]}],
           ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\[Psi]a", "=", 
            RowBox[{"\[Theta]", "-", 
             RowBox[{"\[Alpha]", "/", "2"}], "+", 
             RowBox[{
              RowBox[{"3", "/", "2"}], "\[Pi]"}]}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ParametricPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"cola", "-", 
          RowBox[{
           RowBox[{"1", "/", "2"}], 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Cos", "[", "a", "]"}], ",", 
             RowBox[{"Sin", "[", "a", "]"}]}], "}"}]}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"\[Psi]a", ",", 
          RowBox[{"\[Theta]", "+", 
           RowBox[{"\[Alpha]", "/", "2"}], "+", 
           RowBox[{"\[Pi]", "/", "2"}]}], ",", 
          RowBox[{"\[Theta]", "-", 
           RowBox[{"\[Alpha]", "/", "2"}], "+", 
           RowBox[{
            RowBox[{"3", "/", "2"}], "\[Pi]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", 
          RowBox[{"\[Psi]a", " ", "-", "\[Gamma]a"}], " ", ",", 
          RowBox[{"\[Psi]a", " ", "+", "\[Gamma]a"}]}], "}"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<\[CapitalDelta]x\>\"", ",", "\"\<\[CapitalDelta] y\>\""}], 
          "}"}]}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "Bold", ",", "Large"}], "]"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "400"}], ",", " ", 
        RowBox[{"Epilog", "\[Rule]", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Circle", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"1", "-", 
              RowBox[{"2", "\[Epsilon]"}]}]}], "]"}], ",", 
           RowBox[{"(*", 
            RowBox[{"goal", " ", "deltas"}], "*)"}], "\[IndentingNewLine]", 
           "Red", ",", "\[IndentingNewLine]", 
           RowBox[{"Disk", "[", 
            RowBox[{
             RowBox[{"pe2", "-", "pe1"}], ",", 
             RowBox[{"2", "r"}]}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"StringForm", "[", "\"\<\[CapitalDelta]g\>\"", "]"}], 
               ",", 
               RowBox[{"FontSize", "\[Rule]", "24"}], ",", "Black", ",", 
               RowBox[{"FontFamily", "\[Rule]", " ", "\"\<Times\>\""}]}], 
              "]"}], ",", 
             RowBox[{"pe2", "-", "pe1", "-", 
              RowBox[{"{", 
               RowBox[{".1", ",", ".1"}], "}"}]}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"current", " ", "deltas"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"Darker", "[", "Green", "]"}], ",", 
           RowBox[{"Rectangle", "[", 
            RowBox[{
             RowBox[{"ps2", "-", "ps1", "-", 
              RowBox[{
               RowBox[{"4", "/", "3"}], "r", " ", 
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}]}]}], ",", 
             RowBox[{"ps2", "-", "ps1", "+", 
              RowBox[{
               RowBox[{"4", "/", "3"}], "r", 
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}]}]}]}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"StringForm", "[", "\"\<\[CapitalDelta]r\>\"", "]"}], 
               ",", 
               RowBox[{"FontSize", "\[Rule]", "24"}], ",", "Black", ",", 
               RowBox[{"FontFamily", "\[Rule]", " ", "\"\<Times\>\""}]}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                "ps2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                 "-", 
                RowBox[{
                "ps1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                 "+", " ", "0.1"}], ",", 
               RowBox[{
                RowBox[{
                "ps2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                 "-", 
                RowBox[{
                "ps1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                 "+", "0.1"}]}], "}"}]}], "]"}]}], "}"}]}]}], "]"}]}]}], 
    "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.2", ",", "0"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7171700373837337`*^9, 3.717170043097954*^9}, {
  3.7171700784117613`*^9, 3.717170105085816*^9}, {3.7171702017450523`*^9, 
  3.7171704084683027`*^9}},ExpressionUUID->"cf284d5b-6f7a-4c7e-8199-\
faf3bde0360a"],

Cell[BoxData[
 TemplateBox[{
  "Module","lvsym",
   "\"Local variable specification \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"\
\[Psi]a\\\", \\\",\\\", \\\"pra\\\", \\\",\\\", \\\"\[Gamma]a\\\", \\\",\\\", \
\\\"cola\\\", \\\",\\\", \\\"\[Alpha]\\\", \\\",\\\", RowBox[{\\\"r\\\", \
\\\"=\\\", FractionBox[\\\"1\\\", \\\"40\\\"]}], \\\",\\\", \
RowBox[{RowBox[{\\\"d\\\", \\\"=\\\", RowBox[{\\\"Norm\\\", \\\"[\\\", \
RowBox[{\\\"ps1\\\", \\\"-\\\", \\\"ps2\\\"}], \\\"]\\\"}]}], \\\";\\\", \
RowBox[{\\\"\[Theta]\\\", \\\"=\\\", RowBox[{\\\"ArcTan\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{\\\"ps1\\\", \\\"\[LeftDoubleBracket]\\\", \\\"1\\\", \
\\\"\[RightDoubleBracket]\\\"}], \\\"-\\\", RowBox[{\\\"ps2\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]}], \\\",\
\\\", RowBox[{RowBox[{\\\"ps1\\\", \\\"\[LeftDoubleBracket]\\\", \\\"2\\\", \
\\\"\[RightDoubleBracket]\\\"}], \\\"-\\\", RowBox[{\\\"ps2\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"2\\\", \\\"\[RightDoubleBracket]\\\"}]}]}], \
\\\"]\\\"}]}], \\\";\\\"}]}], \\\"}\\\"}]\\) contains \
\\!\\(\\*RowBox[{RowBox[{\\\"d\\\", \\\"=\\\", RowBox[{\\\"Norm\\\", \
\\\"[\\\", RowBox[{\\\"ps1\\\", \\\"-\\\", \\\"ps2\\\"}], \\\"]\\\"}]}], \
\\\";\\\", RowBox[{\\\"\[Theta]\\\", \\\"=\\\", RowBox[{\\\"ArcTan\\\", \\\"[\
\\\", RowBox[{RowBox[{RowBox[{\\\"ps1\\\", \\\"\[LeftDoubleBracket]\\\", \
\\\"1\\\", \\\"\[RightDoubleBracket]\\\"}], \\\"-\\\", RowBox[{\\\"ps2\\\", \
\\\"\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]}], \
\\\",\\\", RowBox[{RowBox[{\\\"ps1\\\", \\\"\[LeftDoubleBracket]\\\", \\\"2\\\
\", \\\"\[RightDoubleBracket]\\\"}], \\\"-\\\", RowBox[{\\\"ps2\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"2\\\", \\\"\[RightDoubleBracket]\\\"}]}]}], \
\\\"]\\\"}]}], \\\";\\\"}]\\), which is not a symbol or an assignment to a \
symbol.\"",2,194,208,25260582863429082811,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.717170412007125*^9, 
  3.718397962067273*^9},ExpressionUUID->"f285b155-9438-48fb-87a2-\
4352a4e2abb4"],

Cell[BoxData[
 RowBox[{"Inset", "[", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Psi]a", ",", "pra", ",", "\[Gamma]a", ",", "cola", ",", "\[Alpha]", 
       ",", 
       RowBox[{"r", "=", 
        FractionBox["1", "40"]}], ",", 
       RowBox[{
        RowBox[{"d", "=", 
         RowBox[{"Norm", "[", 
          RowBox[{"ps1", "-", "ps2"}], "]"}]}], ";", 
        RowBox[{"\[Theta]", "=", 
         RowBox[{"ArcTan", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "ps1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "-", 
            RowBox[{
            "ps2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           ",", 
           RowBox[{
            RowBox[{
            "ps1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "-", 
            RowBox[{
            "ps2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}],
           "]"}]}], ";"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"\[Alpha]", "=", 
       RowBox[{"2", " ", 
        RowBox[{"ArcSin", "[", "d", "]"}]}]}], ";", 
      RowBox[{"cola", "=", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Psi]a", "]"}], ",", 
          RowBox[{"Sin", "[", "\[Psi]a", "]"}]}], "}"}]}]}], ";", 
      RowBox[{"pra", "=", 
       RowBox[{"2", " ", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"ps1", ".", "cola"}], "-", 
          RowBox[{"ps2", ".", "cola"}]}], "]"}]}]}], ";", 
      RowBox[{"\[Gamma]a", "=", 
       RowBox[{"ArcCos", "[", 
        FractionBox[
         RowBox[{
          FractionBox["1", "2"], "-", "pra"}], 
         FractionBox["1", "2"]], "]"}]}], ";", 
      RowBox[{"reg", "=", 
       RowBox[{"Polygon", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Psi]a", "=", 
            RowBox[{"\[Theta]", "+", 
             FractionBox["\[Alpha]", "2"], "+", 
             FractionBox["\[Pi]", "2"]}]}], ";", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"cola", "-", 
               RowBox[{
                FractionBox["1", "2"], " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Cos", "[", "a", "]"}], ",", 
                  RowBox[{"Sin", "[", "a", "]"}]}], "}"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"a", ",", 
               RowBox[{"\[Psi]a", "-", "\[Gamma]a"}], ",", 
               RowBox[{"\[Psi]a", "+", "\[Gamma]a"}]}], "}"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"\[Psi]a", "=", 
            RowBox[{"\[Theta]", "-", 
             FractionBox["\[Alpha]", "2"], "+", 
             FractionBox[
              RowBox[{"3", " ", "\[Pi]"}], "2"]}]}], ";"}]}], "]"}], "]"}]}], 
      ";", 
      RowBox[{"ParametricPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"cola", "-", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Cos", "[", "a", "]"}], ",", 
             RowBox[{"Sin", "[", "a", "]"}]}], "}"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Psi]a", ",", 
          RowBox[{"\[Theta]", "+", 
           FractionBox["\[Alpha]", "2"], "+", 
           FractionBox["\[Pi]", "2"]}], ",", 
          RowBox[{"\[Theta]", "-", 
           FractionBox["\[Alpha]", "2"], "+", 
           FractionBox[
            RowBox[{"3", " ", "\[Pi]"}], "2"]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", 
          RowBox[{"\[Psi]a", "-", "\[Gamma]a"}], ",", 
          RowBox[{"\[Psi]a", "+", "\[Gamma]a"}]}], "}"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          
          RowBox[{"\<\"\[CapitalDelta]x\"\>", 
           ",", "\<\"\[CapitalDelta] y\"\>"}], "}"}]}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "Bold", ",", "Large"}], "]"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "400"}], ",", 
        RowBox[{"Epilog", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Circle", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"1", "-", 
              RowBox[{"2", " ", "\[Epsilon]"}]}]}], "]"}], ",", "Red", ",", 
           RowBox[{"Disk", "[", 
            RowBox[{
             RowBox[{"pe2", "-", "pe1"}], ",", 
             RowBox[{"2", " ", "r"}]}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               InterpretationBox["\<\"\[CapitalDelta]g\"\>",
                StringForm["\[CapitalDelta]g"],
                Editable->False], ",", 
               RowBox[{"FontSize", "\[Rule]", "24"}], ",", "Black", ",", 
               RowBox[{"FontFamily", "\[Rule]", "\<\"Times\"\>"}]}], "]"}], 
             ",", 
             RowBox[{"pe2", "-", "pe1", "-", 
              RowBox[{"{", 
               RowBox[{"0.1`", ",", "0.1`"}], "}"}]}]}], "]"}], ",", 
           RowBox[{"Darker", "[", "Green", "]"}], ",", 
           RowBox[{"Rectangle", "[", 
            RowBox[{
             RowBox[{"ps2", "-", "ps1", "-", 
              RowBox[{
               FractionBox["4", "3"], " ", "r", " ", 
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}]}]}], ",", 
             RowBox[{"ps2", "-", "ps1", "+", 
              RowBox[{
               FractionBox["4", "3"], " ", "r", " ", 
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}]}]}]}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               InterpretationBox["\<\"\[CapitalDelta]r\"\>",
                StringForm["\[CapitalDelta]r"],
                Editable->False], ",", 
               RowBox[{"FontSize", "\[Rule]", "24"}], ",", "Black", ",", 
               RowBox[{"FontFamily", "\[Rule]", "\<\"Times\"\>"}]}], "]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                "ps2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                 "-", 
                RowBox[{
                "ps1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                 "+", "0.1`"}], ",", 
               RowBox[{
                RowBox[{
                "ps2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                 "-", 
                RowBox[{
                "ps1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                 "+", "0.1`"}]}], "}"}]}], "]"}]}], "}"}]}]}], "]"}]}]}], 
    "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.2`", ",", "0"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.7171704120106487`*^9, 
  3.718397962091115*^9},ExpressionUUID->"1cd0be6e-d7b3-472a-b65a-\
ef7d697bb197"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1680, 925},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 27, \
2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 268, 6, 63, "Subchapter", "ExpressionUUID" -> \
"dee739e3-987b-4be3-8627-4e5e6776aa9c"],
Cell[CellGroupData[{
Cell[873, 32, 190, 3, 44, "Subsection", "ExpressionUUID" -> \
"4be34e6d-bad5-4da7-9c76-8b2549b18ab0"],
Cell[CellGroupData[{
Cell[1088, 39, 3218, 88, 159, "Input", "ExpressionUUID" -> \
"7a5b9100-e3c8-4bf7-ae61-202a04973f30"],
Cell[4309, 129, 2383, 49, 282, "Output", "ExpressionUUID" -> \
"303299ca-ccc0-4d41-8e3a-2e820a346061"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[6741, 184, 243, 4, 44, "Subsection", "ExpressionUUID" -> \
"3b539056-2e0c-4dd1-b581-db9b5f5d99c3"],
Cell[CellGroupData[{
Cell[7009, 192, 877, 22, 96, "Input", "ExpressionUUID" -> \
"48f54bda-0d38-4162-a569-c91b58422939"],
Cell[7889, 216, 2695, 48, 447, "Output", "ExpressionUUID" -> \
"d9257b84-d4fa-4407-9314-80ad5fdfe46b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[10633, 270, 245, 4, 44, "Subsection", "ExpressionUUID" -> \
"a70ef747-7f54-494f-88c4-3358c676f6a3"],
Cell[10881, 276, 23333, 563, 1401, "Input", "ExpressionUUID" -> \
"1d65b189-0cc0-4a49-a5e6-7c338fc1589d"],
Cell[34217, 841, 807, 12, 54, "Input", "ExpressionUUID" -> \
"b8b61b9f-295c-4b81-9767-2ff999870c58"],
Cell[CellGroupData[{
Cell[35049, 857, 381, 11, 32, "Input", "ExpressionUUID" -> \
"60daef29-134a-4158-a341-c2afd469ad2e"],
Cell[35433, 870, 211, 6, 32, "Output", "ExpressionUUID" -> \
"e5d056e9-a60a-47d4-88d7-a46328192bfd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35681, 881, 66158, 1386, 3305, "Input", "ExpressionUUID" -> \
"23e33bca-9fb5-45a3-9b79-e10dcfa556d1"],
Cell[101842, 2269, 36059, 689, 561, "Output", "ExpressionUUID" -> \
"57a309d4-3f4a-4796-89e8-beebde7f6057"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137938, 2963, 369, 11, 54, "Input", "ExpressionUUID" -> \
"ca12364e-480c-4205-aea2-644b34dc7053"],
Cell[138310, 2976, 199, 5, 32, "Output", "ExpressionUUID" -> \
"8f4aa0e8-ca00-45a3-b8fa-78628d91c75c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[138546, 2986, 418, 10, 32, "Input", "ExpressionUUID" -> \
"0aeabfdb-41e7-43fb-81ee-83a3172246da"],
Cell[138967, 2998, 2757, 49, 447, "Output", "ExpressionUUID" -> \
"794ee3ff-3070-4136-a4d3-bf0bd2068100"]
}, Open  ]],
Cell[CellGroupData[{
Cell[141761, 3052, 9135, 229, 576, "Input", "ExpressionUUID" -> \
"cf284d5b-6f7a-4c7e-8199-faf3bde0360a"],
Cell[150899, 3283, 2055, 31, 41, "Message", "ExpressionUUID" -> \
"f285b155-9438-48fb-87a2-4352a4e2abb4"],
Cell[152957, 3316, 7398, 196, 370, "Output", "ExpressionUUID" -> \
"1cd0be6e-d7b3-472a-b65a-ef7d697bb197"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

