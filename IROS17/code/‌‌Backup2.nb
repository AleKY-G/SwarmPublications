(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    157474,       3605]
NotebookOptionsPosition[    157005,       3585]
NotebookOutlinePosition[    157362,       3601]
CellTagsIndexPosition[    157319,       3598]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"admissibleHeuristic", "[", 
    RowBox[{"s1_", ",", "s2_", ",", " ", "g1_", ",", "g2_"}], "]"}], ":=", 
   RowBox[{"Max", "[", 
    RowBox[{
     RowBox[{"EuclideanDistance", "[", 
      RowBox[{"g1", ",", "s1"}], "]"}], ",", 
     RowBox[{"EuclideanDistance", "[", 
      RowBox[{"g2", ",", "s2"}], "]"}]}], "]"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "a", " ", "distance", " ", "measurement", " ", "that", " ", "never", " ", 
    "over", " ", "estimates", " ", "to", " ", "possible", " ", "distance"}], 
   " ", "*)"}], " ", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"wallFrictionMoveDir", "[", 
    RowBox[{
    "dir_", ",", "s1_", ",", "s2_", ",", "g1_", ",", "g2_", ",", "moves_", 
     ",", "pm1_", ",", " ", "pm2_", ",", " ", "\[Epsilon]_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[CapitalDelta]ex", ",", " ", "\[CapitalDelta]ey", ",", " ", 
       RowBox[{"path", " ", "=", " ", "moves"}], ",", " ", 
       RowBox[{"path1", "=", " ", "pm1"}], ",", " ", 
       RowBox[{"path2", "=", " ", "pm2"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"s1", " ", "=", " ", 
         RowBox[{
         "starting", " ", "position", " ", "of", " ", "robot", " ", "1", " ", 
          "for", " ", "this", " ", "move"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"s2", " ", "=", " ", 
         RowBox[{
         "starting", " ", "position", " ", "of", " ", "robot", " ", "2", " ", 
          "for", " ", "this", " ", "move"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
        "moves", " ", "to", " ", "contact", " ", "wall", " ", "in", " ", 
         "direction", " ", 
         RowBox[{
         "dir", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "  ", "If"}], " ", "one", " ", "robot", " ", 
         "is", " ", "already", " ", "touching", " ", "the", " ", "wall", " ", 
         "in", " ", "direction", " ", "dir"}]}], ",", " ", 
       RowBox[{
        RowBox[{"just", " ", "moves", " ", "the", " ", "second", " ", 
         RowBox[{"robot", ".", " ", "\[IndentingNewLine]", " ", "Movements"}],
          " ", "are", " ", "chosen", " ", "to", " ", "minimize"}], " ", "|", 
        "\[CapitalDelta]ex", "|", " ", "and", " ", "|", "\[CapitalDelta]ey", 
        "|"}], ",", " ", 
       RowBox[{
       "the", " ", "error", " ", "from", " ", "the", " ", "desired", " ", 
        "spacing", " ", "of", " ", "the", " ", "robots"}], ",", " ", 
       RowBox[{
        RowBox[{"where", " ", "\[CapitalDelta]ex"}], " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"g2x", "-", "g1x"}], ")"}], " ", "-", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"r2x", "-", "r1x"}], ")"}], "  ", "and", " ", 
           "\[CapitalDelta]ey"}]}], " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"g2y", "-", "g1y"}], ")"}], " ", "-", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"r2y", "-", "r1y"}], ")"}], " ", ".", "  ", "If"}], " ", 
           "robots", " ", "would", " ", "end", " ", "up", " ", 
           "overlapping"}]}]}]}], ",", " ", 
       RowBox[{
        RowBox[{"returns", " ", "multiple", " ", "possibilities"}], " ", "+", 
        
        RowBox[{"/", 
         RowBox[{"-", " ", "\[Epsilon]"}]}]}]}], "  ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"STEP", " ", "1"}], ":", " ", 
        RowBox[{"is", " ", "base", " ", "case", " ", "1", " ", 
         RowBox[{"possible", "?", "  ", "If"}], " ", "so"}]}], ",", " ", 
       RowBox[{"do", " ", "it", " ", "and", " ", "return"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[CapitalDelta]ex", ",", " ", "\[CapitalDelta]ey"}], "}"}], 
       " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"g2", "-", "g1"}], ")"}], "-", 
        RowBox[{"(", 
         RowBox[{"s2", "-", "s1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.001"}], "\[LessEqual]", " ", "\[CapitalDelta]ex", 
          "\[LessEqual]", " ", "0.001"}], " ", "&&", " ", 
         RowBox[{
          RowBox[{"-", "0.001"}], "\[LessEqual]", " ", "\[CapitalDelta]ey", 
          " ", "<", " ", "0.001"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"path", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
              "g2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "-", "  ", 
              RowBox[{
              "s2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             ",", " ", 
             RowBox[{
              RowBox[{
              "g2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              "-", " ", 
              RowBox[{
              "s2", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}]}]}], "}"}]}], "]"}], ";", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"path1", ",", "  ", "g1"}], "]"}], ";", " ", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"path2", ",", " ", "g2"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", " ", 
          RowBox[{"{", " ", 
           RowBox[{
            RowBox[{"distanceMoved", "[", " ", "path", "]"}], ",", "g1", ",", 
            "g2", ",", "path", ",", "path1", ",", "path2", ",", " ", "True"}],
            " ", "}"}], "  ", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"OTHERWISE", ",", " ", 
        RowBox[{
        "move", " ", "in", " ", "the", " ", "desired", " ", "direction", " ", 
         "to", " ", "contact", " ", "a", " ", 
         RowBox[{"wall", ".", "  ", "\[IndentingNewLine]", 
          RowBox[{"We", "'"}]}], "ll", " ", "need", " ", "to", " ", "rotate", 
         " ", "the", " ", "coordinate", " ", "frames", " ", "so", " ", "the", 
         " ", "movement", " ", "is", " ", "up"}], ",", " ", 
        RowBox[{
        "and", " ", "ensure", " ", "robot", " ", "1", " ", "is", " ", "the", 
         " ", "first", " ", "to", " ", 
         RowBox[{"contact", ".", "\[IndentingNewLine]", "then"}], " ", 
         RowBox[{"we", "'"}], "ll", " ", "call", " ", "wallFrictionMoveUp"}], 
        ",", " ", "\[IndentingNewLine]", 
        RowBox[{"then", " ", "we", " ", "take", " ", "the", " ", "answer"}], 
        ",", " ", 
        RowBox[{
        "and", " ", "reassign", " ", "robot", " ", "1", " ", "and", " ", "2", 
         " ", "to", " ", "match", " ", "original", "\[IndentingNewLine]", 
         "then", " ", "rotate", " ", "answer", " ", "into", " ", "original", 
         " ", "coordinate", " ", "frame"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "r1", ",", "r2", ",", "newPathEntries", ",", "s1t", ",", "s2t", ",", 
          "g1t", ",", "g2t", ",", "movest", ",", " ", "pm1st", ",", " ", 
          "pm2st"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"if", " ", "move", " ", "is", " ", "up"}], ",", " ", 
          RowBox[{"call", " ", "wallFrictionMoveUp"}], ",", " ", 
          RowBox[{"otherwise", " ", "rotate", " ", "frame"}], ",", " ", 
          RowBox[{"then", " ", "unrotate", " ", "answers"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"dir", "\[Equal]", "\"\<u\>\""}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<up selected:\>\"", "]"}], ";"}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"newPathEntries", "=", " ", 
             RowBox[{"wallFrictionMoveUp", "[", 
              RowBox[{
              "s1", ",", "s2", ",", "g1", ",", "g2", ",", "moves", ",", "pm1",
                ",", " ", "pm2", ",", "\[Epsilon]"}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"if", " ", "move", " ", "is", " ", "down"}], ",", " ", 
           RowBox[{"rotate", " ", "frame", " ", "180", " ", "deg"}], ",", " ", 
           RowBox[{"then", " ", "unrotate", " ", "answers"}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"dir", "\[Equal]", "\"\<d\>\""}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<down selected:\>\"", "]"}], ";"}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"s1t", ",", "s2t", ",", "g1t", ",", "g2t"}], "}"}], "=",
              " ", 
             RowBox[{"Map", "[", 
              RowBox[{"rotate180", ",", 
               RowBox[{"{", 
                RowBox[{"s1", ",", "s2", ",", "g1", ",", "g2"}], "}"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"movest", "=", " ", 
             RowBox[{"Map", "[", 
              RowBox[{"rotate180inplace", ",", "moves"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"pm1st", "=", " ", 
             RowBox[{"Map", "[", 
              RowBox[{"rotate180", ",", "pm1"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"pm2st", "=", " ", 
             RowBox[{"Map", "[", 
              RowBox[{"rotate180", ",", "pm2"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"newPathEntries", "=", " ", 
             RowBox[{"wallFrictionMoveUp", "[", 
              RowBox[{
              "s1t", ",", "s2t", ",", "g1t", ",", "g2t", ",", "movest", ",", 
               "pm1st", ",", " ", "pm2st", ",", "\[Epsilon]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"undo", " ", "the", " ", "change"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "newPathEntries", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}], " ", "=", " ", 
             RowBox[{"rotate180", "[", 
              RowBox[{
              "newPathEntries", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "newPathEntries", "\[LeftDoubleBracket]", "3", 
              "\[RightDoubleBracket]"}], " ", "=", " ", 
             RowBox[{"rotate180", "[", 
              RowBox[{
              "newPathEntries", "\[LeftDoubleBracket]", "3", 
               "\[RightDoubleBracket]"}], " ", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "newPathEntries", "\[LeftDoubleBracket]", "4", 
              "\[RightDoubleBracket]"}], " ", "=", " ", 
             RowBox[{"Map", "[", 
              RowBox[{"rotate180inplace", ",", " ", 
               RowBox[{
               "newPathEntries", "\[LeftDoubleBracket]", "4", 
                "\[RightDoubleBracket]"}]}], " ", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "newPathEntries", "\[LeftDoubleBracket]", "5", 
              "\[RightDoubleBracket]"}], " ", "=", " ", 
             RowBox[{"Map", "[", 
              RowBox[{"rotate180", ",", " ", 
               RowBox[{
               "newPathEntries", "\[LeftDoubleBracket]", "5", 
                "\[RightDoubleBracket]"}]}], " ", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "newPathEntries", "\[LeftDoubleBracket]", "6", 
              "\[RightDoubleBracket]"}], " ", "=", " ", 
             RowBox[{"Map", "[", 
              RowBox[{"rotate180", ",", " ", 
               RowBox[{
               "newPathEntries", "\[LeftDoubleBracket]", "6", 
                "\[RightDoubleBracket]"}]}], " ", "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"newPathEntries", "=", 
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                 "aPathEntry", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"Map", "[", 
                  RowBox[{"rotate180", ",", 
                   RowBox[{
                   "aPathEntry", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "]"}], " ", ",", 
                 RowBox[{"Map", "[", 
                  RowBox[{"rotate180", ",", 
                   RowBox[{
                   "aPathEntry", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Map", "[", 
                  RowBox[{"rotate180inplace", ",", 
                   RowBox[{
                   "aPathEntry", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], " ", "}"}], 
               "\[IndentingNewLine]", "  ", ",", 
               RowBox[{"{", 
                RowBox[{"aPathEntry", ",", " ", "newPathEntries"}], "}"}]}], 
              "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"if", " ", "move", " ", "is", " ", "right"}], ",", " ", 
           RowBox[{"rotate", " ", "frame", " ", "90", " ", "deg"}], ",", " ", 
           
           RowBox[{"then", " ", "unrotate", " ", "answers"}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"dir", "\[Equal]", "\"\<r\>\""}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<right selected:\>\"", "]"}], ";"}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"s1t", ",", "s2t", ",", "g1t", ",", "g2t"}], "}"}], "=",
              " ", 
             RowBox[{"Map", "[", 
              RowBox[{"rotate90", ",", 
               RowBox[{"{", 
                RowBox[{"s1", ",", "s2", ",", "g1", ",", "g2"}], "}"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"movest", "=", " ", 
             RowBox[{"Map", "[", 
              RowBox[{"rotate90inplace", ",", "moves"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"pm1st", "=", " ", 
             RowBox[{"Map", "[", 
              RowBox[{"rotate90", ",", "pm1"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"pm2st", "=", " ", 
             RowBox[{"Map", "[", 
              RowBox[{"rotate90", ",", "pm2"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"newPathEntries", "=", " ", 
             RowBox[{"wallFrictionMoveUp", "[", 
              RowBox[{
              "s1t", ",", "s2t", ",", "g1t", ",", "g2t", ",", "movest", ",", 
               "pm1st", ",", " ", "pm2st", ",", "\[Epsilon]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"undo", " ", "the", " ", "change"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"newPathEntries", "=", " ", 
               RowBox[{
               "newPathEntries", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}], ";"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "newPathEntries", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}], " ", "=", " ", 
             RowBox[{"rotate270", "[", 
              RowBox[{
              "newPathEntries", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "newPathEntries", "\[LeftDoubleBracket]", "3", 
              "\[RightDoubleBracket]"}], " ", "=", " ", 
             RowBox[{"rotate270", "[", 
              RowBox[{
              "newPathEntries", "\[LeftDoubleBracket]", "3", 
               "\[RightDoubleBracket]"}], " ", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "newPathEntries", "\[LeftDoubleBracket]", "4", 
              "\[RightDoubleBracket]"}], " ", "=", " ", 
             RowBox[{"Map", "[", 
              RowBox[{"rotate270inplace", ",", " ", 
               RowBox[{
               "newPathEntries", "\[LeftDoubleBracket]", "4", 
                "\[RightDoubleBracket]"}]}], " ", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "newPathEntries", "\[LeftDoubleBracket]", "5", 
              "\[RightDoubleBracket]"}], " ", "=", " ", 
             RowBox[{"Map", "[", 
              RowBox[{"rotate270", ",", " ", 
               RowBox[{
               "newPathEntries", "\[LeftDoubleBracket]", "5", 
                "\[RightDoubleBracket]"}]}], " ", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "newPathEntries", "\[LeftDoubleBracket]", "6", 
              "\[RightDoubleBracket]"}], " ", "=", " ", 
             RowBox[{"Map", "[", 
              RowBox[{"rotate270", ",", " ", 
               RowBox[{
               "newPathEntries", "\[LeftDoubleBracket]", "6", 
                "\[RightDoubleBracket]"}]}], " ", "]"}]}]}]}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"newPathEntries", "=", 
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                 "aPathEntry", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"Map", "[", 
                  RowBox[{"rotate90", ",", 
                   RowBox[{
                   "aPathEntry", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "]"}], " ", ",", 
                 RowBox[{"Map", "[", 
                  RowBox[{"rotate90", ",", 
                   RowBox[{
                   "aPathEntry", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Map", "[", 
                  RowBox[{"rotate90inplace", ",", 
                   RowBox[{
                   "aPathEntry", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], " ", "}"}], 
               "\[IndentingNewLine]", "  ", ",", 
               RowBox[{"{", 
                RowBox[{"aPathEntry", ",", " ", "newPathEntries"}], "}"}]}], 
              "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"if", " ", "move", " ", "is", " ", "left"}], ",", " ", 
           RowBox[{"rotate", " ", "frame", " ", "270", " ", "deg"}], ",", " ", 
           RowBox[{"then", " ", "unrotate", " ", "answers"}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"dir", "\[Equal]", "\"\<l\>\""}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<left selected:\>\"", "]"}], ";"}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"s1t", ",", "s2t", ",", "g1t", ",", "g2t"}], "}"}], "=",
              " ", 
             RowBox[{"Map", "[", 
              RowBox[{"rotate270", ",", 
               RowBox[{"{", 
                RowBox[{"s1", ",", "s2", ",", "g1", ",", "g2"}], "}"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"movest", "=", " ", 
             RowBox[{"Map", "[", 
              RowBox[{"rotate270inplace", ",", "moves"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"pm1st", "=", " ", 
             RowBox[{"Map", "[", 
              RowBox[{"rotate270", ",", "pm1"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"pm2st", "=", " ", 
             RowBox[{"Map", "[", 
              RowBox[{"rotate270", ",", "pm2"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"newPathEntries", "=", " ", 
             RowBox[{"wallFrictionMoveUp", "[", 
              RowBox[{
              "s1t", ",", "s2t", ",", "g1t", ",", "g2t", ",", "movest", ",", 
               "pm1st", ",", " ", "pm2st", ",", "\[Epsilon]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"newPathEntries", "=", " ", 
               RowBox[{
               "newPathEntries", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}], ";"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "newPathEntries", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}], " ", "=", " ", 
             RowBox[{"rotate90", "[", 
              RowBox[{
              "newPathEntries", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "newPathEntries", "\[LeftDoubleBracket]", "3", 
              "\[RightDoubleBracket]"}], " ", "=", " ", 
             RowBox[{"rotate90", "[", 
              RowBox[{
              "newPathEntries", "\[LeftDoubleBracket]", "3", 
               "\[RightDoubleBracket]"}], " ", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "newPathEntries", "\[LeftDoubleBracket]", "4", 
              "\[RightDoubleBracket]"}], " ", "=", " ", 
             RowBox[{"Map", "[", 
              RowBox[{"rotate90inplace", ",", " ", 
               RowBox[{
               "newPathEntries", "\[LeftDoubleBracket]", "4", 
                "\[RightDoubleBracket]"}]}], " ", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "newPathEntries", "\[LeftDoubleBracket]", "5", 
              "\[RightDoubleBracket]"}], " ", "=", " ", 
             RowBox[{"Map", "[", 
              RowBox[{"rotate90", ",", " ", 
               RowBox[{
               "newPathEntries", "\[LeftDoubleBracket]", "5", 
                "\[RightDoubleBracket]"}]}], " ", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "newPathEntries", "\[LeftDoubleBracket]", "6", 
              "\[RightDoubleBracket]"}], " ", "=", " ", 
             RowBox[{"Map", "[", 
              RowBox[{"rotate90", ",", " ", 
               RowBox[{
               "newPathEntries", "\[LeftDoubleBracket]", "6", 
                "\[RightDoubleBracket]"}]}], " ", "]"}]}]}]}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"undo", " ", "the", " ", "change"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"newPathEntries", "=", 
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                 "aPathEntry", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"Map", "[", 
                  RowBox[{"rotate270", ",", 
                   RowBox[{
                   "aPathEntry", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "]"}], " ", ",", 
                 RowBox[{"Map", "[", 
                  RowBox[{"rotate270", ",", 
                   RowBox[{
                   "aPathEntry", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Map", "[", 
                  RowBox[{"rotate270inplace", ",", 
                   RowBox[{
                   "aPathEntry", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], " ", "}"}], 
               "\[IndentingNewLine]", "  ", ",", 
               RowBox[{"{", 
                RowBox[{"aPathEntry", ",", " ", "newPathEntries"}], "}"}]}], 
              "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", " ", "[", "newPathEntries", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], 
    RowBox[{"(*", 
     RowBox[{"end", " ", "inner", " ", "module"}], "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  RowBox[{"(*", 
   RowBox[{"end", " ", "outer", " ", "module"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"wallFrictionMoveUp", "[", 
    RowBox[{
    "r1in_", ",", "r2in_", ",", "g1in_", ",", "g2in_", ",", "moves_", ",", 
     "pm1_", ",", " ", "pm2_", " ", ",", " ", "\[Epsilon]_"}], "]"}], ":=", 
   " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "r1", ",", "r2", ",", "g1", ",", "g2", ",", "\[CapitalDelta]gx", ",", 
       "\[CapitalDelta]gy", ",", "m1", ",", "m2", ",", "\[CapitalDelta]tgx", 
       ",", "\[CapitalDelta]tgy", ",", "\[IndentingNewLine]", 
       "\[CapitalDelta]ey", " ", ",", "\[CapitalDelta]ex", " ", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"L", "=", " ", "1"}], " ", 
       RowBox[{"(*", 
        RowBox[{"size", " ", "of", " ", "workspace"}], "*)"}], ",", 
       "\[IndentingNewLine]", "\[CapitalDelta]r", 
       RowBox[{"(*", 
        RowBox[{
        "current", " ", "x", " ", "and", " ", "y", " ", "difference"}], 
        "*)"}], ",", "\[IndentingNewLine]", 
       RowBox[{"path1", "=", " ", "pm1"}], 
       RowBox[{"(*", 
        RowBox[{"desired", " ", "moves", " ", "for", " ", "r1"}], "*)"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"path2", "=", " ", "pm2"}], 
       RowBox[{"(*", 
        RowBox[{"desired", " ", "moves", " ", "for", " ", "r2"}], "*)"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"path", " ", "=", " ", "moves"}], ",", "\[IndentingNewLine]", 
       RowBox[{"isMirrored", " ", "=", " ", "False"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"isFlipped", " ", "=", " ", "False"}]}], "\[IndentingNewLine]",
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "robot", " ", "1", " ", "must", " ", "be", " ", "the", " ", "top", " ",
         "left", " ", 
        RowBox[{"robot", ".", " ", "If"}], " ", "it", " ", "is", " ", "not", 
        " ", "the", " ", "top", " ", "robot"}], ",", " ", 
       RowBox[{"flip", " ", "entries"}], ",", " ", 
       RowBox[{
       "if", " ", "it", " ", "is", " ", "not", " ", "the", " ", "left", " ", 
        "robot"}], ",", " ", 
       RowBox[{"mirror", " ", 
        RowBox[{"entries", ".", " ", "Remember"}], " ", "to", " ", "switch", 
        " ", "again", " ", "at", " ", 
        RowBox[{"end", "!"}], "\[IndentingNewLine]", " ", "then", " ", "move",
         " ", "robot", "  ", "while", " ", "first", " ", "robot", " ", "is", 
        " ", "touching", " ", "wall"}]}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "r1in", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "<", 
         
         RowBox[{
         "r2in", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "r1in", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           ">", 
           RowBox[{
           "r2in", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"r1", ",", "r2", ",", "g1", ",", "g2"}], "}"}], "=", 
            RowBox[{"{", 
             RowBox[{"r2in", ",", "r1in", ",", "g2in", ",", "g1in"}], "}"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"isFlipped", " ", "=", " ", "True"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"r1", ",", "r2", ",", "g1", ",", "g2"}], "}"}], "=", " ", 
            RowBox[{"Map", "[", 
             RowBox[{"mirror", ",", " ", 
              RowBox[{"{", 
               RowBox[{"r2in", ",", "r1in", ",", "g2in", ",", "g1in"}], 
               "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"path", " ", "=", " ", 
            RowBox[{"Map", "[", 
             RowBox[{"mirrorInplace", ",", " ", "moves"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"isFlipped", " ", "=", " ", "True"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"isMirrored", " ", "=", " ", "True"}]}]}], "]"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "r1in", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            ">", 
            RowBox[{
            "r2in", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"r1", ",", "r2", ",", "g1", ",", "g2"}], "}"}], "=", 
             " ", 
             RowBox[{"Map", "[", 
              RowBox[{"mirror", ",", " ", 
               RowBox[{"{", 
                RowBox[{"r1in", ",", "r2in", ",", "g1in", ",", "g2in"}], 
                "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"path", " ", "=", " ", 
             RowBox[{"Map", "[", 
              RowBox[{"mirrorInplace", ",", " ", "moves"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"isMirrored", "=", " ", "True"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"r1", ",", "r2", ",", "g1", ",", "g2"}], "}"}], "=", 
            RowBox[{"{", 
             RowBox[{"r1in", ",", "r2in", ",", "g1in", ",", "g2in"}], 
             "}"}]}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[CapitalDelta]gx", ",", "\[CapitalDelta]gy"}], "}"}], " ", 
       "=", " ", 
       RowBox[{"g2", "-", "g1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "If", " ", "the", " ", "second", " ", "robot", " ", "is", " ", 
         "already", " ", "touching", " ", "the", " ", "up", " ", "wall"}], 
        ",", " ", 
        RowBox[{"just", " ", 
         RowBox[{"return", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"r2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
          "\[Equal]", " ", "1"}], ",", " ", 
        RowBox[{"Return", " ", "[", 
         RowBox[{"{", 
          RowBox[{
          "Infinity", ",", " ", "r1", ",", " ", "r2", ",", " ", "path", ",", 
           " ", "path1", ",", " ", "path2", " ", ",", " ", "False"}], "}"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"if", " ", "the", " ", "goal", " ", "\[CapitalDelta]gx"}], 
        ",", 
        RowBox[{"\[CapitalDelta]gy", " ", "is", " ", "achievable"}], ",", " ", 
        RowBox[{"do", " ", "it", " ", "in", " ", "one", " ", 
         RowBox[{"move", ".", " ", "Otherwise"}]}], ","}], " ", "*)"}], " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "r2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "-", 
           " ", 
           RowBox[{
           "r1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "-", 
           "1", "+", 
           RowBox[{"2", "\[Epsilon]"}]}], "\[LessEqual]", "  ", 
          "\[CapitalDelta]gx", " ", "\[LessEqual]", "  ", 
          RowBox[{"1", " ", "-", 
           RowBox[{"2", "\[Epsilon]"}]}]}], " ", "&&", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
           "r2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "-", 
           " ", 
           RowBox[{
           "r1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
          " ", "\[LessEqual]", " ", "\[CapitalDelta]gy", "\[LessEqual]", "  ",
           "0"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<Achievable\>\"", " ", "]"}], ";"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"in", " ", "Achievable", " ", "range"}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "move", " ", "r1", " ", "and", " ", "r2", " ", "so", " ", "that", 
          " ", "r1", " ", "will", " ", "touch", " ", "the", " ", "up", " ", 
          "wall", " ", "in", " ", "the", " ", "line", " ", "of", " ", "the", 
          " ", "goal"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m1", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{"1", "-", 
               RowBox[{
               "r1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
              RowBox[{"2", "-", 
               RowBox[{
               "g1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               "-", " ", 
               RowBox[{
               "r1", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}]}]], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "g1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "-", 
               RowBox[{
               "r1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
               ")"}]}], ",", 
            RowBox[{"1", "-", 
             RowBox[{
             "r1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}],
            "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<checking m1\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "m1", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<checking r1\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "r1", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<checking r2\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "r2", "]"}], ";"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
             "r1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "\[Equal]", "1"}], " ", "&&", " ", 
            RowBox[{
             RowBox[{
             "m1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             " ", "\[NotEqual]", " ", "0"}]}], ",", " ", 
           RowBox[{
            RowBox[{"m1", " ", "=", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], ";", " ", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", "\"\<Why not then?!\>\"", "]"}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"Print", "[", "r1", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Print", "[", "r2", "]"}], ";"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"m2", " ", "=", " ", 
             RowBox[{"{", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"\[CapitalDelta]gx", " ", "\[GreaterEqual]", " ", 
                 RowBox[{
                  RowBox[{
                  "r2", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], " ", "-", 
                  RowBox[{
                  "r1", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}]}], ",", 
                RowBox[{"Min", "[", 
                 RowBox[{
                  RowBox[{"1", "-", "\[Epsilon]", "-", 
                   RowBox[{
                   "r2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", 
                  RowBox[{"\[CapitalDelta]gx", "-", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "r2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "r1", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ")"}]}]}], "]"}], " ", ",", 
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{"\[CapitalDelta]gx", "-", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "r2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "r1", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ")"}]}], ",", " ", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{
                    "r2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "+", " ", "\[Epsilon]"}]}], 
                 "]"}], ",", " ", 
                RowBox[{"\[CapitalDelta]gy", "-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                   "r2", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", 
                   RowBox[{
                   "r1", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], ")"}]}]}], "]"}], "}"}]}], 
            ";", " ", 
            RowBox[{"r2", " ", "+=", " ", "m2"}]}], "\[IndentingNewLine]", 
           ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<here is making a mistake?\>\"", "]"}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"Print", "[", "\"\<Path length\>\"", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Print", "[", "path", "]"}], ";", "\[IndentingNewLine]", 
             
             RowBox[{"Print", "[", "r1", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"Print", "[", "r2", "]"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "r1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               "\[NotEqual]", " ", "1"}], ",", " ", 
              RowBox[{
               RowBox[{"r1", "+=", " ", "m1"}], ";", " ", 
               RowBox[{"r2", "+=", "m1"}], ";"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "r2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               ">", 
               RowBox[{"1", "-", "\[Epsilon]"}]}], ",", 
              RowBox[{
               RowBox[{"r1", " ", "-=", " ", "m1"}], ";", " ", 
               RowBox[{"r2", " ", "-=", " ", "m1"}], ";", "  ", 
               RowBox[{"m1", " ", "=", 
                RowBox[{"{", " ", 
                 RowBox[{
                  RowBox[{"1", "-", 
                   RowBox[{
                   "r2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-", "\[Epsilon]"}], ",", 
                  RowBox[{"1", "-", 
                   RowBox[{
                   "r1", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}]}], "}"}]}], ";", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "r1", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "\[NotEqual]", " ", "1"}], ",", 
                 " ", 
                 RowBox[{
                  RowBox[{"r1", "+=", " ", "m1"}], ";", " ", 
                  RowBox[{"r2", "+=", " ", "m1"}]}]}], "]"}]}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "r2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "<", "\[Epsilon]"}], ",", " ", 
              RowBox[{
               RowBox[{"r1", " ", "-=", " ", "m1"}], ";", " ", 
               RowBox[{"r2", " ", "-=", " ", "m1"}], ";", " ", 
               RowBox[{"m1", " ", "=", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", " ", 
                    RowBox[{
                    "r2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "+", "\[Epsilon]"}], ",", 
                  " ", 
                  RowBox[{"1", "-", 
                   RowBox[{
                   "r1", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}]}], "}"}]}], ";", " ", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "r1", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "\[NotEqual]", " ", "1"}], ",", 
                 " ", 
                 RowBox[{
                  RowBox[{"r1", "+=", " ", "m1"}], ";", " ", 
                  RowBox[{"r2", " ", "+=", " ", "m1"}]}]}], "]"}]}]}], "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "r1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               " ", "<", " ", "\[Epsilon]"}], ",", " ", 
              RowBox[{
               RowBox[{"r1", "-=", " ", "m1"}], ";", " ", 
               RowBox[{"r2", " ", "-=", " ", "m1"}], ";", " ", 
               RowBox[{"m1", " ", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Epsilon]", "-", 
                   RowBox[{
                   "r1", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", " ", 
                  RowBox[{"1", " ", "-", " ", 
                   RowBox[{
                   "r1", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}]}], "}"}]}], ";", "  ", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "r1", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "\[NotEqual]", " ", "1"}], ",", 
                 " ", 
                 RowBox[{
                  RowBox[{"r1", "+=", " ", "m1"}], ";", " ", 
                  RowBox[{"r2", " ", "+=", " ", "m1"}]}]}], "]"}]}]}], "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "r1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               ">", " ", 
               RowBox[{"1", "-", "\[Epsilon]"}]}], ",", " ", 
              RowBox[{
               RowBox[{"r1", "-=", " ", "m1"}], ";", " ", 
               RowBox[{"r2", " ", "-=", " ", "m1"}], ";", " ", 
               RowBox[{"m1", " ", "=", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"1", "-", "\[Epsilon]", "-", 
                   RowBox[{
                   "r1", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", " ", 
                  RowBox[{"1", "-", 
                   RowBox[{
                   "r1", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}]}], "}"}]}], ";", " ", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "r1", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "\[NotEqual]", " ", "1"}], ",", 
                 " ", 
                 RowBox[{
                  RowBox[{"r1", "+=", " ", "m1"}], ";", " ", 
                  RowBox[{"r2", " ", "+=", " ", "m1"}]}]}], "]"}]}]}], "]"}], 
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "move", " ", "r2", " ", "to", " ", "get", " ", "correct", " ", 
              "spacing"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"m2", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[CapitalDelta]gx", "-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                  "r2", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "-", 
                  RowBox[{
                  "r1", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], ")"}]}], ",", 
               RowBox[{"\[CapitalDelta]gy", "-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                  "r2", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "-", 
                  RowBox[{
                  "r1", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}], ")"}]}]}], " ", "}"}]}], ";", 
            
            RowBox[{"r2", " ", "+=", " ", "m2"}], ";", "\[IndentingNewLine]", 
            
            RowBox[{"(*", 
             RowBox[{
              RowBox[{
              "if", " ", "r2", " ", "is", " ", "getting", " ", "out", " ", 
               "of", " ", "bound"}], ",", " ", 
              RowBox[{
              "change", " ", "m1", " ", "and", " ", "m2", " ", "so", " ", 
               "that", " ", "it", " ", "would", " ", "stay", " ", "in", " ", 
               "the", " ", "bound"}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "r2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               ">", 
               RowBox[{"1", "-", "\[Epsilon]"}]}], ",", " ", 
              RowBox[{
               RowBox[{"r1", " ", "-=", " ", "m1"}], ";", " ", 
               RowBox[{"r2", "-=", " ", "m2"}], ";", " ", 
               RowBox[{"r2", "-=", "m1"}], ";", " ", 
               RowBox[{"m1", " ", "=", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "\[CapitalDelta]gx"}], ")"}], "-", 
                    RowBox[{
                    "r1", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", 
                    RowBox[{
                    "r1", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], "+", "\[Epsilon]"}],
                   ",", 
                  RowBox[{"1", "-", 
                   RowBox[{
                   "r1", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}]}], "}"}]}], ";", " ", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "r1", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "\[NotEqual]", " ", "1"}], ",", 
                 " ", 
                 RowBox[{
                  RowBox[{"r1", "+=", " ", "m1"}], ";"}]}], "]"}], " ", ";", 
               RowBox[{"r2", "+=", "m1"}], ";", 
               RowBox[{"m2", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Min", "[", 
                   RowBox[{
                    RowBox[{"\[CapitalDelta]gx", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "r2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "r1", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ")"}]}], ",", " ", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    "r2", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}]}], "]"}], ",", 
                  RowBox[{"\[CapitalDelta]gy", "-", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "r2", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "r1", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], ")"}]}]}], " ", "}"}]}], ";",
                " ", 
               RowBox[{"r2", "+=", " ", "m2"}]}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "r2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "<", "\[Epsilon]"}], ",", " ", 
              RowBox[{
               RowBox[{"r1", " ", "-=", " ", "m1"}], ";", " ", 
               RowBox[{"r2", "-=", " ", "m2"}], ";", " ", 
               RowBox[{"r2", "-=", "m1"}], ";", " ", 
               RowBox[{"m1", " ", "=", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"\[CapitalDelta]gx", "-", 
                    RowBox[{
                    "r1", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", " ", 
                    RowBox[{"Abs", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    "r2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], "]"}], "-", 
                   "\[Epsilon]"}], ",", 
                  RowBox[{"1", "-", 
                   RowBox[{
                   "r1", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}]}], "}"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "r1", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "\[NotEqual]", " ", "1"}], ",", 
                 " ", 
                 RowBox[{
                  RowBox[{"r1", "+=", " ", "m1"}], ";", " ", 
                  RowBox[{"r2", "+=", "m1"}]}]}], "]"}], ";", 
               RowBox[{"m2", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Max", "[", 
                   RowBox[{
                    RowBox[{"\[CapitalDelta]gx", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "r2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "r1", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ")"}]}], ",", " ", 
                    RowBox[{"-", 
                    RowBox[{
                    "r2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}]}], "]"}], ",", 
                  RowBox[{"\[CapitalDelta]gy", "-", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "r2", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "r1", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], ")"}]}]}], " ", "}"}]}], ";",
                " ", 
               RowBox[{"r2", "+=", " ", "m2"}]}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]",
           "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"not", " ", "achievable", " ", "range"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "move", " ", "the", " ", "robots", " ", "to", " ", "minimize", " ", 
          "the", " ", 
          RowBox[{"error", ".", "  ", "Gets"}], " ", "the", " ", "minimum", 
          " ", "distance", " ", "to", " ", "the", " ", "wall", " ", "to", " ",
           "make", " ", "minimize", " ", "the", " ", 
          RowBox[{"error", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<not achieveable\>\"", "]"}], ";"}], 
         "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
             "r2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "-", " ", 
             RowBox[{
             "r1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "-", "1", "+", 
             RowBox[{"2", "\[Epsilon]"}]}], ">", "   ", "\[CapitalDelta]gx"}],
            " ", ",", " ", 
           RowBox[{"\[CapitalDelta]tgx", " ", "=", " ", 
            RowBox[{
             RowBox[{
             "r2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "-", " ", 
             RowBox[{
             "r1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "-", "1", "+", 
             RowBox[{"2", "\[Epsilon]"}]}]}], ",", "  ", 
           RowBox[{
           "\[CapitalDelta]tgx", " ", "=", "  ", "\[CapitalDelta]gx"}]}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", " ", 
          RowBox[{
           RowBox[{"\[CapitalDelta]gy", " ", ">", " ", "0"}], ",", "  ", 
           RowBox[{"\[CapitalDelta]tgy", " ", "=", " ", "0"}], ",", " ", 
           RowBox[{
           "\[CapitalDelta]tgy", " ", "=", " ", "\[CapitalDelta]gy"}]}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"\[CapitalDelta]gy", "  ", "<", " ", 
            RowBox[{
             RowBox[{
             "r2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "-", " ", 
             RowBox[{
             "r1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}],
            ",", "  ", 
           RowBox[{"\[CapitalDelta]tgy", " ", "=", " ", 
            RowBox[{
             RowBox[{
             "r2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "-", " ", 
             RowBox[{
             "r1", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"m1", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "r1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "<", " ", "\[Epsilon]"}], " ", ",", " ", 
              RowBox[{"\[Epsilon]", "-", 
               RowBox[{
               "r1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
               ",", " ", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "r1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                  ">", 
                 RowBox[{"1", "-", "\[Epsilon]"}]}], ",", " ", 
                RowBox[{"1", "-", "\[Epsilon]", "-", 
                 RowBox[{
                 "r1", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], ",", "0"}], "]"}]}], "]"}], 
            ",", " ", 
            RowBox[{"1", "-", " ", 
             RowBox[{
             "r1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}],
            "}"}]}], ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "r1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "\[NotEqual]", " ", "1"}], ",", " ", 
           RowBox[{
            RowBox[{"r1", "+=", " ", "m1"}], ";", 
            RowBox[{"r2", "+=", " ", "m1"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "r2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ">", 
            RowBox[{"1", "-", "\[Epsilon]"}]}], ",", 
           RowBox[{
            RowBox[{"r1", " ", "-=", " ", "m1"}], ";", " ", 
            RowBox[{"r2", " ", "-=", " ", "m1"}], ";", " ", 
            RowBox[{"m1", " ", "=", 
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{"1", "-", 
                RowBox[{
                "r2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                "-", "\[Epsilon]"}], ",", 
               RowBox[{"1", "-", 
                RowBox[{
                "r1", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}]}]}], "}"}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "r1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               "\[NotEqual]", " ", "1"}], ",", " ", 
              RowBox[{
               RowBox[{"r1", "+=", " ", "m1"}], ";", " ", 
               RowBox[{"r2", "+=", " ", "m1"}]}]}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "r2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "<",
             "\[Epsilon]"}], ",", " ", 
           RowBox[{
            RowBox[{"r1", " ", "-=", " ", "m1"}], ";", " ", 
            RowBox[{"r2", " ", "-=", " ", "m1"}], ";", " ", 
            RowBox[{"m1", " ", "=", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", " ", 
                 RowBox[{
                 "r2", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "+", "\[Epsilon]"}], ",", " ", 
               
               RowBox[{"1", "-", 
                RowBox[{
                "r1", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}]}]}], "}"}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "r1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               "\[NotEqual]", " ", "1"}], ",", " ", 
              RowBox[{
               RowBox[{"r1", "+=", " ", "m1"}], ";", " ", 
               RowBox[{"r2", " ", "+=", " ", "m1"}]}]}], "]"}]}]}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "r1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], " ",
             "<", " ", "\[Epsilon]"}], ",", " ", 
           RowBox[{
            RowBox[{"r1", "-=", " ", "m1"}], ";", " ", 
            RowBox[{"r2", " ", "-=", " ", "m1"}], ";", " ", 
            RowBox[{"m1", " ", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Epsilon]", "-", 
                RowBox[{
                "r1", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], ",", " ", 
               RowBox[{"1", " ", "-", " ", 
                RowBox[{
                "r1", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}]}]}], "}"}]}], ";", "  ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "r1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               "\[NotEqual]", " ", "1"}], ",", " ", 
              RowBox[{
               RowBox[{"r1", "+=", " ", "m1"}], ";", " ", 
               RowBox[{"r2", " ", "+=", " ", "m1"}]}]}], "]"}]}]}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "r1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ">",
             " ", 
            RowBox[{"1", "-", "\[Epsilon]"}]}], ",", " ", 
           RowBox[{
            RowBox[{"r1", "-=", " ", "m1"}], ";", " ", 
            RowBox[{"r2", " ", "-=", " ", "m1"}], ";", " ", 
            RowBox[{"m1", " ", "=", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"1", "-", "\[Epsilon]", "-", 
                RowBox[{
                "r1", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], ",", " ", 
               RowBox[{"1", "-", 
                RowBox[{
                "r1", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}]}]}], "}"}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "r1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               "\[NotEqual]", " ", "1"}], ",", " ", 
              RowBox[{
               RowBox[{"r1", "+=", " ", "m1"}], ";", " ", 
               RowBox[{"r2", " ", "+=", " ", "m1"}]}]}], "]"}]}]}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"m2", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[CapitalDelta]tgx", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "r2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "-", 
               RowBox[{
               "r1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
               ")"}]}], ",", 
            RowBox[{"\[CapitalDelta]tgy", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "r2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               "-", 
               RowBox[{
               "r1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
               ")"}]}]}], " ", "}"}]}], ";", 
         RowBox[{"r2", " ", "+=", " ", "m2"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "r2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ">",
             "1"}], ",", " ", 
           RowBox[{
            RowBox[{"r1", " ", "-=", " ", "m1"}], ";", " ", 
            RowBox[{"r2", "-=", " ", "m2"}], ";", " ", 
            RowBox[{"r2", "-=", "m1"}], ";", " ", 
            RowBox[{"m1", " ", "=", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"Min", "[", 
                  RowBox[{
                   RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "\[CapitalDelta]tgx"}], ")"}], "-", 
                    RowBox[{
                    "r1", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", 
                   RowBox[{
                   "r1", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], "+", "\[Epsilon]"}],
                ",", 
               RowBox[{"1", "-", 
                RowBox[{
                "r1", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}]}]}], "}"}]}], ";", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "r1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               "\[NotEqual]", " ", "1"}], ",", " ", 
              RowBox[{
               RowBox[{"r1", "+=", " ", "m1"}], ";"}]}], "]"}], " ", ";", 
            RowBox[{"r2", "+=", "m1"}], ";", 
            RowBox[{"m2", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Min", "[", 
                RowBox[{
                 RowBox[{"\[CapitalDelta]tgx", "-", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    "r2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "r1", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ")"}]}], ",", " ", 
                 RowBox[{"1", "-", 
                  RowBox[{
                  "r2", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}]}], "]"}], ",", 
               RowBox[{"\[CapitalDelta]tgy", "-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                  "r2", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "-", 
                  RowBox[{
                  "r1", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}], ")"}]}]}], " ", "}"}]}], ";", 
            " ", 
            RowBox[{"r2", "+=", " ", "m2"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "r2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "<",
             "0"}], ",", " ", 
           RowBox[{
            RowBox[{"r1", " ", "-=", " ", "m1"}], ";", " ", 
            RowBox[{"r2", "-=", " ", "m2"}], ";", " ", 
            RowBox[{"r2", "-=", "m1"}], ";", " ", 
            RowBox[{"m1", " ", "=", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"Min", "[", 
                 RowBox[{
                  RowBox[{"Abs", "[", 
                   RowBox[{"\[CapitalDelta]tgx", "-", 
                    RowBox[{
                    "r1", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", " ", 
                  RowBox[{"Abs", "[", 
                   RowBox[{"1", "-", 
                    RowBox[{
                    "r2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], "]"}], "-", 
                "\[Epsilon]"}], ",", 
               RowBox[{"1", "-", 
                RowBox[{
                "r1", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}]}]}], "}"}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "r1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               "\[NotEqual]", " ", "1"}], ",", " ", 
              RowBox[{
               RowBox[{"r1", "+=", " ", "m1"}], ";", " ", 
               RowBox[{"r2", "+=", "m1"}]}]}], "]"}], ";", 
            RowBox[{"m2", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{
                 RowBox[{"\[CapitalDelta]tgx", "-", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    "r2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "r1", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ")"}]}], ",", " ", 
                 RowBox[{"-", 
                  RowBox[{
                  "r2", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}]}], "]"}], ",", 
               RowBox[{"\[CapitalDelta]tgy", "-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                  "r2", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "-", 
                  RowBox[{
                  "r1", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}], ")"}]}]}], " ", "}"}]}], ";", 
            " ", 
            RowBox[{"r2", "+=", " ", "m2"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{
               "r1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "-", 
               RowBox[{
               "r2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
               "]"}], "<", " ", "\[Epsilon]"}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{
               "r1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               " ", "-", 
               RowBox[{
               "r2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
               "]"}], "<", "\[Epsilon]"}]}], ",", "  ", 
           RowBox[{
            RowBox[{"r2", " ", "-=", " ", "m2"}], ";", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "r1", " ", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "\[GreaterEqual]", " ", 
               RowBox[{"2", "\[Epsilon]"}]}], ",", " ", 
              RowBox[{
               RowBox[{
               "m2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               " ", "-=", " ", "\[Epsilon]"}], ",", " ", 
              RowBox[{
               RowBox[{
               "m2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               " ", "+=", " ", "\[Epsilon]"}]}], "]"}], ";", " ", 
            RowBox[{"r2", " ", "+=", " ", "m2"}]}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"path", ",", " ", "m1"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"r2", " ", "-=", " ", "m2"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"isMirrored", ",", 
        RowBox[{"If", "[", 
         RowBox[{"isFlipped", ",", " ", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"path1", ",", " ", 
             RowBox[{"mirror", "[", "r2", "]"}]}], "]"}], ";", " ", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"path2", ",", 
             RowBox[{"mirror", "[", "r1", "]"}]}], "]"}]}], ",", " ", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"path1", ",", " ", 
             RowBox[{"mirror", "[", "r1", "]"}]}], "]"}], ";", " ", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"path2", ",", 
             RowBox[{"mirror", "[", "r2", "]"}]}], "]"}]}]}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{"isFlipped", ",", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"path1", ",", " ", "r2"}], "]"}], ";", " ", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"path2", ",", "r1"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"path1", ",", "r1"}], "]"}], ";", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"path2", ",", "r2"}], "]"}]}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"r2", " ", "+=", " ", "m2"}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"path", ",", " ", "m2"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Change", " ", "the", " ", "robots", " ", "back", " ", "if", " ", 
        "they", " ", "were", " ", "mirrored"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"isMirrored", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"path", " ", "=", " ", 
          RowBox[{"Map", "[", 
           RowBox[{"mirrorInplace", ",", " ", "path"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"r1", ",", "r2"}], "}"}], " ", "=", " ", 
          RowBox[{"Map", "[", 
           RowBox[{"mirror", ",", 
            RowBox[{"{", 
             RowBox[{"r1", ",", "r2"}], "}"}]}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Change", " ", "the", " ", "robots", " ", "back", " ", "if", " ", 
        "they", " ", "were", " ", "flipped"}], "*)"}], "\[IndentingNewLine]", 
      
      RowBox[{"If", "[", 
       RowBox[{"isFlipped", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"path1", ",", " ", "r2"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"path2", ",", "r1"}], "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"If", "[", " ", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"0.00001", "<", 
                 RowBox[{
                 "m2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                  "<", "0.00001"}], " ", "&&", " ", 
                RowBox[{"0.00001", "<", 
                 RowBox[{
                 "m2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                  "<", "0.00001"}]}], "||", " ", 
               RowBox[{
                RowBox[{"Length", "[", "path", "]"}], ">", " ", "8"}]}], ",", 
              "Infinity", ",", 
              RowBox[{
               RowBox[{"distanceMoved", "[", " ", "path", "]"}], "+", " ", 
               RowBox[{"admissibleHeuristic", "[", 
                RowBox[{"r2", ",", "r1", ",", "g2", ",", "g1"}], "]"}]}]}], 
             "]"}], ",", "r2", ",", "r1", ",", "path", ",", "path1", ",", " ",
             "path2", ",", " ", "False"}], "}"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"path1", ",", " ", "r1"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"path2", ",", "r2"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"If", "[", " ", 
             RowBox[{
              RowBox[{"m2", " ", "\[Equal]", " ", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}]}], ",", " ", "Infinity", ",", 
              RowBox[{
               RowBox[{"distanceMoved", "[", " ", "path", "]"}], "+", " ", 
               RowBox[{"admissibleHeuristic", "[", 
                RowBox[{"r1", ",", "r2", ",", "g1", ",", "g2"}], "]"}]}]}], 
             "]"}], ",", "r1", ",", "r2", ",", "path", ",", "path1", ",", 
            "path2", " ", ",", "False"}], " ", "}"}], "  ", "]"}]}]}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "rotate", " ", "the", " ", "coordinate", " ", "frame", " ", "90", " ", 
    "degrees"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rotate90", "[", "r_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "-", " ", 
      RowBox[{"r", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
     ",", " ", 
     RowBox[{"r", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
    "}"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "changes", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rotate90inplace", "[", "r_", "]"}], ":=", 
  RowBox[{"{", " ", 
   RowBox[{
    RowBox[{"r", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
    " ", 
    RowBox[{"-", 
     RowBox[{"r", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rotate270", "[", "r_", "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"r", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
    
    RowBox[{"1", "-", " ", 
     RowBox[{"r", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rotate270inplace", "[", "r_", "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"r", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
    ",", " ", 
    RowBox[{"r", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rotate180", "[", "r_", "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"1", "-", 
     RowBox[{"r", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
    ",", 
    RowBox[{"1", "-", " ", 
     RowBox[{"r", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rotate180inplace", "[", "r_", "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"r", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
    ",", 
    RowBox[{"-", " ", 
     RowBox[{"r", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mirror", "[", "r_", "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"1", "-", 
     RowBox[{"r", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
    ",", 
    RowBox[{"r", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mirrorInplace", "[", "r_", "]"}], ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"r", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
     ",", 
     RowBox[{"r", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
    "}"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"distanceMoved", "[", "moves_", "]"}], ":=", " ", 
  RowBox[{"Total", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Norm", "[", "m", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "moves"}], "}"}]}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{
  3.696850625448679*^9, {3.696850996220438*^9, 3.696851103052491*^9}, {
   3.696851194998704*^9, 3.696851316178563*^9}, {3.696851577007532*^9, 
   3.696851646191337*^9}, {3.696851685831353*^9, 3.696851940888309*^9}, {
   3.696851979618774*^9, 3.6968520031748133`*^9}, {3.696852055576043*^9, 
   3.696852064989345*^9}, 3.69685209547946*^9, {3.696852285011389*^9, 
   3.6968522883725643`*^9}, {3.696852359225856*^9, 3.6968523868727093`*^9}, {
   3.696852769102359*^9, 3.6968527700432796`*^9}, {3.6968556886014347`*^9, 
   3.696855691643488*^9}, {3.696856527363636*^9, 3.696856530175981*^9}, {
   3.696856822372416*^9, 3.696856827747609*^9}, {3.696857185516718*^9, 
   3.696857214541087*^9}, 3.696857276824493*^9, {3.69685735680696*^9, 
   3.6968573573432713`*^9}, {3.696857509567692*^9, 3.696857528263513*^9}, {
   3.696857635596796*^9, 3.696857638089617*^9}, {3.6968594310167847`*^9, 
   3.696859433636877*^9}, {3.696859643854381*^9, 3.6968596490986633`*^9}, {
   3.6968599245803757`*^9, 3.696859926111636*^9}, {3.6968600659903*^9, 
   3.696860146165489*^9}, {3.69686022761596*^9, 3.6968602336530113`*^9}, {
   3.696860325531705*^9, 3.6968603656463947`*^9}, {3.696860486645093*^9, 
   3.696860499110642*^9}, {3.6968606294638433`*^9, 3.696860633592042*^9}, {
   3.696860677390544*^9, 3.696860686405753*^9}, {3.6968607520202827`*^9, 
   3.696860776276743*^9}, {3.696860838040374*^9, 3.696860851352022*^9}, {
   3.696861004062735*^9, 3.6968610226545153`*^9}, {3.696862496778556*^9, 
   3.6968624985726767`*^9}, {3.6968631746853027`*^9, 3.696863236929758*^9}, {
   3.696863778081951*^9, 3.69686383196033*^9}, {3.696866509043564*^9, 
   3.696866593938442*^9}, {3.6968666542593393`*^9, 3.696866668980568*^9}, 
   3.6968667836050863`*^9, {3.696866955945607*^9, 3.6968669562134867`*^9}, {
   3.696866999018618*^9, 3.696866999591332*^9}, {3.696874232202565*^9, 
   3.696874305325038*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Function", " ", "that", " ", "does", " ", "an", " ", "A", "*", " ", 
    "search", " ", "to", " ", "find", " ", "the", " ", "shortest", " ", 
    "path"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"optimal2robotPath", "[", 
    RowBox[{
    "s1_", ",", "s2_", ",", " ", "g1_", ",", "g2_", ",", "\[Epsilon]_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "optimalPathList", ",", "bestMoveSeq", ",", " ", "dist1", ",", " ", 
       RowBox[{"iter", "=", "0"}]}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"{", 
       RowBox[{
        StyleBox[
         RowBox[{"e", 
          StyleBox["stimatedPathLength", "Text",
           FontWeight->"Bold"]}]], ",", "r1", ",", "r2", ",", "MOVES"}], 
       "}"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"optimalPathList", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"Infinity", ",", "s1", ",", "s2", ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "}"}], ",", 
          RowBox[{"{", "s1", "}"}], ",", 
          RowBox[{"{", "s2", "}"}], ",", "False"}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dist1", " ", "=", " ", 
       RowBox[{"distanceMoved", "[", " ", 
        RowBox[{
         RowBox[{"admissibleHeuristic", "[", 
          RowBox[{"s1", ",", "s2", ",", " ", "g1", ",", "g2"}], "]"}], "+", 
         "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"optimalPathList", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "7"}], "\[RightDoubleBracket]"}], " ", 
         "\[NotEqual]", "  ", "True"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "pathToExplore", ",", "r1", ",", "r2", ",", "wallMoves", ",", 
            "moves", ",", "pm1", ",", " ", "pm2", ",", " ", 
            "isPathComplete"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"body", " ", "of", " ", "while", " ", "loop"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"pathToExplore", " ", "=", " ", 
            RowBox[{"First", "[", "optimalPathList", "]"}]}], ";", " ", 
           RowBox[{"(*", 
            RowBox[{"pop", " ", "off", " ", "first", " ", "entry"}], "*)"}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"optimalPathList", "=", " ", 
            RowBox[{"Delete", "[", 
             RowBox[{"optimalPathList", ",", "1"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"r1", " ", "=", " ", 
            RowBox[{
            "pathToExplore", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"r2", " ", "=", " ", 
            RowBox[{
            "pathToExplore", "\[LeftDoubleBracket]", "3", 
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"moves", "=", " ", 
            RowBox[{
            "pathToExplore", "\[LeftDoubleBracket]", "4", 
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"pm1", " ", "=", " ", 
            RowBox[{
            "pathToExplore", "\[LeftDoubleBracket]", "5", 
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"pm2", " ", "=", " ", 
            RowBox[{
            "pathToExplore", "\[LeftDoubleBracket]", "6", 
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"isPathComplete", " ", "=", " ", 
            RowBox[{
            "pathToExplore", "\[LeftDoubleBracket]", "7", 
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"iter", " ", "+=", " ", "1"}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"isPathComplete", " ", "\[NotEqual]", " ", "True"}], ",",
              "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Table", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"wallMoves", " ", "=", " ", 
                  RowBox[{"wallFrictionMoveDir", "[", 
                   RowBox[{
                   "dir", ",", "r1", ",", "r2", ",", "g1", ",", "g2", ",", 
                    "moves", ",", "pm1", ",", " ", "pm2", ",", " ", 
                    "\[Epsilon]"}], "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"optimalPathList", "=", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"optimalPathList", ",", "wallMoves"}], "]"}]}], 
                 ";"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"dir", ",", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<u\>\"", ",", "\"\<d\>\"", ",", "\"\<l\>\"", ",", 
                    "\"\<r\>\""}], "}"}]}], "}"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"optimalPathList", " ", "=", " ", 
               RowBox[{"SortBy", "[", 
                RowBox[{"optimalPathList", ",", " ", "First"}], "]"}]}], 
              ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "]"}]}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"return", " ", "the", " ", "best", " ", "movement"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
          "optimalPathList", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "4", 
          "\[RightDoubleBracket]"}], ",", " ", 
         RowBox[{
          RowBox[{
          "optimalPathList", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "5", 
          "\[RightDoubleBracket]"}], ",", " ", 
         RowBox[{
          RowBox[{
          "optimalPathList", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "6", 
          "\[RightDoubleBracket]"}]}], "}"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.69678480233032*^9, 3.696784813842106*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"movesAndPositions", ",", "path", ",", 
        RowBox[{"(*", 
         RowBox[{"paths", " ", "for", " ", "each", " ", "robot"}], "*)"}], 
        "path1", ",", "path2", ",", "\[IndentingNewLine]", 
        RowBox[{"r", " ", "=", " ", 
         RowBox[{"1", "/", "40"}]}], " ", 
        RowBox[{"(*", 
         RowBox[{
         "radius", " ", "of", " ", "start", " ", "and", " ", "end", " ", 
          "markers"}], "*)"}], ",", "\[IndentingNewLine]", 
        RowBox[{"thickness", " ", "=", " ", "0.002"}], ",", "rotateSolution", 
        ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"left", " ", "robot"}], "*)"}], " ", "ps1", ",", "pe1", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"right", " ", "robot"}], "*)"}], " ", "ps2", ",", "pe2", ",",
         "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"current", " ", "particle", " ", "position"}], "*)"}], " ", 
        "pm1", ",", "pm2", ",", "offset", ",", "\[IndentingNewLine]", 
        RowBox[{"c1", "=", "Blue"}], ",", 
        RowBox[{"c2", " ", "=", "Magenta"}], ",", "\[IndentingNewLine]", 
        "mvNum", ",", "\[IndentingNewLine]", "mvFrac"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"(*", 
        RowBox[{
        "ensure", " ", "robots", " ", "do", " ", "not", " ", "overlap"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"EuclideanDistance", "[", 
            RowBox[{"s1", ",", "s2"}], "]"}], "<", "\[Epsilon]"}], ",", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "s1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "s2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "s1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               ">", 
               RowBox[{"2", "\[Epsilon]"}]}], ",", 
              RowBox[{
               RowBox[{
               "s1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               " ", "=", 
               RowBox[{
                RowBox[{
                "s2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                " ", "-", " ", "\[Epsilon]"}]}], ",", 
              RowBox[{
               RowBox[{
               "s2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               " ", "=", 
               RowBox[{
                RowBox[{
                "s1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                " ", "+", "\[Epsilon]"}]}]}], "]"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "s2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               ">", 
               RowBox[{"2", "\[Epsilon]"}]}], ",", 
              RowBox[{
               RowBox[{
               "s2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "=", " ", 
               RowBox[{
                RowBox[{
                "s1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                "-", " ", "\[Epsilon]"}]}], ",", 
              RowBox[{
               RowBox[{
               "s1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               " ", "=", 
               RowBox[{
                RowBox[{
                "s2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                "+", " ", "\[Epsilon]"}]}]}], "]"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"EuclideanDistance", "[", 
            RowBox[{"e1", ",", "e2"}], "]"}], "<", "\[Epsilon]"}], ",", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "e1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "<", 
             RowBox[{
             "e2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "e1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               ">", 
               RowBox[{"2", "\[Epsilon]"}]}], ",", 
              RowBox[{
               RowBox[{
               "e1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               " ", "=", 
               RowBox[{
                RowBox[{
                "e2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                " ", "-", " ", "\[Epsilon]"}]}], ",", 
              RowBox[{
               RowBox[{
               "e2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               " ", "=", 
               RowBox[{
                RowBox[{
                "e1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                " ", "+", "\[Epsilon]"}]}]}], "]"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "e2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               ">", 
               RowBox[{"2", "\[Epsilon]"}]}], ",", 
              RowBox[{
               RowBox[{
               "e2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "=", " ", 
               RowBox[{
                RowBox[{
                "e1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                "-", " ", "\[Epsilon]"}]}], ",", 
              RowBox[{
               RowBox[{
               "e1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               " ", "=", 
               RowBox[{
                RowBox[{
                "e2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                "+", " ", "\[Epsilon]"}]}]}], "]"}]}], "]"}]}], "]"}], ";"}], 
       "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ps1", " ", ",", "pe1", ",", "ps2", ",", "pe2"}], "}"}], " ",
         "=", " ", 
        RowBox[{"{", 
         RowBox[{"s1", ",", "e1", ",", "s2", ",", "e2"}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"path", ",", "path1", ",", "path2"}], "}"}], " ", "=", " ", 
        RowBox[{"optimal2robotPath", "[", 
         RowBox[{
         "ps1", ",", "ps2", ",", "pe1", ",", "pe2", ",", "\[Epsilon]"}], " ", 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"mvNum", " ", "=", " ", 
        RowBox[{"Floor", "[", 
         RowBox[{"progress", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Length", "[", "path", "]"}], "-", "1"}], ")"}]}], 
         "]"}]}], " ", ";", "\[IndentingNewLine]", 
       RowBox[{"mvFrac", " ", "=", " ", 
        RowBox[{"FractionalPart", "[", 
         RowBox[{"progress", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Length", "[", "path", "]"}], "-", "1"}], ")"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pm2", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"mvFrac", ">", "0"}], ",", 
          RowBox[{
           RowBox[{"path2", "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"mvNum", "+", "1"}], ",", ";;"}], 
            "\[RightDoubleBracket]"}], "+", 
           RowBox[{"mvFrac", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"path2", "\[LeftDoubleBracket]", 
               RowBox[{
                RowBox[{"mvNum", "+", "2"}], ",", ";;"}], 
               "\[RightDoubleBracket]"}], "-", 
              RowBox[{"path2", "\[LeftDoubleBracket]", 
               RowBox[{
                RowBox[{"mvNum", "+", "1"}], ",", ";;"}], 
               "\[RightDoubleBracket]"}]}], ")"}]}]}], ",", 
          RowBox[{"path2", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"mvNum", "+", "1"}], ",", ";;"}], 
           "\[RightDoubleBracket]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pm1", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"mvFrac", ">", "0"}], ",", 
          RowBox[{
           RowBox[{"path1", "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"mvNum", "+", "1"}], ",", ";;"}], 
            "\[RightDoubleBracket]"}], "+", 
           RowBox[{"mvFrac", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"path1", "\[LeftDoubleBracket]", 
               RowBox[{
                RowBox[{"mvNum", "+", "2"}], ",", ";;"}], 
               "\[RightDoubleBracket]"}], "-", 
              RowBox[{"path1", "\[LeftDoubleBracket]", 
               RowBox[{
                RowBox[{"mvNum", "+", "1"}], ",", ";;"}], 
               "\[RightDoubleBracket]"}]}], ")"}]}]}], ",", 
          RowBox[{"path1", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"mvNum", "+", "1"}], ",", ";;"}], 
           "\[RightDoubleBracket]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"(*", "workspace", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Darker", "[", "Red", "]"}], ",", " ", 
             RowBox[{"Rectangle", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "0.025"}], 
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}]}], ",", 
               RowBox[{"1.025", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Lighter", "[", 
              RowBox[{"Gray", ",", "0.8"}], "]"}], ",", " ", 
             RowBox[{"Rectangle", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"White", ",", " ", 
             RowBox[{"Rectangle", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[Epsilon]", ",", " ", "\[Epsilon]"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"1", "-", "\[Epsilon]"}], ",", 
                 RowBox[{"1", "-", "\[Epsilon]"}]}], "}"}]}], "]"}]}], "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Lighter", "[", 
              RowBox[{"Gray", ",", "0.8"}], "]"}], ",", " ", 
             RowBox[{"Disk", "[", 
              RowBox[{"ps2", ",", "\[Epsilon]"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Lighter", "[", 
              RowBox[{"Gray", ",", "0.8"}], "]"}], ",", " ", 
             RowBox[{"Disk", "[", 
              RowBox[{"pe2", ",", "\[Epsilon]"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"PointSize", "[", "0.01", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Arrowheads", "[", ".02", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Thickness", "[", "thickness", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"starting", " ", "poses"}], ",", " ", 
             RowBox[{
             "dashed", " ", "line", " ", "from", " ", "start", " ", "to", " ",
               "end"}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"c1", ",", 
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{"Opacity", "[", ".3", "]"}], ",", "Dashed", ",", 
               RowBox[{"Arrow", "[", 
                RowBox[{"{", 
                 RowBox[{"ps1", ",", "pe1"}], "}"}], "]"}]}], "}"}], ",", 
             RowBox[{"Point", "@", "ps1"}], ",", 
             RowBox[{"EdgeForm", "[", 
              RowBox[{"Directive", "[", 
               RowBox[{"c1", ",", 
                RowBox[{"Thickness", "[", "thickness", "]"}]}], "]"}], "]"}], 
             ",", 
             RowBox[{"FaceForm", "[", "None", "]"}], ",", 
             RowBox[{"Rectangle", "[", 
              RowBox[{
               RowBox[{"ps1", "-", 
                RowBox[{
                 RowBox[{"2", "/", "3"}], "r", " ", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "1"}], "}"}]}]}], ",", 
               RowBox[{"ps1", "+", 
                RowBox[{
                 RowBox[{"2", "/", "3"}], "r", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "1"}], "}"}]}]}]}], "]"}], ",", 
             RowBox[{"Circle", "[", 
              RowBox[{"pe1", ",", "r"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"c2", ",", 
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{"Opacity", "[", ".3", "]"}], ",", "Dashed", ",", 
               RowBox[{"Arrow", "[", 
                RowBox[{"{", 
                 RowBox[{"ps2", ",", "pe2"}], "}"}], "]"}]}], "}"}], ",", 
             RowBox[{"Point", "@", "ps2"}], ",", 
             RowBox[{"EdgeForm", "[", 
              RowBox[{"Directive", "[", 
               RowBox[{"c2", ",", 
                RowBox[{"Thickness", "[", "thickness", "]"}]}], "]"}], "]"}], 
             ",", 
             RowBox[{"FaceForm", "[", "None", "]"}], ",", 
             RowBox[{"Rectangle", "[", 
              RowBox[{
               RowBox[{"ps2", "-", 
                RowBox[{
                 RowBox[{"2", "/", "3"}], "r", " ", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "1"}], "}"}]}]}], ",", 
               RowBox[{"ps2", "+", 
                RowBox[{
                 RowBox[{"2", "/", "3"}], "r", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "1"}], "}"}]}]}]}], "]"}], ",", " ", 
             RowBox[{"Circle", "[", 
              RowBox[{"pe2", ",", "r"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "plot", " ", "path", " ", "of", " ", "particle", " ", "1"}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"c1", ",", "\[IndentingNewLine]", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Arrow", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"path1", "\[LeftDoubleBracket]", 
                   RowBox[{"i", ",", ";;"}], "\[RightDoubleBracket]"}], ",", 
                  RowBox[{"path1", "\[LeftDoubleBracket]", 
                   RowBox[{
                    RowBox[{"i", "+", "1"}], ",", ";;"}], 
                   "\[RightDoubleBracket]"}]}], "}"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "mvNum"}], "}"}]}], "]"}], ",", 
             "\[IndentingNewLine]", " ", 
             RowBox[{"Arrow", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"path1", "\[LeftDoubleBracket]", 
                 RowBox[{
                  RowBox[{"mvNum", "+", "1"}], ",", ";;"}], 
                 "\[RightDoubleBracket]"}], ",", "pm1"}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "pm1", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "||", 
                 RowBox[{
                  RowBox[{
                  "pm1", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "||", 
                 RowBox[{
                  RowBox[{
                  "pm1", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "||", 
                 RowBox[{
                  RowBox[{
                  "pm1", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "\[Equal]", "1"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Point", "@", "pm1"}], " ", ",", 
                  RowBox[{"PointSize", "[", "0.005", "]"}], ",", "White", ",", 
                  RowBox[{"Point", "@", "pm1"}]}], " ", "}"}], ",", 
                RowBox[{"Point", "@", "pm1"}]}], "]"}], " ", "}"}]}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Inset", "[", 
              RowBox[{
               RowBox[{"RegionPlot", "[", 
                RowBox[{
                 RowBox[{"x", "<", 
                  RowBox[{"-", "3"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", 
                   RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"y", ",", 
                   RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
                 RowBox[{"Epilog", "\[Rule]", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{"reachable", " ", "region"}], "*)"}], 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"LightBlue", ",", 
                    RowBox[{"EdgeForm", "[", "Blue", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"pm2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-", "1", "-", 
                    RowBox[{
                    "pm1", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    "pm2", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "pm1", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}]}], "]"}]}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Black", ",", " ", 
                    RowBox[{"Text", "[", 
                    RowBox[{"\"\<Reachable Region\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"1", "+", 
                    RowBox[{
                    "pm2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "+", "\[Epsilon]", "-", "1"}], 
                    "2"], ",", 
                    FractionBox[
                    RowBox[{
                    RowBox[{
                    "pm2", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "pm1", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "2"]}], "}"}]}], "]"}]}], 
                    "*)"}], "\[IndentingNewLine]", "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"LightGreen", ",", 
                    RowBox[{"EdgeForm", "[", "Blue", "]"}], ",", 
                    RowBox[{"Opacity", "[", "0.5", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "pm2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "pm1", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{"1", "+", " ", 
                    RowBox[{
                    "pm2", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "pm1", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}]}], "}"}]}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
                    
                    RowBox[{"(*", 
                    RowBox[{"current", " ", "deltas"}], "*)"}], 
                    "\[IndentingNewLine]", "Red", ",", 
                    RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"pm2", "-", "pm1", "-", 
                    RowBox[{
                    RowBox[{"4", "/", "3"}], "r", " ", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}]}], ",", 
                    RowBox[{"pm2", "-", "pm1", "+", 
                    RowBox[{
                    RowBox[{"4", "/", "3"}], "r", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"goal", " ", "deltas"}], "*)"}], 
                    "\[IndentingNewLine]", "Green", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Disk", "[", 
                    RowBox[{
                    RowBox[{"pe2", "-", "pe1"}], ",", 
                    RowBox[{"2", "r"}]}], "]"}]}], "\[IndentingNewLine]", 
                   "\[IndentingNewLine]", "}"}]}], ",", 
                 RowBox[{"FrameLabel", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<\[CapitalDelta]x\>\"", ",", 
                    "\"\<\[CapitalDelta] y\>\""}], "}"}]}], ",", 
                 RowBox[{"ImageSize", "\[Rule]", "250"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"1.5", ",", ".5"}], "}"}]}], "]"}], ","}], 
            "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "plot", " ", "path", " ", "of", " ", "particle", " ", "2"}], 
            "*)"}], "\[IndentingNewLine]", " ", 
           RowBox[{"{", 
            RowBox[{"c2", ",", "\[IndentingNewLine]", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Arrow", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"path2", "\[LeftDoubleBracket]", 
                   RowBox[{"i", ",", ";;"}], "\[RightDoubleBracket]"}], ",", 
                  RowBox[{"path2", "\[LeftDoubleBracket]", 
                   RowBox[{
                    RowBox[{"i", "+", "1"}], ",", ";;"}], 
                   "\[RightDoubleBracket]"}]}], "}"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "mvNum"}], "}"}]}], "]"}], ",", 
             "\[IndentingNewLine]", " ", 
             RowBox[{"Arrow", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"path2", "\[LeftDoubleBracket]", 
                 RowBox[{
                  RowBox[{"mvNum", "+", "1"}], ",", ";;"}], 
                 "\[RightDoubleBracket]"}], ",", "pm2"}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "pm2", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "||", 
                 RowBox[{
                  RowBox[{
                  "pm2", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "||", 
                 RowBox[{
                  RowBox[{
                  "pm2", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "||", 
                 RowBox[{
                  RowBox[{
                  "pm2", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "\[Equal]", "1"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Point", "@", "pm2"}], " ", ",", 
                  RowBox[{"PointSize", "[", "0.005", "]"}], ",", "White", ",", 
                  RowBox[{"Point", "@", "pm2"}]}], " ", "}"}], ",", 
                RowBox[{"Point", "@", "pm2"}]}], "]"}], "}"}]}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"mvNum", "+", "1"}], "\[Equal]", " ", 
                 RowBox[{"Length", "[", "path", "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"mvNum", "=", " ", 
                   RowBox[{
                    RowBox[{"Length", "[", "path", "]"}], "-", "2"}]}], ",", 
                  RowBox[{"mvFrac", "=", "1"}]}], "}"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Darker", "[", "Red", "]"}]}], ",", " ", 
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"StringForm", "[", 
                  RowBox[{"\"\<Move `` of ``\>\"", ",", " ", 
                   RowBox[{"mvNum", "+", "1"}], ",", 
                   RowBox[{
                    RowBox[{"Length", "[", "path", "]"}], "-", "1"}]}], "]"}],
                  ",", 
                 RowBox[{"FontSize", "\[Rule]", "18"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"1.55", ",", ".9"}], "}"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"StringForm", "[", 
                  RowBox[{"\"\<Total Distance `` \>\"", ",", " ", 
                   RowBox[{"Round", "[", 
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{"Total", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"EuclideanDistance", "[", 
                    RowBox[{
                    RowBox[{
                    "path", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "2", ",", " ", 
                    RowBox[{"Length", "[", "path", "]"}]}], "}"}]}], "]"}], 
                    " ", "]"}], " ", "]"}], ",", ".01"}], "]"}]}], "]"}], ",", 
                 RowBox[{"FontSize", "\[Rule]", "18"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"1.55", ",", ".8"}], "}"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"offset", " ", "=", " ", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1.55", ",", ".5"}], "}"}], "-", 
                RowBox[{
                 FractionBox["1", "2"], 
                 RowBox[{"path", "\[LeftDoubleBracket]", 
                  RowBox[{
                   RowBox[{"mvNum", "+", "2"}], ",", ";;"}], 
                  "\[RightDoubleBracket]"}]}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Opacity", "[", "0.3", "]"}], ",", " ", 
                RowBox[{"Arrow", "[", 
                 RowBox[{"{", 
                  RowBox[{"offset", ",", 
                   RowBox[{"offset", "+", 
                    RowBox[{"path", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"mvNum", "+", "2"}], ",", ";;"}], 
                    "\[RightDoubleBracket]"}]}]}], "}"}], "]"}]}], "}"}]}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"Point", "[", 
              RowBox[{"offset", "+", 
               RowBox[{"mvFrac", 
                RowBox[{"(", 
                 RowBox[{"path", "\[LeftDoubleBracket]", 
                  RowBox[{
                   RowBox[{"mvNum", "+", "2"}], ",", ";;"}], 
                  "\[RightDoubleBracket]"}], ")"}]}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Arrow", "[", 
              RowBox[{"{", 
               RowBox[{"offset", ",", "  ", 
                RowBox[{"offset", "+", 
                 RowBox[{"mvFrac", 
                  RowBox[{"(", 
                   RowBox[{"path", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"mvNum", "+", "2"}], ",", ";;"}], 
                    "\[RightDoubleBracket]"}], ")"}]}]}]}], " ", "}"}], 
              "]"}]}], "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
          "}"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "0.05"}], ",", "2.05"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", ".05"}], ",", "1.05"}], "}"}]}], "}"}]}]}], 
        "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Control", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"progress", ",", "1", ",", "\"\<progress\>\""}], "}"}], 
          ",", "0", ",", "1", ",", 
          RowBox[{"1", "/", "420"}], ",", "Slider", ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"Control", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Epsilon]", ",", 
            RowBox[{"2", "/", "100"}], ",", "\"\<\[Epsilon]\>\""}], "}"}], 
          ",", 
          RowBox[{"1", "/", "1000"}], ",", 
          RowBox[{"1", "/", "10"}], ",", 
          RowBox[{"1", "/", "1000"}], ",", "Slider", ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}]}]}], 
      "}"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"s2", ",", 
        RowBox[{"{", 
         RowBox[{"0.6", ",", "0.8"}], "}"}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], "+", " ", "\[Epsilon]"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "-", " ", "\[Epsilon]"}], ",", 
      "Locator", ",", 
      RowBox[{"Appearance", "\[Rule]", "None"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"s1", ",", 
        RowBox[{"{", 
         RowBox[{"0.85", ",", "0.15"}], "}"}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], "+", " ", "\[Epsilon]"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "-", " ", "\[Epsilon]"}], ",", 
      "Locator", ",", 
      RowBox[{"Appearance", "\[Rule]", "None"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"e2", ",", 
        RowBox[{"{", 
         RowBox[{"0.13", ",", "0.35"}], "}"}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], "+", " ", "\[Epsilon]"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "-", " ", "\[Epsilon]"}], ",", 
      "Locator", ",", 
      RowBox[{"Appearance", "\[Rule]", "None"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"e1", ",", 
        RowBox[{"{", 
         RowBox[{"0.2", ",", "0.85"}], "}"}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], "+", " ", "\[Epsilon]"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "-", " ", "\[Epsilon]"}], ",", 
      "Locator", ",", 
      RowBox[{"Appearance", "\[Rule]", "None"}]}], "}"}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"s1", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"3", "/", "4"}], ",", 
            RowBox[{"1", "/", "5"}]}], "}"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], "+", " ", "\[Epsilon]"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], "-", " ", "\[Epsilon]"}], ",", 
        "Locator", ",", 
        RowBox[{"Appearance", "\[Rule]", "None"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"s2", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "4"}], ",", 
            RowBox[{"1", "/", "5"}]}], "}"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], "+", " ", "\[Epsilon]"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], "-", " ", "\[Epsilon]"}], ",", 
        "Locator", ",", 
        RowBox[{"Appearance", "\[Rule]", "None"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"e1", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"3", "/", "4"}], ",", 
            RowBox[{"1", "/", "2"}]}], "}"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], "+", " ", "\[Epsilon]"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], "-", " ", "\[Epsilon]"}], ",", 
        "Locator", ",", 
        RowBox[{"Appearance", "\[Rule]", "None"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"e2", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "4"}], ",", 
            RowBox[{"1", "/", "2"}]}], "}"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], "+", " ", "\[Epsilon]"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], "-", " ", "\[Epsilon]"}], ",", 
        "Locator", ",", 
        RowBox[{"Appearance", "\[Rule]", "None"}]}], "}"}]}], "*)"}], 
    "\[IndentingNewLine]", ",", " ", 
    RowBox[{"SaveDefinitions", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6968562155908957`*^9, 3.696856266904849*^9}, {
   3.696856313650724*^9, 3.696856375791654*^9}, {3.696856412642693*^9, 
   3.6968564213071327`*^9}, {3.696856895044446*^9, 3.696856898930119*^9}, 
   3.696858729013013*^9}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`e1$$ = {0.2, 0.85}, $CellContext`e2$$ = {
    0.13, 0.35}, $CellContext`progress$$ = 1, $CellContext`s1$$ = {0.85, 
    0.15}, $CellContext`s2$$ = {0.6, 0.8}, $CellContext`\[Epsilon]$$ = 
    Rational[1, 50], Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`progress$$], 1, "progress"}, 0, 1, 
      Rational[1, 420]}, {{
       Hold[$CellContext`\[Epsilon]$$], 
       Rational[1, 50], "\[Epsilon]"}, 
      Rational[1, 1000], 
      Rational[1, 10], 
      Rational[1, 1000]}, {
      Hold[
       Row[{
         Manipulate`Place[1], 
         Manipulate`Place[2]}]], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`s2$$], {0.6, 0.8}}, 
      Dynamic[{0, 0} + $CellContext`\[Epsilon]$$], 
      Dynamic[{1, 1} - $CellContext`\[Epsilon]$$]}, {{
       Hold[$CellContext`s1$$], {0.85, 0.15}}, 
      Dynamic[{0, 0} + $CellContext`\[Epsilon]$$], 
      Dynamic[{1, 1} - $CellContext`\[Epsilon]$$]}, {{
       Hold[$CellContext`e2$$], {0.13, 0.35}}, 
      Dynamic[{0, 0} + $CellContext`\[Epsilon]$$], 
      Dynamic[{1, 1} - $CellContext`\[Epsilon]$$]}, {{
       Hold[$CellContext`e1$$], {0.2, 0.85}}, 
      Dynamic[{0, 0} + $CellContext`\[Epsilon]$$], 
      Dynamic[{1, 1} - $CellContext`\[Epsilon]$$]}}, Typeset`size$$ = {
    62., {2., 9.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = False, $CellContext`progress$1104592$$ = 
    0, $CellContext`\[Epsilon]$1104593$$ = 0, $CellContext`s2$1104594$$ = 
    0, $CellContext`s1$1104595$$ = 0, $CellContext`e2$1104596$$ = 
    0, $CellContext`e1$1104597$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`e1$$ = {0.2, 0.85}, $CellContext`e2$$ = {
         0.13, 0.35}, $CellContext`progress$$ = 
        1, $CellContext`s1$$ = {0.85, 0.15}, $CellContext`s2$$ = {0.6, 
         0.8}, $CellContext`\[Epsilon]$$ = Rational[1, 50]}, 
      "ControllerVariables" :> {
        Hold[$CellContext`progress$$, $CellContext`progress$1104592$$, 0], 
        Hold[$CellContext`\[Epsilon]$$, $CellContext`\[Epsilon]$1104593$$, 0], 
        Hold[$CellContext`s2$$, $CellContext`s2$1104594$$, 0], 
        Hold[$CellContext`s1$$, $CellContext`s1$1104595$$, 0], 
        Hold[$CellContext`e2$$, $CellContext`e2$1104596$$, 0], 
        Hold[$CellContext`e1$$, $CellContext`e1$1104597$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`movesAndPositions$, $CellContext`path$, \
$CellContext`path1$, $CellContext`path2$, $CellContext`r$ = 
         1/40, $CellContext`thickness$ = 
         0.002, $CellContext`rotateSolution$, $CellContext`ps1$, \
$CellContext`pe1$, $CellContext`ps2$, $CellContext`pe2$, $CellContext`pm1$, \
$CellContext`pm2$, $CellContext`offset$, $CellContext`c1$ = 
         Blue, $CellContext`c2$ = 
         Magenta, $CellContext`mvNum$, $CellContext`mvFrac$}, \
{$CellContext`ps1$, $CellContext`pe1$, $CellContext`ps2$, $CellContext`pe2$} = \
{$CellContext`s1$$, $CellContext`e1$$, $CellContext`s2$$, $CellContext`e2$$}; \
{$CellContext`path$, $CellContext`path1$, $CellContext`path2$} = \
$CellContext`optimal2robotPath[$CellContext`ps1$, $CellContext`ps2$, \
$CellContext`pe1$, $CellContext`pe2$, $CellContext`\[Epsilon]$$]; \
$CellContext`mvNum$ = 
         Floor[$CellContext`progress$$ (Length[$CellContext`path$] - 
            1)]; $CellContext`mvFrac$ = 
         FractionalPart[$CellContext`progress$$ (Length[$CellContext`path$] - 
            1)]; $CellContext`pm2$ = 
         If[$CellContext`mvFrac$ > 0, 
           Part[$CellContext`path2$, $CellContext`mvNum$ + 1, 
             Span[1, All]] + $CellContext`mvFrac$ (
             Part[$CellContext`path2$, $CellContext`mvNum$ + 2, 
               Span[1, All]] - 
             Part[$CellContext`path2$, $CellContext`mvNum$ + 1, 
              Span[1, All]]), 
           Part[$CellContext`path2$, $CellContext`mvNum$ + 1, 
            Span[1, All]]]; $CellContext`pm1$ = 
         If[$CellContext`mvFrac$ > 0, 
           Part[$CellContext`path1$, $CellContext`mvNum$ + 1, 
             Span[1, All]] + $CellContext`mvFrac$ (
             Part[$CellContext`path1$, $CellContext`mvNum$ + 2, 
               Span[1, All]] - 
             Part[$CellContext`path1$, $CellContext`mvNum$ + 1, 
              Span[1, All]]), 
           Part[$CellContext`path1$, $CellContext`mvNum$ + 1, 
            Span[1, All]]]; Graphics[{{
            Darker[Red], 
            Rectangle[(-0.025) {1, 1}, 1.025 {1, 1}]}, {
            Lighter[Gray, 0.8], 
            Rectangle[{0, 0}, {1, 1}]}, {White, 
            
            Rectangle[{$CellContext`\[Epsilon]$$, $CellContext`\[Epsilon]$$}, \
{1 - $CellContext`\[Epsilon]$$, 1 - $CellContext`\[Epsilon]$$}]}, {
            Lighter[Gray, 0.8], 
            Disk[$CellContext`ps2$, $CellContext`\[Epsilon]$$]}, {
            Lighter[Gray, 0.8], 
            Disk[$CellContext`pe2$, $CellContext`\[Epsilon]$$]}, 
           PointSize[0.01], 
           Arrowheads[0.02], 
           Thickness[$CellContext`thickness$], {$CellContext`c1$, {
             Opacity[0.3], Dashed, 
             Arrow[{$CellContext`ps1$, $CellContext`pe1$}]}, 
            Point[$CellContext`ps1$], 
            EdgeForm[
             Directive[$CellContext`c1$, 
              Thickness[$CellContext`thickness$]]], 
            FaceForm[None], 
            
            Rectangle[$CellContext`ps1$ - (2/3) $CellContext`r$ {1, 
              1}, $CellContext`ps1$ + (2/3) $CellContext`r$ {1, 1}], 
            Circle[$CellContext`pe1$, $CellContext`r$]}, {$CellContext`c2$, {
             Opacity[0.3], Dashed, 
             Arrow[{$CellContext`ps2$, $CellContext`pe2$}]}, 
            Point[$CellContext`ps2$], 
            EdgeForm[
             Directive[$CellContext`c2$, 
              Thickness[$CellContext`thickness$]]], 
            FaceForm[None], 
            
            Rectangle[$CellContext`ps2$ - (2/3) $CellContext`r$ {1, 
              1}, $CellContext`ps2$ + (2/3) $CellContext`r$ {1, 1}], 
            Circle[$CellContext`pe2$, $CellContext`r$]}, {$CellContext`c1$, 
            Table[
             Arrow[{
               Part[$CellContext`path1$, $CellContext`i, 
                Span[1, All]], 
               Part[$CellContext`path1$, $CellContext`i + 1, 
                Span[1, All]]}], {$CellContext`i, 1, $CellContext`mvNum$}], 
            Arrow[{
              Part[$CellContext`path1$, $CellContext`mvNum$ + 1, 
               Span[1, All]], $CellContext`pm1$}], {
             If[
              Or[
              Part[$CellContext`pm1$, 1] == 0, Part[$CellContext`pm1$, 2] == 
               0, Part[$CellContext`pm1$, 1] == 1, Part[$CellContext`pm1$, 2] == 
               1], {
               Point[$CellContext`pm1$], 
               PointSize[0.005], White, 
               Point[$CellContext`pm1$]}, 
              Point[$CellContext`pm1$]]}}, {$CellContext`c2$, 
            Table[
             Arrow[{
               Part[$CellContext`path2$, $CellContext`i, 
                Span[1, All]], 
               Part[$CellContext`path2$, $CellContext`i + 1, 
                Span[1, All]]}], {$CellContext`i, 1, $CellContext`mvNum$}], 
            Arrow[{
              Part[$CellContext`path2$, $CellContext`mvNum$ + 1, 
               Span[1, All]], $CellContext`pm2$}], {
             If[
              Or[
              Part[$CellContext`pm2$, 1] == 0, Part[$CellContext`pm2$, 2] == 
               0, Part[$CellContext`pm2$, 1] == 1, Part[$CellContext`pm2$, 2] == 
               1], {
               Point[$CellContext`pm2$], 
               PointSize[0.005], White, 
               Point[$CellContext`pm2$]}, 
              Point[$CellContext`pm2$]]}}, {
           If[$CellContext`mvNum$ + 1 == 
              Length[$CellContext`path$], {$CellContext`mvNum$ = 
               Length[$CellContext`path$] - 2, $CellContext`mvFrac$ = 1}]; 
            Darker[Red], 
            Text[
             Style[
              StringForm[
              "Move `` of ``", $CellContext`mvNum$ + 1, 
               Length[$CellContext`path$] - 1], FontSize -> 18], {1.55, 0.9}], 
            Text[
             Style[
              StringForm["Total Distance `` ", 
               Round[
                N[
                 Total[
                  Table[
                   EuclideanDistance[
                    Part[$CellContext`path$, $CellContext`i], {0, 
                    0}], {$CellContext`i, 2, 
                    Length[$CellContext`path$]}]]], 0.01]], FontSize -> 18], {
             1.55, 0.8}], $CellContext`offset$ = {1.55, 0.5} - (1/2) 
              Part[$CellContext`path$, $CellContext`mvNum$ + 2, 
                Span[1, All]]; {
              Opacity[0.3], 
              
              Arrow[{$CellContext`offset$, $CellContext`offset$ + 
                Part[$CellContext`path$, $CellContext`mvNum$ + 2, 
                  Span[1, All]]}]}, 
            
            Point[$CellContext`offset$ + $CellContext`mvFrac$ 
              Part[$CellContext`path$, $CellContext`mvNum$ + 2, 
                Span[1, All]]], 
            
            Arrow[{$CellContext`offset$, $CellContext`offset$ + \
$CellContext`mvFrac$ Part[$CellContext`path$, $CellContext`mvNum$ + 2, 
                 Span[1, All]]}]}}, ImageSize -> 800, 
          PlotRange -> {{-0.05, 2.05}, {-0.05, 1.05}}]], 
      "Specifications" :> {{{$CellContext`progress$$, 1, "progress"}, 0, 1, 
         Rational[1, 420], ControlType -> Slider, Appearance -> "Labeled", 
         ControlPlacement -> 1}, {{$CellContext`\[Epsilon]$$, 
          Rational[1, 50], "\[Epsilon]"}, 
         Rational[1, 1000], 
         Rational[1, 10], 
         Rational[1, 1000], ControlType -> Slider, Appearance -> "Labeled", 
         ControlPlacement -> 2}, 
        Row[{
          Manipulate`Place[1], 
          Manipulate`Place[2]}], {{$CellContext`s2$$, {0.6, 0.8}}, 
         Dynamic[{0, 0} + $CellContext`\[Epsilon]$$], 
         Dynamic[{1, 1} - $CellContext`\[Epsilon]$$], ControlType -> Locator, 
         Appearance -> None}, {{$CellContext`s1$$, {0.85, 0.15}}, 
         Dynamic[{0, 0} + $CellContext`\[Epsilon]$$], 
         Dynamic[{1, 1} - $CellContext`\[Epsilon]$$], ControlType -> Locator, 
         Appearance -> None}, {{$CellContext`e2$$, {0.13, 0.35}}, 
         Dynamic[{0, 0} + $CellContext`\[Epsilon]$$], 
         Dynamic[{1, 1} - $CellContext`\[Epsilon]$$], ControlType -> Locator, 
         Appearance -> None}, {{$CellContext`e1$$, {0.2, 0.85}}, 
         Dynamic[{0, 0} + $CellContext`\[Epsilon]$$], 
         Dynamic[{1, 1} - $CellContext`\[Epsilon]$$], ControlType -> Locator, 
         Appearance -> None}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{578., {53., 58.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`optimal2robotPath[
         Pattern[$CellContext`s1, 
          Blank[]], 
         Pattern[$CellContext`s2, 
          Blank[]], 
         Pattern[$CellContext`g1, 
          Blank[]], 
         Pattern[$CellContext`g2, 
          Blank[]], 
         Pattern[$CellContext`\[Epsilon], 
          Blank[]]] := 
       Module[{$CellContext`optimalPathList, $CellContext`bestMoveSeq, \
$CellContext`dist1, $CellContext`iter = 
          0}, $CellContext`optimalPathList = {{
            Infinity, $CellContext`s1, $CellContext`s2, {{0, 
             0}}, {$CellContext`s1}, {$CellContext`s2}, 
             False}}; $CellContext`dist1 = \
$CellContext`distanceMoved[$CellContext`admissibleHeuristic[$CellContext`s1, \
$CellContext`s2, $CellContext`g1, $CellContext`g2] + 0]; 
         While[Part[$CellContext`optimalPathList, 1, 7] != True, 
           
           Module[{$CellContext`pathToExplore, $CellContext`r1, \
$CellContext`r2, $CellContext`wallMoves, $CellContext`moves, \
$CellContext`pm1, $CellContext`pm2, $CellContext`isPathComplete}, \
$CellContext`pathToExplore = 
             First[$CellContext`optimalPathList]; \
$CellContext`optimalPathList = 
             Delete[$CellContext`optimalPathList, 1]; $CellContext`r1 = 
             Part[$CellContext`pathToExplore, 2]; $CellContext`r2 = 
             Part[$CellContext`pathToExplore, 3]; $CellContext`moves = 
             Part[$CellContext`pathToExplore, 4]; $CellContext`pm1 = 
             Part[$CellContext`pathToExplore, 5]; $CellContext`pm2 = 
             Part[$CellContext`pathToExplore, 6]; $CellContext`isPathComplete = 
             Part[$CellContext`pathToExplore, 7]; AddTo[$CellContext`iter, 1]; 
            If[$CellContext`isPathComplete != True, 
              Table[$CellContext`wallMoves = \
$CellContext`wallFrictionMoveDir[$CellContext`dir, $CellContext`r1, \
$CellContext`r2, $CellContext`g1, $CellContext`g2, $CellContext`moves, \
$CellContext`pm1, $CellContext`pm2, $CellContext`\[Epsilon]]; \
$CellContext`optimalPathList = 
                 AppendTo[$CellContext`optimalPathList, \
$CellContext`wallMoves]; 
                Null, {$CellContext`dir, {
                 "u", "d", "l", "r"}}]; $CellContext`optimalPathList = 
               SortBy[$CellContext`optimalPathList, First]; Null]]]; Return[{
            Part[
             Part[$CellContext`optimalPathList, 1], 4], 
            Part[
             Part[$CellContext`optimalPathList, 1], 5], 
            Part[
             Part[$CellContext`optimalPathList, 1], 
             6]}]], $CellContext`distanceMoved[
         Pattern[$CellContext`moves, 
          Blank[]]] := Total[
         Table[
          
          Norm[$CellContext`m], {$CellContext`m, $CellContext`moves}]], \
$CellContext`admissibleHeuristic[
         Pattern[$CellContext`s1, 
          Blank[]], 
         Pattern[$CellContext`s2, 
          Blank[]], 
         Pattern[$CellContext`g1, 
          Blank[]], 
         Pattern[$CellContext`g2, 
          Blank[]]] := Max[
         EuclideanDistance[$CellContext`g1, $CellContext`s1], 
         EuclideanDistance[$CellContext`g2, $CellContext`s2]], \
$CellContext`wallFrictionMoveDir[
         Pattern[$CellContext`dir, 
          Blank[]], 
         Pattern[$CellContext`s1, 
          Blank[]], 
         Pattern[$CellContext`s2, 
          Blank[]], 
         Pattern[$CellContext`g1, 
          Blank[]], 
         Pattern[$CellContext`g2, 
          Blank[]], 
         Pattern[$CellContext`moves, 
          Blank[]], 
         Pattern[$CellContext`pm1, 
          Blank[]], 
         Pattern[$CellContext`pm2, 
          Blank[]], 
         Pattern[$CellContext`\[Epsilon], 
          Blank[]]] := 
       Module[{$CellContext`\[CapitalDelta]ex, \
$CellContext`\[CapitalDelta]ey, $CellContext`path = $CellContext`moves, \
$CellContext`path1 = $CellContext`pm1, $CellContext`path2 = \
$CellContext`pm2}, {$CellContext`\[CapitalDelta]ex, $CellContext`\
\[CapitalDelta]ey} = ($CellContext`g2 - $CellContext`g1) - ($CellContext`s2 - \
$CellContext`s1); If[
           And[-0.0001 <= $CellContext`\[CapitalDelta]ex <= 0.0001, 
            
            Inequality[-0.0001, LessEqual, $CellContext`\[CapitalDelta]ey, 
             Less, 0.0001]], 
           AppendTo[$CellContext`path, {
             Part[$CellContext`g2, 1] - Part[$CellContext`s2, 1], 
              Part[$CellContext`g2, 2] - Part[$CellContext`s2, 2]}]; 
           AppendTo[$CellContext`path1, $CellContext`g1]; 
           AppendTo[$CellContext`path2, $CellContext`g2]; Return[{
              $CellContext`distanceMoved[$CellContext`path], $CellContext`g1, \
$CellContext`g2, $CellContext`path, $CellContext`path1, $CellContext`path2, 
              True}]]; 
         Module[{$CellContext`r1, $CellContext`r2, \
$CellContext`newPathEntries, $CellContext`s1t, $CellContext`s2t, \
$CellContext`g1t, $CellContext`g2t, $CellContext`movest, $CellContext`pm1st, \
$CellContext`pm2st}, 
           If[$CellContext`dir == 
             "u", $CellContext`newPathEntries = \
$CellContext`wallFrictionMoveUp[$CellContext`s1, $CellContext`s2, \
$CellContext`g1, $CellContext`g2, $CellContext`moves, $CellContext`pm1, \
$CellContext`pm2, $CellContext`\[Epsilon]]; Null]; 
           If[$CellContext`dir == 
             "d", {$CellContext`s1t, $CellContext`s2t, $CellContext`g1t, \
$CellContext`g2t} = 
              Map[$CellContext`rotate180, {$CellContext`s1, $CellContext`s2, \
$CellContext`g1, $CellContext`g2}]; $CellContext`movest = 
              Map[$CellContext`rotate180inplace, $CellContext`moves]; \
$CellContext`pm1st = 
              Map[$CellContext`rotate180, $CellContext`pm1]; \
$CellContext`pm2st = 
              Map[$CellContext`rotate180, $CellContext`pm2]; \
$CellContext`newPathEntries = \
$CellContext`wallFrictionMoveUp[$CellContext`s1t, $CellContext`s2t, \
$CellContext`g1t, $CellContext`g2t, $CellContext`movest, $CellContext`pm1st, \
$CellContext`pm2st, $CellContext`\[Epsilon]]; 
             Part[$CellContext`newPathEntries, 2] = $CellContext`rotate180[
                Part[$CellContext`newPathEntries, 2]]; 
             Part[$CellContext`newPathEntries, 3] = $CellContext`rotate180[
                Part[$CellContext`newPathEntries, 3]]; 
             Part[$CellContext`newPathEntries, 4] = 
              Map[$CellContext`rotate180inplace, 
                Part[$CellContext`newPathEntries, 4]]; 
             Part[$CellContext`newPathEntries, 5] = 
              Map[$CellContext`rotate180, 
                Part[$CellContext`newPathEntries, 5]]; 
             Part[$CellContext`newPathEntries, 6] = 
              Map[$CellContext`rotate180, 
                Part[$CellContext`newPathEntries, 6]]; Null]; 
           If[$CellContext`dir == 
             "r", {$CellContext`s1t, $CellContext`s2t, $CellContext`g1t, \
$CellContext`g2t} = 
              Map[$CellContext`rotate90, {$CellContext`s1, $CellContext`s2, \
$CellContext`g1, $CellContext`g2}]; $CellContext`movest = 
              Map[$CellContext`rotate90inplace, $CellContext`moves]; \
$CellContext`pm1st = 
              Map[$CellContext`rotate90, $CellContext`pm1]; \
$CellContext`pm2st = 
              Map[$CellContext`rotate90, $CellContext`pm2]; \
$CellContext`newPathEntries = \
$CellContext`wallFrictionMoveUp[$CellContext`s1t, $CellContext`s2t, \
$CellContext`g1t, $CellContext`g2t, $CellContext`movest, $CellContext`pm1st, \
$CellContext`pm2st, $CellContext`\[Epsilon]]; 
             Part[$CellContext`newPathEntries, 2] = $CellContext`rotate270[
                Part[$CellContext`newPathEntries, 2]]; 
             Part[$CellContext`newPathEntries, 3] = $CellContext`rotate270[
                Part[$CellContext`newPathEntries, 3]]; 
             Part[$CellContext`newPathEntries, 4] = 
              Map[$CellContext`rotate270inplace, 
                Part[$CellContext`newPathEntries, 4]]; 
             Part[$CellContext`newPathEntries, 5] = 
              Map[$CellContext`rotate270, 
                Part[$CellContext`newPathEntries, 5]]; 
             Part[$CellContext`newPathEntries, 6] = 
              Map[$CellContext`rotate270, 
                Part[$CellContext`newPathEntries, 6]]]; 
           If[$CellContext`dir == 
             "l", {$CellContext`s1t, $CellContext`s2t, $CellContext`g1t, \
$CellContext`g2t} = 
              Map[$CellContext`rotate270, {$CellContext`s1, $CellContext`s2, \
$CellContext`g1, $CellContext`g2}]; $CellContext`movest = 
              Map[$CellContext`rotate270inplace, $CellContext`moves]; \
$CellContext`pm1st = 
              Map[$CellContext`rotate270, $CellContext`pm1]; \
$CellContext`pm2st = 
              Map[$CellContext`rotate270, $CellContext`pm2]; \
$CellContext`newPathEntries = \
$CellContext`wallFrictionMoveUp[$CellContext`s1t, $CellContext`s2t, \
$CellContext`g1t, $CellContext`g2t, $CellContext`movest, $CellContext`pm1st, \
$CellContext`pm2st, $CellContext`\[Epsilon]]; 
             Part[$CellContext`newPathEntries, 2] = $CellContext`rotate90[
                Part[$CellContext`newPathEntries, 2]]; 
             Part[$CellContext`newPathEntries, 3] = $CellContext`rotate90[
                Part[$CellContext`newPathEntries, 3]]; 
             Part[$CellContext`newPathEntries, 4] = 
              Map[$CellContext`rotate90inplace, 
                Part[$CellContext`newPathEntries, 4]]; 
             Part[$CellContext`newPathEntries, 5] = Map[$CellContext`rotate90, 
                Part[$CellContext`newPathEntries, 5]]; 
             Part[$CellContext`newPathEntries, 6] = Map[$CellContext`rotate90, 
                Part[$CellContext`newPathEntries, 6]]]; 
           Return[$CellContext`newPathEntries]]], \
$CellContext`wallFrictionMoveUp[
         Pattern[$CellContext`r1in, 
          Blank[]], 
         Pattern[$CellContext`r2in, 
          Blank[]], 
         Pattern[$CellContext`g1in, 
          Blank[]], 
         Pattern[$CellContext`g2in, 
          Blank[]], 
         Pattern[$CellContext`moves, 
          Blank[]], 
         Pattern[$CellContext`pm1, 
          Blank[]], 
         Pattern[$CellContext`pm2, 
          Blank[]], 
         Pattern[$CellContext`\[Epsilon], 
          Blank[]]] := 
       Module[{$CellContext`r1, $CellContext`r2, $CellContext`g1, \
$CellContext`g2, $CellContext`\[CapitalDelta]gx, \
$CellContext`\[CapitalDelta]gy, $CellContext`m1, $CellContext`m2, \
$CellContext`\[CapitalDelta]tgx, $CellContext`\[CapitalDelta]tgy, \
$CellContext`\[CapitalDelta]ey, $CellContext`\[CapitalDelta]ex, \
$CellContext`L = 
          1, $CellContext`\[CapitalDelta]r, $CellContext`path1 = \
$CellContext`pm1, $CellContext`path2 = $CellContext`pm2, $CellContext`path = \
$CellContext`moves, $CellContext`isMirrored = False, $CellContext`isFlipped = 
          False}, If[
          Part[$CellContext`r1in, 2] < Part[$CellContext`r2in, 2], 
           If[
           Part[$CellContext`r1in, 1] > 
            Part[$CellContext`r2in, 
              1], {$CellContext`r1, $CellContext`r2, $CellContext`g1, \
$CellContext`g2} = {$CellContext`r2in, $CellContext`r1in, $CellContext`g2in, \
$CellContext`g1in}; $CellContext`isFlipped = 
             True, {$CellContext`r1, $CellContext`r2, $CellContext`g1, \
$CellContext`g2} = 
             Map[$CellContext`mirror, {$CellContext`r2in, $CellContext`r1in, \
$CellContext`g2in, $CellContext`g1in}]; $CellContext`path = 
             Map[$CellContext`mirrorInplace, $CellContext`moves]; \
$CellContext`isFlipped = True; $CellContext`isMirrored = True], 
           If[Part[$CellContext`r1in, 1] > 
             Part[$CellContext`r2in, 
               1], {$CellContext`r1, $CellContext`r2, $CellContext`g1, \
$CellContext`g2} = 
              Map[$CellContext`mirror, {$CellContext`r1in, $CellContext`r2in, \
$CellContext`g1in, $CellContext`g2in}]; $CellContext`path = 
              Map[$CellContext`mirrorInplace, $CellContext`moves]; \
$CellContext`isMirrored = 
              True, {$CellContext`r1, $CellContext`r2, $CellContext`g1, \
$CellContext`g2} = {$CellContext`r1in, $CellContext`r2in, $CellContext`g1in, \
$CellContext`g2in}]; 
           Null]; {$CellContext`\[CapitalDelta]gx, $CellContext`\
\[CapitalDelta]gy} = $CellContext`g2 - $CellContext`g1; 
         If[Part[$CellContext`r2, 2] == 1, 
           
           Return[{Infinity, $CellContext`r1, $CellContext`r2, \
$CellContext`path, $CellContext`path1, $CellContext`path2, False}]]; 
         If[Part[$CellContext`r2, 1] - Part[$CellContext`r1, 1] - 1 + 
            2 $CellContext`\[Epsilon] > $CellContext`\[CapitalDelta]gx, \
$CellContext`\[CapitalDelta]tgx = 
           Part[$CellContext`r2, 1] - Part[$CellContext`r1, 1] - 1 + 
            2 $CellContext`\[Epsilon], $CellContext`\[CapitalDelta]tgx = \
$CellContext`\[CapitalDelta]gx]; 
         If[$CellContext`\[CapitalDelta]gy > 
           0, $CellContext`\[CapitalDelta]tgy = 
           0, $CellContext`\[CapitalDelta]tgy = \
$CellContext`\[CapitalDelta]gy]; 
         If[$CellContext`\[CapitalDelta]gy < 
           Part[$CellContext`r2, 2] - 
            Part[$CellContext`r1, 2], $CellContext`\[CapitalDelta]tgy = 
           Part[$CellContext`r2, 2] - Part[$CellContext`r1, 2]]; If[
           And[
           Part[$CellContext`r2, 1] - Part[$CellContext`r1, 1] - 1 + 
             2 $CellContext`\[Epsilon] <= $CellContext`\[CapitalDelta]gx <= 1,
             Part[$CellContext`r2, 2] - 
             Part[$CellContext`r1, 2] <= $CellContext`\[CapitalDelta]gy <= 
            0], $CellContext`m1 = {((1 - Part[$CellContext`r1, 2])/(2 - 
              Part[$CellContext`g1, 2] - Part[$CellContext`r1, 2])) (
              Part[$CellContext`g1, 1] - Part[$CellContext`r1, 1]), 1 - 
             Part[$CellContext`r1, 2]}, $CellContext`m1 = {
            0, 1 - Part[$CellContext`r1, 2]}]; 
         If[Part[$CellContext`r2, 1] + Part[$CellContext`m1, 1] > 1, 
           Part[$CellContext`m1, 1] = 1 - Part[$CellContext`r2, 1], 
           If[
           Part[$CellContext`r2, 1] + Part[$CellContext`m1, 1] < 0, 
            Part[$CellContext`m1, 1] = -Part[$CellContext`r2, 1]]]; 
         If[Part[$CellContext`r1, 2] == 1, $CellContext`m1 = {0, 0}]; 
         Print["m1 is :"]; Print[$CellContext`m1]; 
         AddTo[$CellContext`r1, $CellContext`m1]; 
         AddTo[$CellContext`r2, $CellContext`m1]; {$CellContext`\
\[CapitalDelta]ex, $CellContext`\[CapitalDelta]ey} = {$CellContext`\
\[CapitalDelta]tgx, $CellContext`\[CapitalDelta]tgy} - ($CellContext`r2 - \
$CellContext`r1); If[$CellContext`\[CapitalDelta]ex >= 0, $CellContext`m2 = {
             
             Min[$CellContext`\[CapitalDelta]tgx - (Part[$CellContext`r2, 1] - 
              Part[$CellContext`r1, 1]), 1 - 
              Part[$CellContext`r2, 1]], $CellContext`\[CapitalDelta]tgy - (
             Part[$CellContext`r2, 2] - 
             Part[$CellContext`r1, 2])}, $CellContext`m2 = {
             
             Max[$CellContext`\[CapitalDelta]tgx - (Part[$CellContext`r2, 1] - 
              Part[$CellContext`r1, 1]), -
              Part[$CellContext`r2, 1]], $CellContext`\[CapitalDelta]tgy - (
             Part[$CellContext`r2, 2] - Part[$CellContext`r1, 2])}]; 
         AppendTo[$CellContext`path, $CellContext`m1]; 
         If[$CellContext`isMirrored, 
           If[$CellContext`isFlipped, AppendTo[$CellContext`path1, 
              $CellContext`mirror[$CellContext`r2]]; 
            AppendTo[$CellContext`path2, 
              $CellContext`mirror[$CellContext`r1]], 
            AppendTo[$CellContext`path1, 
              $CellContext`mirror[$CellContext`r1]]; 
            AppendTo[$CellContext`path2, 
              $CellContext`mirror[$CellContext`r2]]], 
           
           If[$CellContext`isFlipped, 
            AppendTo[$CellContext`path1, $CellContext`r2]; 
            AppendTo[$CellContext`path2, $CellContext`r1], 
            AppendTo[$CellContext`path1, $CellContext`r1]; 
            AppendTo[$CellContext`path2, $CellContext`r2]]]; 
         AddTo[$CellContext`r2, $CellContext`m2]; 
         AppendTo[$CellContext`path, $CellContext`m2]; 
         If[$CellContext`isMirrored, $CellContext`path = 
            Map[$CellContext`mirrorInplace, $CellContext`path]; \
{$CellContext`r1, $CellContext`r2} = 
            Map[$CellContext`mirror, {$CellContext`r1, $CellContext`r2}]; 
           Null]; If[$CellContext`isFlipped, 
           AppendTo[$CellContext`path1, $CellContext`r2]; 
           AppendTo[$CellContext`path2, $CellContext`r1]; Return[{
              
              If[$CellContext`m2 == {0, 0}, 
               Infinity, $CellContext`distanceMoved[$CellContext`path] + \
$CellContext`admissibleHeuristic[$CellContext`r2, $CellContext`r1, \
$CellContext`g2, $CellContext`g1]], $CellContext`r2, $CellContext`r1, \
$CellContext`path, $CellContext`path1, $CellContext`path2, False}], 
           AppendTo[$CellContext`path1, $CellContext`r1]; 
           AppendTo[$CellContext`path2, $CellContext`r2]; Return[{
              
              If[$CellContext`m2 == {0, 0}, 
               Infinity, $CellContext`distanceMoved[$CellContext`path] + \
$CellContext`admissibleHeuristic[$CellContext`r1, $CellContext`r2, \
$CellContext`g1, $CellContext`g2]], $CellContext`r1, $CellContext`r2, \
$CellContext`path, $CellContext`path1, $CellContext`path2, 
              False}]]], $CellContext`mirror[
         Pattern[$CellContext`r, 
          Blank[]]] := {1 - Part[$CellContext`r, 1], 
         Part[$CellContext`r, 2]}, $CellContext`mirrorInplace[
         Pattern[$CellContext`r, 
          Blank[]]] := {-Part[$CellContext`r, 1], 
         Part[$CellContext`r, 2]}, $CellContext`rotate180[
         Pattern[$CellContext`r, 
          Blank[]]] := {
        1 - Part[$CellContext`r, 1], 1 - 
         Part[$CellContext`r, 2]}, $CellContext`rotate180inplace[
         Pattern[$CellContext`r, 
          Blank[]]] := {-Part[$CellContext`r, 1], -
         Part[$CellContext`r, 2]}, $CellContext`rotate90[
         Pattern[$CellContext`r, 
          Blank[]]] := {1 - Part[$CellContext`r, 2], 
         Part[$CellContext`r, 1]}, $CellContext`rotate90inplace[
         Pattern[$CellContext`r, 
          Blank[]]] := {
         Part[$CellContext`r, 2], -
         Part[$CellContext`r, 1]}, $CellContext`rotate270[
         Pattern[$CellContext`r, 
          Blank[]]] := {
         Part[$CellContext`r, 2], 1 - 
         Part[$CellContext`r, 1]}, $CellContext`rotate270inplace[
         Pattern[$CellContext`r, 
          Blank[]]] := {-Part[$CellContext`r, 2], 
         Part[$CellContext`r, 1]}}; Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.6967849909496603`*^9, 3.69678501988006*^9}, 
   3.696850649652906*^9, 3.696852125710799*^9, 3.696852396172555*^9, 
   3.696852785676174*^9, 3.696855698479938*^9, 3.696856268774611*^9, {
   3.6968563596464977`*^9, 3.696856378002384*^9}, 3.6968564232066393`*^9, 
   3.696856472909624*^9, 3.69685653568862*^9, 3.696856836744055*^9, 
   3.696856901374844*^9, {3.696857221050482*^9, 3.6968572499319983`*^9}, 
   3.696857285100442*^9, 3.69685732973038*^9, 3.696857367645261*^9, {
   3.6968574335285473`*^9, 3.6968574454198627`*^9}, 3.696857545110186*^9, {
   3.696857642413574*^9, 3.696857666665926*^9}, 3.69685873137306*^9, 
   3.696859473194819*^9, 3.696859689808817*^9, 3.6968600722049093`*^9, 
   3.696860153554562*^9, 3.69686024934092*^9, 3.6968603813317337`*^9, 
   3.696860506253591*^9, 3.696860645105782*^9, 3.696860697399444*^9, 
   3.696860793595358*^9, {3.696860859065659*^9, 3.69686087473776*^9}, 
   3.696862506446361*^9, 3.6968632522756033`*^9, 3.696866603972101*^9, 
   3.696866679431978*^9, 3.696866796363266*^9, 3.696866961941163*^9, 
   3.6968736718525352`*^9}]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.6968588978034678`*^9}]
},
WindowSize->{1280, 687},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September 9, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 82223, 1910, 4298, "Input"],
Cell[82784, 1932, 6771, 153, 692, "Input"],
Cell[CellGroupData[{
Cell[89580, 2089, 36160, 874, 1652, "Input"],
Cell[125743, 2965, 31154, 614, 128, "Output"]
}, Open  ]],
Cell[156912, 3582, 89, 1, 46, "Input"]
}
]
*)

(* End of internal cache information *)
